var Qa=Object.defineProperty;var tc=(r,t,e)=>t in r?Qa(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var pt=(r,t,e)=>tc(r,typeof t!="symbol"?t+"":t,e);import{g as ec,t as rc,h as vt,i as _n,x as ut,T as oc,R as Dt,j as Je,D as Gn,F as nc,G as Xn,I as Yn,J as ic,K as lo,L as sc,M as lc}from"./notes-client.B2dIe2T5.js";import{a as N,s as ac,t as cc}from"./property.D-izuzPU.js";/**
* @license
* Copyright 2017 Google LLC
* SPDX-License-Identifier: BSD-3-Clause
*/const Zn={ATTRIBUTE:1,PROPERTY:3,BOOLEAN_ATTRIBUTE:4},Qn=r=>(...t)=>({_$litDirective$:r,values:t});let ti=class{constructor(r){}get _$AU(){return this._$AM._$AU}_$AT(r,t,e){this._$Ct=r,this._$AM=t,this._$Ci=e}_$AS(r,t){return this.update(r,t)}update(r,t){return this.render(...t)}};function hc(r){return{attribute:r,type:Object,hasChanged:(t,e)=>(t==null?void 0:t.toString())!==(e==null?void 0:e.toString()),converter:{fromAttribute:t=>t&&t.length>0&&rc(t),toAttribute:t=>t&&ec(t)},reflect:!0}}function ei(r){return`data:image/svg+xml;utf8,${dc(r)}`}function dc(r){return encodeURIComponent(`<svg xmlns='http://www.w3.org/2000/svg' style='fill: currentColor' viewBox='0 0 24 24'><path d='${r}'></path></svg>`)}var ri="M11,15H13V17H11V15M11,7H13V13H11V7M12,2C6.47,2 2,6.5 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20Z",pc="M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M11,17H13V11H11V17Z",uc="M4 13C2.89 13 2 13.89 2 15V19C2 20.11 2.89 21 4 21H8C9.11 21 10 20.11 10 19V15C10 13.89 9.11 13 8 13M8.2 14.5L9.26 15.55L5.27 19.5L2.74 16.95L3.81 15.9L5.28 17.39M4 3C2.89 3 2 3.89 2 5V9C2 10.11 2.89 11 4 11H8C9.11 11 10 10.11 10 9V5C10 3.89 9.11 3 8 3M4 5H8V9H4M12 5H22V7H12M12 19V17H22V19M12 11H22V13H12Z";/**
* @license
* Copyright 2017 Google LLC
* SPDX-License-Identifier: BSD-3-Clause
*/function oi(r){return N({...r,state:!0,attribute:!1})}/**
* @license
* Copyright 2017 Google LLC
* SPDX-License-Identifier: BSD-3-Clause
*/const fc=(r,t,e)=>(e.configurable=!0,e.enumerable=!0,Reflect.decorate&&typeof t!="object"&&Object.defineProperty(r,t,e),e);/**
* @license
* Copyright 2017 Google LLC
* SPDX-License-Identifier: BSD-3-Clause
*/function xe(r,t){return(e,o,n)=>{const i=s=>{var l;return((l=s.renderRoot)==null?void 0:l.querySelector(r))??null};return fc(e,o,{get(){return i(this)}})}}var ao="";function ni(r){ao=r}function mc(r=""){if(!ao){const t=[...document.getElementsByTagName("script")],e=t.find(o=>o.hasAttribute("data-shoelace"));if(e)ni(e.getAttribute("data-shoelace"));else{const o=t.find(i=>/shoelace(\.min)?\.js($|\?)/.test(i.src)||/shoelace-autoloader(\.min)?\.js($|\?)/.test(i.src));let n="";o&&(n=o.getAttribute("src")),ni(n.split("/").slice(0,-1).join("/"))}}return ao.replace(/\/$/,"")+(r?`/${r.replace(/^\//,"")}`:"")}var gc={name:"default",resolver:r=>mc(`assets/icons/${r}.svg`)},yc=gc,ii={caret:`
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <polyline points="6 9 12 15 18 9"></polyline>
    </svg>
  `,check:`
    <svg part="checked-icon" class="checkbox__icon" viewBox="0 0 16 16">
      <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round">
        <g stroke="currentColor">
          <g transform="translate(3.428571, 3.428571)">
            <path d="M0,5.71428571 L3.42857143,9.14285714"></path>
            <path d="M9.14285714,0 L3.42857143,9.14285714"></path>
          </g>
        </g>
      </g>
    </svg>
  `,"chevron-down":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-down" viewBox="0 0 16 16">
      <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/>
    </svg>
  `,"chevron-left":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-left" viewBox="0 0 16 16">
      <path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0z"/>
    </svg>
  `,"chevron-right":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-right" viewBox="0 0 16 16">
      <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>
    </svg>
  `,copy:`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-copy" viewBox="0 0 16 16">
      <path fill-rule="evenodd" d="M4 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V2Zm2-1a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H6ZM2 5a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1v-1h1v1a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h1v1H2Z"/>
    </svg>
  `,eye:`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye" viewBox="0 0 16 16">
      <path d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8zM1.173 8a13.133 13.133 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13.133 13.133 0 0 1 14.828 8c-.058.087-.122.183-.195.288-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5c-2.12 0-3.879-1.168-5.168-2.457A13.134 13.134 0 0 1 1.172 8z"/>
      <path d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5zM4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0z"/>
    </svg>
  `,"eye-slash":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye-slash" viewBox="0 0 16 16">
      <path d="M13.359 11.238C15.06 9.72 16 8 16 8s-3-5.5-8-5.5a7.028 7.028 0 0 0-2.79.588l.77.771A5.944 5.944 0 0 1 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13.134 13.134 0 0 1 14.828 8c-.058.087-.122.183-.195.288-.335.48-.83 1.12-1.465 1.755-.165.165-.337.328-.517.486l.708.709z"/>
      <path d="M11.297 9.176a3.5 3.5 0 0 0-4.474-4.474l.823.823a2.5 2.5 0 0 1 2.829 2.829l.822.822zm-2.943 1.299.822.822a3.5 3.5 0 0 1-4.474-4.474l.823.823a2.5 2.5 0 0 0 2.829 2.829z"/>
      <path d="M3.35 5.47c-.18.16-.353.322-.518.487A13.134 13.134 0 0 0 1.172 8l.195.288c.335.48.83 1.12 1.465 1.755C4.121 11.332 5.881 12.5 8 12.5c.716 0 1.39-.133 2.02-.36l.77.772A7.029 7.029 0 0 1 8 13.5C3 13.5 0 8 0 8s.939-1.721 2.641-3.238l.708.709zm10.296 8.884-12-12 .708-.708 12 12-.708.708z"/>
    </svg>
  `,eyedropper:`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eyedropper" viewBox="0 0 16 16">
      <path d="M13.354.646a1.207 1.207 0 0 0-1.708 0L8.5 3.793l-.646-.647a.5.5 0 1 0-.708.708L8.293 5l-7.147 7.146A.5.5 0 0 0 1 12.5v1.793l-.854.853a.5.5 0 1 0 .708.707L1.707 15H3.5a.5.5 0 0 0 .354-.146L11 7.707l1.146 1.147a.5.5 0 0 0 .708-.708l-.647-.646 3.147-3.146a1.207 1.207 0 0 0 0-1.708l-2-2zM2 12.707l7-7L10.293 7l-7 7H2v-1.293z"></path>
    </svg>
  `,"grip-vertical":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-grip-vertical" viewBox="0 0 16 16">
      <path d="M7 2a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zM7 5a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zM7 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm-3 3a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm-3 3a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm3 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"></path>
    </svg>
  `,indeterminate:`
    <svg part="indeterminate-icon" class="checkbox__icon" viewBox="0 0 16 16">
      <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round">
        <g stroke="currentColor" stroke-width="2">
          <g transform="translate(2.285714, 6.857143)">
            <path d="M10.2857143,1.14285714 L1.14285714,1.14285714"></path>
          </g>
        </g>
      </g>
    </svg>
  `,"person-fill":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person-fill" viewBox="0 0 16 16">
      <path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H3zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
    </svg>
  `,"play-fill":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-play-fill" viewBox="0 0 16 16">
      <path d="m11.596 8.697-6.363 3.692c-.54.313-1.233-.066-1.233-.697V4.308c0-.63.692-1.01 1.233-.696l6.363 3.692a.802.802 0 0 1 0 1.393z"></path>
    </svg>
  `,"pause-fill":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pause-fill" viewBox="0 0 16 16">
      <path d="M5.5 3.5A1.5 1.5 0 0 1 7 5v6a1.5 1.5 0 0 1-3 0V5a1.5 1.5 0 0 1 1.5-1.5zm5 0A1.5 1.5 0 0 1 12 5v6a1.5 1.5 0 0 1-3 0V5a1.5 1.5 0 0 1 1.5-1.5z"></path>
    </svg>
  `,radio:`
    <svg part="checked-icon" class="radio__icon" viewBox="0 0 16 16">
      <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <g fill="currentColor">
          <circle cx="8" cy="8" r="3.42857143"></circle>
        </g>
      </g>
    </svg>
  `,"star-fill":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-star-fill" viewBox="0 0 16 16">
      <path d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z"/>
    </svg>
  `,"x-lg":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-lg" viewBox="0 0 16 16">
      <path d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z"/>
    </svg>
  `,"x-circle-fill":`
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x-circle-fill" viewBox="0 0 16 16">
      <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293 5.354 4.646z"></path>
    </svg>
  `},wc={name:"system",resolver:r=>r in ii?`data:image/svg+xml,${encodeURIComponent(ii[r])}`:""},vc=wc,bc=[yc,vc],co=[];function kc(r){co.push(r)}function xc(r){co=co.filter(t=>t!==r)}function si(r){return bc.find(t=>t.name===r)}var Sc=vt`
  :host {
    display: inline-block;
    width: 1em;
    height: 1em;
    box-sizing: content-box !important;
  }

  svg {
    display: block;
    height: 100%;
    width: 100%;
  }
`,li=Object.defineProperty,Mc=Object.defineProperties,Cc=Object.getOwnPropertyDescriptor,Oc=Object.getOwnPropertyDescriptors,ai=Object.getOwnPropertySymbols,Nc=Object.prototype.hasOwnProperty,Tc=Object.prototype.propertyIsEnumerable,ci=r=>{throw TypeError(r)},hi=(r,t,e)=>t in r?li(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,He=(r,t)=>{for(var e in t||(t={}))Nc.call(t,e)&&hi(r,e,t[e]);if(ai)for(var e of ai(t))Tc.call(t,e)&&hi(r,e,t[e]);return r},ho=(r,t)=>Mc(r,Oc(t)),S=(r,t,e,o)=>{for(var n=o>1?void 0:o?Cc(t,e):t,i=r.length-1,s;i>=0;i--)(s=r[i])&&(n=(o?s(t,e,n):s(n))||n);return o&&n&&li(t,e,n),n},di=(r,t,e)=>t.has(r)||ci("Cannot "+e),Ac=(r,t,e)=>(di(r,t,"read from private field"),t.get(r)),Dc=(r,t,e)=>t.has(r)?ci("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(r):t.set(r,e),Ec=(r,t,e,o)=>(di(r,t,"write to private field"),t.set(r,e),e);function Se(r,t){const e=He({waitUntilFirstUpdate:!1},t);return(o,n)=>{const{update:i}=o,s=Array.isArray(r)?r:[r];o.update=function(l){s.forEach(a=>{const c=a;if(l.has(c)){const h=l.get(c),d=this[c];h!==d&&(!e.waitUntilFirstUpdate||this.hasUpdated)&&this[n](h,d)}}),i.call(this,l)}}}var Me=vt`
  :host {
    box-sizing: border-box;
  }

  :host *,
  :host *::before,
  :host *::after {
    box-sizing: inherit;
  }

  [hidden] {
    display: none !important;
  }
`,gr,bt=class extends _n{constructor(){super(),Dc(this,gr,!1),this.initialReflectedProperties=new Map,Object.entries(this.constructor.dependencies).forEach(([r,t])=>{this.constructor.define(r,t)})}emit(r,t){const e=new CustomEvent(r,He({bubbles:!0,cancelable:!1,composed:!0,detail:{}},t));return this.dispatchEvent(e),e}static define(r,t=this,e={}){const o=customElements.get(r);if(!o){try{customElements.define(r,t,e)}catch{customElements.define(r,class extends t{},e)}return}let n=" (unknown version)",i=n;"version"in t&&t.version&&(n=" v"+t.version),"version"in o&&o.version&&(i=" v"+o.version),!(n&&i&&n===i)&&console.warn(`Attempted to register <${r}>${n}, but <${r}>${i} has already been registered.`)}attributeChangedCallback(r,t,e){Ac(this,gr)||(this.constructor.elementProperties.forEach((o,n)=>{o.reflect&&this[n]!=null&&this.initialReflectedProperties.set(n,this[n])}),Ec(this,gr,!0)),super.attributeChangedCallback(r,t,e)}willUpdate(r){super.willUpdate(r),this.initialReflectedProperties.forEach((t,e)=>{r.has(e)&&this[e]==null&&(this[e]=t)})}};gr=new WeakMap,bt.version="2.20.1",bt.dependencies={},S([N()],bt.prototype,"dir",2),S([N()],bt.prototype,"lang",2);/**
* @license
* Copyright 2020 Google LLC
* SPDX-License-Identifier: BSD-3-Clause
*/const Rc=(r,t)=>(r==null?void 0:r._$litType$)!==void 0,Pc=r=>r.strings===void 0,Bc={},Ic=(r,t=Bc)=>r._$AH=t;var Ke=Symbol(),yr=Symbol(),po,uo=new Map,kt=class extends bt{constructor(){super(...arguments),this.initialRender=!1,this.svg=null,this.label="",this.library="default"}async resolveIcon(r,t){var e;let o;if(t!=null&&t.spriteSheet)return this.svg=ut`<svg part="svg">
        <use part="use" href="${r}"></use>
      </svg>`,this.svg;try{if(o=await fetch(r,{mode:"cors"}),!o.ok)return o.status===410?Ke:yr}catch{return yr}try{const n=document.createElement("div");n.innerHTML=await o.text();const i=n.firstElementChild;if(((e=i==null?void 0:i.tagName)==null?void 0:e.toLowerCase())!=="svg")return Ke;po||(po=new DOMParser);const s=po.parseFromString(i.outerHTML,"text/html").body.querySelector("svg");return s?(s.part.add("svg"),document.adoptNode(s)):Ke}catch{return Ke}}connectedCallback(){super.connectedCallback(),kc(this)}firstUpdated(){this.initialRender=!0,this.setIcon()}disconnectedCallback(){super.disconnectedCallback(),xc(this)}getIconSource(){const r=si(this.library);return this.name&&r?{url:r.resolver(this.name),fromLibrary:!0}:{url:this.src,fromLibrary:!1}}handleLabelChange(){typeof this.label=="string"&&this.label.length>0?(this.setAttribute("role","img"),this.setAttribute("aria-label",this.label),this.removeAttribute("aria-hidden")):(this.removeAttribute("role"),this.removeAttribute("aria-label"),this.setAttribute("aria-hidden","true"))}async setIcon(){var r;const{url:t,fromLibrary:e}=this.getIconSource(),o=e?si(this.library):void 0;if(!t){this.svg=null;return}let n=uo.get(t);if(n||(n=this.resolveIcon(t,o),uo.set(t,n)),!this.initialRender)return;const i=await n;if(i===yr&&uo.delete(t),t===this.getIconSource().url){if(Rc(i)){if(this.svg=i,o){await this.updateComplete;const s=this.shadowRoot.querySelector("[part='svg']");typeof o.mutator=="function"&&s&&o.mutator(s)}return}switch(i){case yr:case Ke:this.svg=null,this.emit("sl-error");break;default:this.svg=i.cloneNode(!0),(r=o==null?void 0:o.mutator)==null||r.call(o,this.svg),this.emit("sl-load")}}}render(){return this.svg}};kt.styles=[Me,Sc],S([oi()],kt.prototype,"svg",2),S([N({reflect:!0})],kt.prototype,"name",2),S([N()],kt.prototype,"src",2),S([N()],kt.prototype,"label",2),S([N({reflect:!0})],kt.prototype,"library",2),S([Se("label")],kt.prototype,"handleLabelChange",1),S([Se(["name","src","library"])],kt.prototype,"setIcon",1),kt.define("sl-icon");var zc=vt`
  :host {
    --max-width: 20rem;
    --hide-delay: 0ms;
    --show-delay: 150ms;

    display: contents;
  }

  .tooltip {
    --arrow-size: var(--sl-tooltip-arrow-size);
    --arrow-color: var(--sl-tooltip-background-color);
  }

  .tooltip::part(popup) {
    z-index: var(--sl-z-index-tooltip);
  }

  .tooltip[placement^='top']::part(popup) {
    transform-origin: bottom;
  }

  .tooltip[placement^='bottom']::part(popup) {
    transform-origin: top;
  }

  .tooltip[placement^='left']::part(popup) {
    transform-origin: right;
  }

  .tooltip[placement^='right']::part(popup) {
    transform-origin: left;
  }

  .tooltip__body {
    display: block;
    width: max-content;
    max-width: var(--max-width);
    border-radius: var(--sl-tooltip-border-radius);
    background-color: var(--sl-tooltip-background-color);
    font-family: var(--sl-tooltip-font-family);
    font-size: var(--sl-tooltip-font-size);
    font-weight: var(--sl-tooltip-font-weight);
    line-height: var(--sl-tooltip-line-height);
    text-align: start;
    white-space: normal;
    color: var(--sl-tooltip-color);
    padding: var(--sl-tooltip-padding);
    pointer-events: none;
    user-select: none;
    -webkit-user-select: none;
  }
`,$c=vt`
  :host {
    --arrow-color: var(--sl-color-neutral-1000);
    --arrow-size: 6px;

    /*
     * These properties are computed to account for the arrow's dimensions after being rotated 45ยบ. The constant
     * 0.7071 is derived from sin(45), which is the diagonal size of the arrow's container after rotating.
     */
    --arrow-size-diagonal: calc(var(--arrow-size) * 0.7071);
    --arrow-padding-offset: calc(var(--arrow-size-diagonal) - var(--arrow-size));

    display: contents;
  }

  .popup {
    position: absolute;
    isolation: isolate;
    max-width: var(--auto-size-available-width, none);
    max-height: var(--auto-size-available-height, none);
  }

  .popup--fixed {
    position: fixed;
  }

  .popup:not(.popup--active) {
    display: none;
  }

  .popup__arrow {
    position: absolute;
    width: calc(var(--arrow-size-diagonal) * 2);
    height: calc(var(--arrow-size-diagonal) * 2);
    rotate: 45deg;
    background: var(--arrow-color);
    z-index: -1;
  }

  /* Hover bridge */
  .popup-hover-bridge:not(.popup-hover-bridge--visible) {
    display: none;
  }

  .popup-hover-bridge {
    position: fixed;
    z-index: calc(var(--sl-z-index-dropdown) - 1);
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    clip-path: polygon(
      var(--hover-bridge-top-left-x, 0) var(--hover-bridge-top-left-y, 0),
      var(--hover-bridge-top-right-x, 0) var(--hover-bridge-top-right-y, 0),
      var(--hover-bridge-bottom-right-x, 0) var(--hover-bridge-bottom-right-y, 0),
      var(--hover-bridge-bottom-left-x, 0) var(--hover-bridge-bottom-left-y, 0)
    );
  }
`;const fo=new Set,Ce=new Map;let ne,mo="ltr",go="en";const pi=typeof MutationObserver<"u"&&typeof document<"u"&&typeof document.documentElement<"u";if(pi){const r=new MutationObserver(fi);mo=document.documentElement.dir||"ltr",go=document.documentElement.lang||navigator.language,r.observe(document.documentElement,{attributes:!0,attributeFilter:["dir","lang"]})}function ui(...r){r.map(t=>{const e=t.$code.toLowerCase();Ce.has(e)?Ce.set(e,Object.assign(Object.assign({},Ce.get(e)),t)):Ce.set(e,t),ne||(ne=t)}),fi()}function fi(){pi&&(mo=document.documentElement.dir||"ltr",go=document.documentElement.lang||navigator.language),[...fo.keys()].map(r=>{typeof r.requestUpdate=="function"&&r.requestUpdate()})}let Fc=class{constructor(r){this.host=r,this.host.addController(this)}hostConnected(){fo.add(this.host)}hostDisconnected(){fo.delete(this.host)}dir(){return`${this.host.dir||mo}`.toLowerCase()}lang(){return`${this.host.lang||go}`.toLowerCase()}getTranslationData(r){var t,e;const o=new Intl.Locale(r.replace(/_/g,"-")),n=o==null?void 0:o.language.toLowerCase(),i=(e=(t=o==null?void 0:o.region)===null||t===void 0?void 0:t.toLowerCase())!==null&&e!==void 0?e:"",s=Ce.get(`${n}-${i}`),l=Ce.get(n);return{locale:o,language:n,region:i,primary:s,secondary:l}}exists(r,t){var e;const{primary:o,secondary:n}=this.getTranslationData((e=t.lang)!==null&&e!==void 0?e:this.lang());return t=Object.assign({includeFallback:!1},t),!!(o&&o[r]||n&&n[r]||t.includeFallback&&ne&&ne[r])}term(r,...t){const{primary:e,secondary:o}=this.getTranslationData(this.lang());let n;if(e&&e[r])n=e[r];else if(o&&o[r])n=o[r];else if(ne&&ne[r])n=ne[r];else return console.error(`No translation found for: ${String(r)}`),String(r);return typeof n=="function"?n(...t):n}date(r,t){return r=new Date(r),new Intl.DateTimeFormat(this.lang(),t).format(r)}number(r,t){return r=Number(r),isNaN(r)?"":new Intl.NumberFormat(this.lang(),t).format(r)}relativeTime(r,t,e){return new Intl.RelativeTimeFormat(this.lang(),e).format(r,t)}};var mi={$code:"en",$name:"English",$dir:"ltr",carousel:"Carousel",clearEntry:"Clear entry",close:"Close",copied:"Copied",copy:"Copy",currentValue:"Current value",error:"Error",goToSlide:(r,t)=>`Go to slide ${r} of ${t}`,hidePassword:"Hide password",loading:"Loading",nextSlide:"Next slide",numOptionsSelected:r=>r===0?"No options selected":r===1?"1 option selected":`${r} options selected`,previousSlide:"Previous slide",progress:"Progress",remove:"Remove",resize:"Resize",scrollToEnd:"Scroll to end",scrollToStart:"Scroll to start",selectAColorFromTheScreen:"Select a color from the screen",showPassword:"Show password",slideNum:r=>`Slide ${r}`,toggleColorFormat:"Toggle color format"};ui(mi);var Lc=mi,wr=class extends Fc{};ui(Lc);const jt=Math.min,nt=Math.max,vr=Math.round,br=Math.floor,xt=r=>({x:r,y:r}),Vc={left:"right",right:"left",bottom:"top",top:"bottom"},jc={start:"end",end:"start"};function yo(r,t,e){return nt(r,jt(t,e))}function Oe(r,t){return typeof r=="function"?r(t):r}function Wt(r){return r.split("-")[0]}function Ne(r){return r.split("-")[1]}function gi(r){return r==="x"?"y":"x"}function wo(r){return r==="y"?"height":"width"}function qt(r){return["top","bottom"].includes(Wt(r))?"y":"x"}function vo(r){return gi(qt(r))}function Wc(r,t,e){e===void 0&&(e=!1);const o=Ne(r),n=vo(r),i=wo(n);let s=n==="x"?o===(e?"end":"start")?"right":"left":o==="start"?"bottom":"top";return t.reference[i]>t.floating[i]&&(s=kr(s)),[s,kr(s)]}function qc(r){const t=kr(r);return[bo(r),t,bo(t)]}function bo(r){return r.replace(/start|end/g,t=>jc[t])}function Jc(r,t,e){const o=["left","right"],n=["right","left"],i=["top","bottom"],s=["bottom","top"];switch(r){case"top":case"bottom":return e?t?n:o:t?o:n;case"left":case"right":return t?i:s;default:return[]}}function Hc(r,t,e,o){const n=Ne(r);let i=Jc(Wt(r),e==="start",o);return n&&(i=i.map(s=>s+"-"+n),t&&(i=i.concat(i.map(bo)))),i}function kr(r){return r.replace(/left|right|bottom|top/g,t=>Vc[t])}function Kc(r){return{top:0,right:0,bottom:0,left:0,...r}}function yi(r){return typeof r!="number"?Kc(r):{top:r,right:r,bottom:r,left:r}}function xr(r){const{x:t,y:e,width:o,height:n}=r;return{width:o,height:n,top:e,left:t,right:t+o,bottom:e+n,x:t,y:e}}function wi(r,t,e){let{reference:o,floating:n}=r;const i=qt(t),s=vo(t),l=wo(s),a=Wt(t),c=i==="y",h=o.x+o.width/2-n.width/2,d=o.y+o.height/2-n.height/2,p=o[l]/2-n[l]/2;let f;switch(a){case"top":f={x:h,y:o.y-n.height};break;case"bottom":f={x:h,y:o.y+o.height};break;case"right":f={x:o.x+o.width,y:d};break;case"left":f={x:o.x-n.width,y:d};break;default:f={x:o.x,y:o.y}}switch(Ne(t)){case"start":f[s]-=p*(e&&c?-1:1);break;case"end":f[s]+=p*(e&&c?-1:1);break}return f}const Uc=async(r,t,e)=>{const{placement:o="bottom",strategy:n="absolute",middleware:i=[],platform:s}=e,l=i.filter(Boolean),a=await(s.isRTL==null?void 0:s.isRTL(t));let c=await s.getElementRects({reference:r,floating:t,strategy:n}),{x:h,y:d}=wi(c,o,a),p=o,f={},u=0;for(let m=0;m<l.length;m++){const{name:g,fn:y}=l[m],{x:k,y:x,data:b,reset:C}=await y({x:h,y:d,initialPlacement:o,placement:p,strategy:n,middlewareData:f,rects:c,platform:s,elements:{reference:r,floating:t}});h=k??h,d=x??d,f={...f,[g]:{...f[g],...b}},C&&u<=50&&(u++,typeof C=="object"&&(C.placement&&(p=C.placement),C.rects&&(c=C.rects===!0?await s.getElementRects({reference:r,floating:t,strategy:n}):C.rects),{x:h,y:d}=wi(c,p,a)),m=-1)}return{x:h,y:d,placement:p,strategy:n,middlewareData:f}};async function ko(r,t){var e;t===void 0&&(t={});const{x:o,y:n,platform:i,rects:s,elements:l,strategy:a}=r,{boundary:c="clippingAncestors",rootBoundary:h="viewport",elementContext:d="floating",altBoundary:p=!1,padding:f=0}=Oe(t,r),u=yi(f),m=l[p?d==="floating"?"reference":"floating":d],g=xr(await i.getClippingRect({element:(e=await(i.isElement==null?void 0:i.isElement(m)))==null||e?m:m.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(l.floating)),boundary:c,rootBoundary:h,strategy:a})),y=d==="floating"?{x:o,y:n,width:s.floating.width,height:s.floating.height}:s.reference,k=await(i.getOffsetParent==null?void 0:i.getOffsetParent(l.floating)),x=await(i.isElement==null?void 0:i.isElement(k))?await(i.getScale==null?void 0:i.getScale(k))||{x:1,y:1}:{x:1,y:1},b=xr(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:y,offsetParent:k,strategy:a}):y);return{top:(g.top-b.top+u.top)/x.y,bottom:(b.bottom-g.bottom+u.bottom)/x.y,left:(g.left-b.left+u.left)/x.x,right:(b.right-g.right+u.right)/x.x}}const _c=r=>({name:"arrow",options:r,async fn(t){const{x:e,y:o,placement:n,rects:i,platform:s,elements:l,middlewareData:a}=t,{element:c,padding:h=0}=Oe(r,t)||{};if(c==null)return{};const d=yi(h),p={x:e,y:o},f=vo(n),u=wo(f),m=await s.getDimensions(c),g=f==="y",y=g?"top":"left",k=g?"bottom":"right",x=g?"clientHeight":"clientWidth",b=i.reference[u]+i.reference[f]-p[f]-i.floating[u],C=p[f]-i.reference[f],T=await(s.getOffsetParent==null?void 0:s.getOffsetParent(c));let j=T?T[x]:0;(!j||!await(s.isElement==null?void 0:s.isElement(T)))&&(j=l.floating[x]||i.floating[u]);const B=b/2-C/2,M=j/2-m[u]/2-1,R=jt(d[y],M),W=jt(d[k],M),Z=R,Q=j-m[u]-W,_=j/2-m[u]/2+B,q=yo(Z,_,Q),Tt=!a.arrow&&Ne(n)!=null&&_!==q&&i.reference[u]/2-(_<Z?R:W)-m[u]/2<0,At=Tt?_<Z?_-Z:_-Q:0;return{[f]:p[f]+At,data:{[f]:q,centerOffset:_-q-At,...Tt&&{alignmentOffset:At}},reset:Tt}}}),Gc=function(r){return r===void 0&&(r={}),{name:"flip",options:r,async fn(t){var e,o;const{placement:n,middlewareData:i,rects:s,initialPlacement:l,platform:a,elements:c}=t,{mainAxis:h=!0,crossAxis:d=!0,fallbackPlacements:p,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:u="none",flipAlignment:m=!0,...g}=Oe(r,t);if((e=i.arrow)!=null&&e.alignmentOffset)return{};const y=Wt(n),k=qt(l),x=Wt(l)===l,b=await(a.isRTL==null?void 0:a.isRTL(c.floating)),C=p||(x||!m?[kr(l)]:qc(l)),T=u!=="none";!p&&T&&C.push(...Hc(l,m,u,b));const j=[l,...C],B=await ko(t,g),M=[];let R=((o=i.flip)==null?void 0:o.overflows)||[];if(h&&M.push(B[y]),d){const q=Wc(n,s,b);M.push(B[q[0]],B[q[1]])}if(R=[...R,{placement:n,overflows:M}],!M.every(q=>q<=0)){var W,Z;const q=(((W=i.flip)==null?void 0:W.index)||0)+1,Tt=j[q];if(Tt){var Q;const Lt=d==="alignment"?k!==qt(Tt):!1,wt=((Q=R[0])==null?void 0:Q.overflows[0])>0;if(!Lt||wt)return{data:{index:q,overflows:R},reset:{placement:Tt}}}let At=(Z=R.filter(Lt=>Lt.overflows[0]<=0).sort((Lt,wt)=>Lt.overflows[1]-wt.overflows[1])[0])==null?void 0:Z.placement;if(!At)switch(f){case"bestFit":{var _;const Lt=(_=R.filter(wt=>{if(T){const Vt=qt(wt.placement);return Vt===k||Vt==="y"}return!0}).map(wt=>[wt.placement,wt.overflows.filter(Vt=>Vt>0).reduce((Vt,Za)=>Vt+Za,0)]).sort((wt,Vt)=>wt[1]-Vt[1])[0])==null?void 0:_[0];Lt&&(At=Lt);break}case"initialPlacement":At=l;break}if(n!==At)return{reset:{placement:At}}}return{}}}};async function Xc(r,t){const{placement:e,platform:o,elements:n}=r,i=await(o.isRTL==null?void 0:o.isRTL(n.floating)),s=Wt(e),l=Ne(e),a=qt(e)==="y",c=["left","top"].includes(s)?-1:1,h=i&&a?-1:1,d=Oe(t,r);let{mainAxis:p,crossAxis:f,alignmentAxis:u}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return l&&typeof u=="number"&&(f=l==="end"?u*-1:u),a?{x:f*h,y:p*c}:{x:p*c,y:f*h}}const Yc=function(r){return r===void 0&&(r=0),{name:"offset",options:r,async fn(t){var e,o;const{x:n,y:i,placement:s,middlewareData:l}=t,a=await Xc(t,r);return s===((e=l.offset)==null?void 0:e.placement)&&(o=l.arrow)!=null&&o.alignmentOffset?{}:{x:n+a.x,y:i+a.y,data:{...a,placement:s}}}}},Zc=function(r){return r===void 0&&(r={}),{name:"shift",options:r,async fn(t){const{x:e,y:o,placement:n}=t,{mainAxis:i=!0,crossAxis:s=!1,limiter:l={fn:g=>{let{x:y,y:k}=g;return{x:y,y:k}}},...a}=Oe(r,t),c={x:e,y:o},h=await ko(t,a),d=qt(Wt(n)),p=gi(d);let f=c[p],u=c[d];if(i){const g=p==="y"?"top":"left",y=p==="y"?"bottom":"right",k=f+h[g],x=f-h[y];f=yo(k,f,x)}if(s){const g=d==="y"?"top":"left",y=d==="y"?"bottom":"right",k=u+h[g],x=u-h[y];u=yo(k,u,x)}const m=l.fn({...t,[p]:f,[d]:u});return{...m,data:{x:m.x-e,y:m.y-o,enabled:{[p]:i,[d]:s}}}}}},Qc=function(r){return r===void 0&&(r={}),{name:"size",options:r,async fn(t){var e,o;const{placement:n,rects:i,platform:s,elements:l}=t,{apply:a=()=>{},...c}=Oe(r,t),h=await ko(t,c),d=Wt(n),p=Ne(n),f=qt(n)==="y",{width:u,height:m}=i.floating;let g,y;d==="top"||d==="bottom"?(g=d,y=p===(await(s.isRTL==null?void 0:s.isRTL(l.floating))?"start":"end")?"left":"right"):(y=d,g=p==="end"?"top":"bottom");const k=m-h.top-h.bottom,x=u-h.left-h.right,b=jt(m-h[g],k),C=jt(u-h[y],x),T=!t.middlewareData.shift;let j=b,B=C;if((e=t.middlewareData.shift)!=null&&e.enabled.x&&(B=x),(o=t.middlewareData.shift)!=null&&o.enabled.y&&(j=k),T&&!p){const R=nt(h.left,0),W=nt(h.right,0),Z=nt(h.top,0),Q=nt(h.bottom,0);f?B=u-2*(R!==0||W!==0?R+W:nt(h.left,h.right)):j=m-2*(Z!==0||Q!==0?Z+Q:nt(h.top,h.bottom))}await a({...t,availableWidth:B,availableHeight:j});const M=await s.getDimensions(l.floating);return u!==M.width||m!==M.height?{reset:{rects:!0}}:{}}}};function Sr(){return typeof window<"u"}function Te(r){return vi(r)?(r.nodeName||"").toLowerCase():"#document"}function it(r){var t;return(r==null||(t=r.ownerDocument)==null?void 0:t.defaultView)||window}function St(r){var t;return(t=(vi(r)?r.ownerDocument:r.document)||window.document)==null?void 0:t.documentElement}function vi(r){return Sr()?r instanceof Node||r instanceof it(r).Node:!1}function ft(r){return Sr()?r instanceof Element||r instanceof it(r).Element:!1}function Mt(r){return Sr()?r instanceof HTMLElement||r instanceof it(r).HTMLElement:!1}function bi(r){return!Sr()||typeof ShadowRoot>"u"?!1:r instanceof ShadowRoot||r instanceof it(r).ShadowRoot}function Ue(r){const{overflow:t,overflowX:e,overflowY:o,display:n}=mt(r);return/auto|scroll|overlay|hidden|clip/.test(t+o+e)&&!["inline","contents"].includes(n)}function th(r){return["table","td","th"].includes(Te(r))}function Mr(r){return[":popover-open",":modal"].some(t=>{try{return r.matches(t)}catch{return!1}})}function Cr(r){const t=xo(),e=ft(r)?mt(r):r;return["transform","translate","scale","rotate","perspective"].some(o=>e[o]?e[o]!=="none":!1)||(e.containerType?e.containerType!=="normal":!1)||!t&&(e.backdropFilter?e.backdropFilter!=="none":!1)||!t&&(e.filter?e.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(o=>(e.willChange||"").includes(o))||["paint","layout","strict","content"].some(o=>(e.contain||"").includes(o))}function eh(r){let t=Jt(r);for(;Mt(t)&&!Ae(t);){if(Cr(t))return t;if(Mr(t))return null;t=Jt(t)}return null}function xo(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Ae(r){return["html","body","#document"].includes(Te(r))}function mt(r){return it(r).getComputedStyle(r)}function Or(r){return ft(r)?{scrollLeft:r.scrollLeft,scrollTop:r.scrollTop}:{scrollLeft:r.scrollX,scrollTop:r.scrollY}}function Jt(r){if(Te(r)==="html")return r;const t=r.assignedSlot||r.parentNode||bi(r)&&r.host||St(r);return bi(t)?t.host:t}function ki(r){const t=Jt(r);return Ae(t)?r.ownerDocument?r.ownerDocument.body:r.body:Mt(t)&&Ue(t)?t:ki(t)}function _e(r,t,e){var o;t===void 0&&(t=[]),e===void 0&&(e=!0);const n=ki(r),i=n===((o=r.ownerDocument)==null?void 0:o.body),s=it(n);if(i){const l=So(s);return t.concat(s,s.visualViewport||[],Ue(n)?n:[],l&&e?_e(l):[])}return t.concat(n,_e(n,[],e))}function So(r){return r.parent&&Object.getPrototypeOf(r.parent)?r.frameElement:null}function xi(r){const t=mt(r);let e=parseFloat(t.width)||0,o=parseFloat(t.height)||0;const n=Mt(r),i=n?r.offsetWidth:e,s=n?r.offsetHeight:o,l=vr(e)!==i||vr(o)!==s;return l&&(e=i,o=s),{width:e,height:o,$:l}}function Mo(r){return ft(r)?r:r.contextElement}function De(r){const t=Mo(r);if(!Mt(t))return xt(1);const e=t.getBoundingClientRect(),{width:o,height:n,$:i}=xi(t);let s=(i?vr(e.width):e.width)/o,l=(i?vr(e.height):e.height)/n;return(!s||!Number.isFinite(s))&&(s=1),(!l||!Number.isFinite(l))&&(l=1),{x:s,y:l}}const rh=xt(0);function Si(r){const t=it(r);return!xo()||!t.visualViewport?rh:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function oh(r,t,e){return t===void 0&&(t=!1),!e||t&&e!==it(r)?!1:t}function ie(r,t,e,o){t===void 0&&(t=!1),e===void 0&&(e=!1);const n=r.getBoundingClientRect(),i=Mo(r);let s=xt(1);t&&(o?ft(o)&&(s=De(o)):s=De(r));const l=oh(i,e,o)?Si(i):xt(0);let a=(n.left+l.x)/s.x,c=(n.top+l.y)/s.y,h=n.width/s.x,d=n.height/s.y;if(i){const p=it(i),f=o&&ft(o)?it(o):o;let u=p,m=So(u);for(;m&&o&&f!==u;){const g=De(m),y=m.getBoundingClientRect(),k=mt(m),x=y.left+(m.clientLeft+parseFloat(k.paddingLeft))*g.x,b=y.top+(m.clientTop+parseFloat(k.paddingTop))*g.y;a*=g.x,c*=g.y,h*=g.x,d*=g.y,a+=x,c+=b,u=it(m),m=So(u)}}return xr({width:h,height:d,x:a,y:c})}function Co(r,t){const e=Or(r).scrollLeft;return t?t.left+e:ie(St(r)).left+e}function Mi(r,t,e){e===void 0&&(e=!1);const o=r.getBoundingClientRect(),n=o.left+t.scrollLeft-(e?0:Co(r,o)),i=o.top+t.scrollTop;return{x:n,y:i}}function nh(r){let{elements:t,rect:e,offsetParent:o,strategy:n}=r;const i=n==="fixed",s=St(o),l=t?Mr(t.floating):!1;if(o===s||l&&i)return e;let a={scrollLeft:0,scrollTop:0},c=xt(1);const h=xt(0),d=Mt(o);if((d||!d&&!i)&&((Te(o)!=="body"||Ue(s))&&(a=Or(o)),Mt(o))){const f=ie(o);c=De(o),h.x=f.x+o.clientLeft,h.y=f.y+o.clientTop}const p=s&&!d&&!i?Mi(s,a,!0):xt(0);return{width:e.width*c.x,height:e.height*c.y,x:e.x*c.x-a.scrollLeft*c.x+h.x+p.x,y:e.y*c.y-a.scrollTop*c.y+h.y+p.y}}function ih(r){return Array.from(r.getClientRects())}function sh(r){const t=St(r),e=Or(r),o=r.ownerDocument.body,n=nt(t.scrollWidth,t.clientWidth,o.scrollWidth,o.clientWidth),i=nt(t.scrollHeight,t.clientHeight,o.scrollHeight,o.clientHeight);let s=-e.scrollLeft+Co(r);const l=-e.scrollTop;return mt(o).direction==="rtl"&&(s+=nt(t.clientWidth,o.clientWidth)-n),{width:n,height:i,x:s,y:l}}function lh(r,t){const e=it(r),o=St(r),n=e.visualViewport;let i=o.clientWidth,s=o.clientHeight,l=0,a=0;if(n){i=n.width,s=n.height;const c=xo();(!c||c&&t==="fixed")&&(l=n.offsetLeft,a=n.offsetTop)}return{width:i,height:s,x:l,y:a}}function ah(r,t){const e=ie(r,!0,t==="fixed"),o=e.top+r.clientTop,n=e.left+r.clientLeft,i=Mt(r)?De(r):xt(1),s=r.clientWidth*i.x,l=r.clientHeight*i.y,a=n*i.x,c=o*i.y;return{width:s,height:l,x:a,y:c}}function Ci(r,t,e){let o;if(t==="viewport")o=lh(r,e);else if(t==="document")o=sh(St(r));else if(ft(t))o=ah(t,e);else{const n=Si(r);o={x:t.x-n.x,y:t.y-n.y,width:t.width,height:t.height}}return xr(o)}function Oi(r,t){const e=Jt(r);return e===t||!ft(e)||Ae(e)?!1:mt(e).position==="fixed"||Oi(e,t)}function ch(r,t){const e=t.get(r);if(e)return e;let o=_e(r,[],!1).filter(l=>ft(l)&&Te(l)!=="body"),n=null;const i=mt(r).position==="fixed";let s=i?Jt(r):r;for(;ft(s)&&!Ae(s);){const l=mt(s),a=Cr(s);!a&&l.position==="fixed"&&(n=null),(i?!a&&!n:!a&&l.position==="static"&&n&&["absolute","fixed"].includes(n.position)||Ue(s)&&!a&&Oi(r,s))?o=o.filter(c=>c!==s):n=l,s=Jt(s)}return t.set(r,o),o}function hh(r){let{element:t,boundary:e,rootBoundary:o,strategy:n}=r;const i=[...e==="clippingAncestors"?Mr(t)?[]:ch(t,this._c):[].concat(e),o],s=i[0],l=i.reduce((a,c)=>{const h=Ci(t,c,n);return a.top=nt(h.top,a.top),a.right=jt(h.right,a.right),a.bottom=jt(h.bottom,a.bottom),a.left=nt(h.left,a.left),a},Ci(t,s,n));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function dh(r){const{width:t,height:e}=xi(r);return{width:t,height:e}}function ph(r,t,e){const o=Mt(t),n=St(t),i=e==="fixed",s=ie(r,!0,i,t);let l={scrollLeft:0,scrollTop:0};const a=xt(0);function c(){a.x=Co(n)}if(o||!o&&!i)if((Te(t)!=="body"||Ue(n))&&(l=Or(t)),o){const f=ie(t,!0,i,t);a.x=f.x+t.clientLeft,a.y=f.y+t.clientTop}else n&&c();i&&!o&&n&&c();const h=n&&!o&&!i?Mi(n,l):xt(0),d=s.left+l.scrollLeft-a.x-h.x,p=s.top+l.scrollTop-a.y-h.y;return{x:d,y:p,width:s.width,height:s.height}}function Oo(r){return mt(r).position==="static"}function Ni(r,t){if(!Mt(r)||mt(r).position==="fixed")return null;if(t)return t(r);let e=r.offsetParent;return St(r)===e&&(e=e.ownerDocument.body),e}function Ti(r,t){const e=it(r);if(Mr(r))return e;if(!Mt(r)){let n=Jt(r);for(;n&&!Ae(n);){if(ft(n)&&!Oo(n))return n;n=Jt(n)}return e}let o=Ni(r,t);for(;o&&th(o)&&Oo(o);)o=Ni(o,t);return o&&Ae(o)&&Oo(o)&&!Cr(o)?e:o||eh(r)||e}const uh=async function(r){const t=this.getOffsetParent||Ti,e=this.getDimensions,o=await e(r.floating);return{reference:ph(r.reference,await t(r.floating),r.strategy),floating:{x:0,y:0,width:o.width,height:o.height}}};function fh(r){return mt(r).direction==="rtl"}const Nr={convertOffsetParentRelativeRectToViewportRelativeRect:nh,getDocumentElement:St,getClippingRect:hh,getOffsetParent:Ti,getElementRects:uh,getClientRects:ih,getDimensions:dh,getScale:De,isElement:ft,isRTL:fh};function Ai(r,t){return r.x===t.x&&r.y===t.y&&r.width===t.width&&r.height===t.height}function mh(r,t){let e=null,o;const n=St(r);function i(){var l;clearTimeout(o),(l=e)==null||l.disconnect(),e=null}function s(l,a){l===void 0&&(l=!1),a===void 0&&(a=1),i();const c=r.getBoundingClientRect(),{left:h,top:d,width:p,height:f}=c;if(l||t(),!p||!f)return;const u=br(d),m=br(n.clientWidth-(h+p)),g=br(n.clientHeight-(d+f)),y=br(h),k={rootMargin:-u+"px "+-m+"px "+-g+"px "+-y+"px",threshold:nt(0,jt(1,a))||1};let x=!0;function b(C){const T=C[0].intersectionRatio;if(T!==a){if(!x)return s();T?s(!1,T):o=setTimeout(()=>{s(!1,1e-7)},1e3)}T===1&&!Ai(c,r.getBoundingClientRect())&&s(),x=!1}try{e=new IntersectionObserver(b,{...k,root:n.ownerDocument})}catch{e=new IntersectionObserver(b,k)}e.observe(r)}return s(!0),i}function gh(r,t,e,o){o===void 0&&(o={});const{ancestorScroll:n=!0,ancestorResize:i=!0,elementResize:s=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:a=!1}=o,c=Mo(r),h=n||i?[...c?_e(c):[],..._e(t)]:[];h.forEach(y=>{n&&y.addEventListener("scroll",e,{passive:!0}),i&&y.addEventListener("resize",e)});const d=c&&l?mh(c,e):null;let p=-1,f=null;s&&(f=new ResizeObserver(y=>{let[k]=y;k&&k.target===c&&f&&(f.unobserve(t),cancelAnimationFrame(p),p=requestAnimationFrame(()=>{var x;(x=f)==null||x.observe(t)})),e()}),c&&!a&&f.observe(c),f.observe(t));let u,m=a?ie(r):null;a&&g();function g(){const y=ie(r);m&&!Ai(m,y)&&e(),m=y,u=requestAnimationFrame(g)}return e(),()=>{var y;h.forEach(k=>{n&&k.removeEventListener("scroll",e),i&&k.removeEventListener("resize",e)}),d==null||d(),(y=f)==null||y.disconnect(),f=null,a&&cancelAnimationFrame(u)}}const yh=Yc,wh=Zc,vh=Gc,Di=Qc,bh=_c,kh=(r,t,e)=>{const o=new Map,n={platform:Nr,...e},i={...n.platform,_c:o};return Uc(r,t,{...n,platform:i})};/**
* @license
* Copyright 2018 Google LLC
* SPDX-License-Identifier: BSD-3-Clause
*/const Ge=Qn(class extends ti{constructor(r){var t;if(super(r),r.type!==Zn.ATTRIBUTE||r.name!=="class"||((t=r.strings)==null?void 0:t.length)>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(r){return" "+Object.keys(r).filter(t=>r[t]).join(" ")+" "}update(r,[t]){var o,n;if(this.st===void 0){this.st=new Set,r.strings!==void 0&&(this.nt=new Set(r.strings.join(" ").split(/\s/).filter(i=>i!=="")));for(const i in t)t[i]&&!((o=this.nt)!=null&&o.has(i))&&this.st.add(i);return this.render(t)}const e=r.element.classList;for(const i of this.st)i in t||(e.remove(i),this.st.delete(i));for(const i in t){const s=!!t[i];s===this.st.has(i)||(n=this.nt)!=null&&n.has(i)||(s?(e.add(i),this.st.add(i)):(e.remove(i),this.st.delete(i)))}return oc}});function xh(r){return Sh(r)}function No(r){return r.assignedSlot?r.assignedSlot:r.parentNode instanceof ShadowRoot?r.parentNode.host:r.parentNode}function Sh(r){for(let t=r;t;t=No(t))if(t instanceof Element&&getComputedStyle(t).display==="none")return null;for(let t=No(r);t;t=No(t)){if(!(t instanceof Element))continue;const e=getComputedStyle(t);if(e.display!=="contents"&&(e.position!=="static"||Cr(e)||t.tagName==="BODY"))return t}return null}function Mh(r){return r!==null&&typeof r=="object"&&"getBoundingClientRect"in r&&("contextElement"in r?r.contextElement instanceof Element:!0)}var P=class extends bt{constructor(){super(...arguments),this.localize=new wr(this),this.active=!1,this.placement="top",this.strategy="absolute",this.distance=0,this.skidding=0,this.arrow=!1,this.arrowPlacement="anchor",this.arrowPadding=10,this.flip=!1,this.flipFallbackPlacements="",this.flipFallbackStrategy="best-fit",this.flipPadding=0,this.shift=!1,this.shiftPadding=0,this.autoSizePadding=0,this.hoverBridge=!1,this.updateHoverBridge=()=>{if(this.hoverBridge&&this.anchorEl){const r=this.anchorEl.getBoundingClientRect(),t=this.popup.getBoundingClientRect(),e=this.placement.includes("top")||this.placement.includes("bottom");let o=0,n=0,i=0,s=0,l=0,a=0,c=0,h=0;e?r.top<t.top?(o=r.left,n=r.bottom,i=r.right,s=r.bottom,l=t.left,a=t.top,c=t.right,h=t.top):(o=t.left,n=t.bottom,i=t.right,s=t.bottom,l=r.left,a=r.top,c=r.right,h=r.top):r.left<t.left?(o=r.right,n=r.top,i=t.left,s=t.top,l=r.right,a=r.bottom,c=t.left,h=t.bottom):(o=t.right,n=t.top,i=r.left,s=r.top,l=t.right,a=t.bottom,c=r.left,h=r.bottom),this.style.setProperty("--hover-bridge-top-left-x",`${o}px`),this.style.setProperty("--hover-bridge-top-left-y",`${n}px`),this.style.setProperty("--hover-bridge-top-right-x",`${i}px`),this.style.setProperty("--hover-bridge-top-right-y",`${s}px`),this.style.setProperty("--hover-bridge-bottom-left-x",`${l}px`),this.style.setProperty("--hover-bridge-bottom-left-y",`${a}px`),this.style.setProperty("--hover-bridge-bottom-right-x",`${c}px`),this.style.setProperty("--hover-bridge-bottom-right-y",`${h}px`)}}}async connectedCallback(){super.connectedCallback(),await this.updateComplete,this.start()}disconnectedCallback(){super.disconnectedCallback(),this.stop()}async updated(r){super.updated(r),r.has("active")&&(this.active?this.start():this.stop()),r.has("anchor")&&this.handleAnchorChange(),this.active&&(await this.updateComplete,this.reposition())}async handleAnchorChange(){if(await this.stop(),this.anchor&&typeof this.anchor=="string"){const r=this.getRootNode();this.anchorEl=r.getElementById(this.anchor)}else this.anchor instanceof Element||Mh(this.anchor)?this.anchorEl=this.anchor:this.anchorEl=this.querySelector('[slot="anchor"]');this.anchorEl instanceof HTMLSlotElement&&(this.anchorEl=this.anchorEl.assignedElements({flatten:!0})[0]),this.anchorEl&&this.active&&this.start()}start(){!this.anchorEl||!this.active||(this.cleanup=gh(this.anchorEl,this.popup,()=>{this.reposition()}))}async stop(){return new Promise(r=>{this.cleanup?(this.cleanup(),this.cleanup=void 0,this.removeAttribute("data-current-placement"),this.style.removeProperty("--auto-size-available-width"),this.style.removeProperty("--auto-size-available-height"),requestAnimationFrame(()=>r())):r()})}reposition(){if(!this.active||!this.anchorEl)return;const r=[yh({mainAxis:this.distance,crossAxis:this.skidding})];this.sync?r.push(Di({apply:({rects:e})=>{const o=this.sync==="width"||this.sync==="both",n=this.sync==="height"||this.sync==="both";this.popup.style.width=o?`${e.reference.width}px`:"",this.popup.style.height=n?`${e.reference.height}px`:""}})):(this.popup.style.width="",this.popup.style.height=""),this.flip&&r.push(vh({boundary:this.flipBoundary,fallbackPlacements:this.flipFallbackPlacements,fallbackStrategy:this.flipFallbackStrategy==="best-fit"?"bestFit":"initialPlacement",padding:this.flipPadding})),this.shift&&r.push(wh({boundary:this.shiftBoundary,padding:this.shiftPadding})),this.autoSize?r.push(Di({boundary:this.autoSizeBoundary,padding:this.autoSizePadding,apply:({availableWidth:e,availableHeight:o})=>{this.autoSize==="vertical"||this.autoSize==="both"?this.style.setProperty("--auto-size-available-height",`${o}px`):this.style.removeProperty("--auto-size-available-height"),this.autoSize==="horizontal"||this.autoSize==="both"?this.style.setProperty("--auto-size-available-width",`${e}px`):this.style.removeProperty("--auto-size-available-width")}})):(this.style.removeProperty("--auto-size-available-width"),this.style.removeProperty("--auto-size-available-height")),this.arrow&&r.push(bh({element:this.arrowEl,padding:this.arrowPadding}));const t=this.strategy==="absolute"?e=>Nr.getOffsetParent(e,xh):Nr.getOffsetParent;kh(this.anchorEl,this.popup,{placement:this.placement,middleware:r,strategy:this.strategy,platform:ho(He({},Nr),{getOffsetParent:t})}).then(({x:e,y:o,middlewareData:n,placement:i})=>{const s=this.localize.dir()==="rtl",l={top:"bottom",right:"left",bottom:"top",left:"right"}[i.split("-")[0]];if(this.setAttribute("data-current-placement",i),Object.assign(this.popup.style,{left:`${e}px`,top:`${o}px`}),this.arrow){const a=n.arrow.x,c=n.arrow.y;let h="",d="",p="",f="";if(this.arrowPlacement==="start"){const u=typeof a=="number"?`calc(${this.arrowPadding}px - var(--arrow-padding-offset))`:"";h=typeof c=="number"?`calc(${this.arrowPadding}px - var(--arrow-padding-offset))`:"",d=s?u:"",f=s?"":u}else if(this.arrowPlacement==="end"){const u=typeof a=="number"?`calc(${this.arrowPadding}px - var(--arrow-padding-offset))`:"";d=s?"":u,f=s?u:"",p=typeof c=="number"?`calc(${this.arrowPadding}px - var(--arrow-padding-offset))`:""}else this.arrowPlacement==="center"?(f=typeof a=="number"?"calc(50% - var(--arrow-size-diagonal))":"",h=typeof c=="number"?"calc(50% - var(--arrow-size-diagonal))":""):(f=typeof a=="number"?`${a}px`:"",h=typeof c=="number"?`${c}px`:"");Object.assign(this.arrowEl.style,{top:h,right:d,bottom:p,left:f,[l]:"calc(var(--arrow-size-diagonal) * -1)"})}}),requestAnimationFrame(()=>this.updateHoverBridge()),this.emit("sl-reposition")}render(){return ut`
      <slot name="anchor" @slotchange=${this.handleAnchorChange}></slot>

      <span
        part="hover-bridge"
        class=${Ge({"popup-hover-bridge":!0,"popup-hover-bridge--visible":this.hoverBridge&&this.active})}
      ></span>

      <div
        part="popup"
        class=${Ge({popup:!0,"popup--active":this.active,"popup--fixed":this.strategy==="fixed","popup--has-arrow":this.arrow})}
      >
        <slot></slot>
        ${this.arrow?ut`<div part="arrow" class="popup__arrow" role="presentation"></div>`:""}
      </div>
    `}};P.styles=[Me,$c],S([xe(".popup")],P.prototype,"popup",2),S([xe(".popup__arrow")],P.prototype,"arrowEl",2),S([N()],P.prototype,"anchor",2),S([N({type:Boolean,reflect:!0})],P.prototype,"active",2),S([N({reflect:!0})],P.prototype,"placement",2),S([N({reflect:!0})],P.prototype,"strategy",2),S([N({type:Number})],P.prototype,"distance",2),S([N({type:Number})],P.prototype,"skidding",2),S([N({type:Boolean})],P.prototype,"arrow",2),S([N({attribute:"arrow-placement"})],P.prototype,"arrowPlacement",2),S([N({attribute:"arrow-padding",type:Number})],P.prototype,"arrowPadding",2),S([N({type:Boolean})],P.prototype,"flip",2),S([N({attribute:"flip-fallback-placements",converter:{fromAttribute:r=>r.split(" ").map(t=>t.trim()).filter(t=>t!==""),toAttribute:r=>r.join(" ")}})],P.prototype,"flipFallbackPlacements",2),S([N({attribute:"flip-fallback-strategy"})],P.prototype,"flipFallbackStrategy",2),S([N({type:Object})],P.prototype,"flipBoundary",2),S([N({attribute:"flip-padding",type:Number})],P.prototype,"flipPadding",2),S([N({type:Boolean})],P.prototype,"shift",2),S([N({type:Object})],P.prototype,"shiftBoundary",2),S([N({attribute:"shift-padding",type:Number})],P.prototype,"shiftPadding",2),S([N({attribute:"auto-size"})],P.prototype,"autoSize",2),S([N()],P.prototype,"sync",2),S([N({type:Object})],P.prototype,"autoSizeBoundary",2),S([N({attribute:"auto-size-padding",type:Number})],P.prototype,"autoSizePadding",2),S([N({attribute:"hover-bridge",type:Boolean})],P.prototype,"hoverBridge",2);var Ei=new Map,Ch=new WeakMap;function Oh(r){return r??{keyframes:[],options:{duration:0}}}function Ri(r,t){return t.toLowerCase()==="rtl"?{keyframes:r.rtlKeyframes||r.keyframes,options:r.options}:r}function To(r,t){Ei.set(r,Oh(t))}function Ao(r,t,e){const o=Ch.get(r);if(o!=null&&o[t])return Ri(o[t],e.dir);const n=Ei.get(t);return n?Ri(n,e.dir):{keyframes:[],options:{duration:0}}}function Do(r,t){return new Promise(e=>{function o(n){n.target===r&&(r.removeEventListener(t,o),e())}r.addEventListener(t,o)})}function Eo(r,t,e){return new Promise(o=>{if((e==null?void 0:e.duration)===1/0)throw new Error("Promise-based animations must be finite.");const n=r.animate(t,ho(He({},e),{duration:Nh()?0:e.duration}));n.addEventListener("cancel",o,{once:!0}),n.addEventListener("finish",o,{once:!0})})}function Pi(r){return r=r.toString().toLowerCase(),r.indexOf("ms")>-1?parseFloat(r):r.indexOf("s")>-1?parseFloat(r)*1e3:parseFloat(r)}function Nh(){return window.matchMedia("(prefers-reduced-motion: reduce)").matches}function Ro(r){return Promise.all(r.getAnimations().map(t=>new Promise(e=>{t.cancel(),requestAnimationFrame(e)})))}var J=class extends bt{constructor(){super(),this.localize=new wr(this),this.content="",this.placement="top",this.disabled=!1,this.distance=8,this.open=!1,this.skidding=0,this.trigger="hover focus",this.hoist=!1,this.handleBlur=()=>{this.hasTrigger("focus")&&this.hide()},this.handleClick=()=>{this.hasTrigger("click")&&(this.open?this.hide():this.show())},this.handleFocus=()=>{this.hasTrigger("focus")&&this.show()},this.handleDocumentKeyDown=r=>{r.key==="Escape"&&(r.stopPropagation(),this.hide())},this.handleMouseOver=()=>{if(this.hasTrigger("hover")){const r=Pi(getComputedStyle(this).getPropertyValue("--show-delay"));clearTimeout(this.hoverTimeout),this.hoverTimeout=window.setTimeout(()=>this.show(),r)}},this.handleMouseOut=()=>{if(this.hasTrigger("hover")){const r=Pi(getComputedStyle(this).getPropertyValue("--hide-delay"));clearTimeout(this.hoverTimeout),this.hoverTimeout=window.setTimeout(()=>this.hide(),r)}},this.addEventListener("blur",this.handleBlur,!0),this.addEventListener("focus",this.handleFocus,!0),this.addEventListener("click",this.handleClick),this.addEventListener("mouseover",this.handleMouseOver),this.addEventListener("mouseout",this.handleMouseOut)}disconnectedCallback(){var r;super.disconnectedCallback(),(r=this.closeWatcher)==null||r.destroy(),document.removeEventListener("keydown",this.handleDocumentKeyDown)}firstUpdated(){this.body.hidden=!this.open,this.open&&(this.popup.active=!0,this.popup.reposition())}hasTrigger(r){return this.trigger.split(" ").includes(r)}async handleOpenChange(){var r,t;if(this.open){if(this.disabled)return;this.emit("sl-show"),"CloseWatcher"in window?((r=this.closeWatcher)==null||r.destroy(),this.closeWatcher=new CloseWatcher,this.closeWatcher.onclose=()=>{this.hide()}):document.addEventListener("keydown",this.handleDocumentKeyDown),await Ro(this.body),this.body.hidden=!1,this.popup.active=!0;const{keyframes:e,options:o}=Ao(this,"tooltip.show",{dir:this.localize.dir()});await Eo(this.popup.popup,e,o),this.popup.reposition(),this.emit("sl-after-show")}else{this.emit("sl-hide"),(t=this.closeWatcher)==null||t.destroy(),document.removeEventListener("keydown",this.handleDocumentKeyDown),await Ro(this.body);const{keyframes:e,options:o}=Ao(this,"tooltip.hide",{dir:this.localize.dir()});await Eo(this.popup.popup,e,o),this.popup.active=!1,this.body.hidden=!0,this.emit("sl-after-hide")}}async handleOptionsChange(){this.hasUpdated&&(await this.updateComplete,this.popup.reposition())}handleDisabledChange(){this.disabled&&this.open&&this.hide()}async show(){if(!this.open)return this.open=!0,Do(this,"sl-after-show")}async hide(){if(this.open)return this.open=!1,Do(this,"sl-after-hide")}render(){return ut`
      <sl-popup
        part="base"
        exportparts="
          popup:base__popup,
          arrow:base__arrow
        "
        class=${Ge({tooltip:!0,"tooltip--open":this.open})}
        placement=${this.placement}
        distance=${this.distance}
        skidding=${this.skidding}
        strategy=${this.hoist?"fixed":"absolute"}
        flip
        shift
        arrow
        hover-bridge
      >
        ${""}
        <slot slot="anchor" aria-describedby="tooltip"></slot>

        ${""}
        <div part="body" id="tooltip" class="tooltip__body" role="tooltip" aria-live=${this.open?"polite":"off"}>
          <slot name="content">${this.content}</slot>
        </div>
      </sl-popup>
    `}};J.styles=[Me,zc],J.dependencies={"sl-popup":P},S([xe("slot:not([name])")],J.prototype,"defaultSlot",2),S([xe(".tooltip__body")],J.prototype,"body",2),S([xe("sl-popup")],J.prototype,"popup",2),S([N()],J.prototype,"content",2),S([N()],J.prototype,"placement",2),S([N({type:Boolean,reflect:!0})],J.prototype,"disabled",2),S([N({type:Number})],J.prototype,"distance",2),S([N({type:Boolean,reflect:!0})],J.prototype,"open",2),S([N({type:Number})],J.prototype,"skidding",2),S([N()],J.prototype,"trigger",2),S([N({type:Boolean})],J.prototype,"hoist",2),S([Se("open",{waitUntilFirstUpdate:!0})],J.prototype,"handleOpenChange",1),S([Se(["content","distance","hoist","placement","skidding"])],J.prototype,"handleOptionsChange",1),S([Se("disabled")],J.prototype,"handleDisabledChange",1),To("tooltip.show",{keyframes:[{opacity:0,scale:.8},{opacity:1,scale:1}],options:{duration:150,easing:"ease"}}),To("tooltip.hide",{keyframes:[{opacity:1,scale:1},{opacity:0,scale:.8}],options:{duration:150,easing:"ease"}}),J.define("sl-tooltip");var Xe=function(r,t,e,o){var n=arguments.length,i=n<3?t:o===null?o=Object.getOwnPropertyDescriptor(t,e):o,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,t,e,o);else for(var l=r.length-1;l>=0;l--)(s=r[l])&&(i=(n<3?s(i):n>3?s(t,e,i):s(t,e))||i);return n>3&&i&&Object.defineProperty(t,e,i),i};let se=class extends _n{constructor(){super(...arguments),this.tooltip=!1}get _iconSize(){return this.iconSize?this.iconSize:this.tooltip!==!1?"32px":"64px"}renderIcon(){return ut`
			<sl-icon
				style="color: red; height: ${this._iconSize}; width: ${this._iconSize};"
				src="${ei(ri)}"
			></sl-icon>
		`}renderFull(){return ut` <div class="column center-content" style="flex: 1; gap: 8px">
			${this.renderIcon()}
			<div style="max-width: 500px; text-align: center" class="column">
				${this.headline?ut` <span style="margin-bottom: 8px">${this.headline} </span>`:ut``}
				<span class="placeholder"
					>${typeof this.error=="object"&&"message"in this.error?this.error.message:this.error}
				</span>
			</div>
		</div>`}renderTooltip(){return ut`
			<sl-tooltip hoist .content=${this.headline?this.headline:this.error}>
				${this.renderIcon()}</sl-tooltip
			>
		`}render(){return this.tooltip!==!1?this.renderTooltip():this.renderFull()}};se.styles=[ac,vt`
			:host {
				display: flex;
			}
		`],Xe([N({attribute:"tooltip"})],se.prototype,"tooltip",void 0),Xe([N()],se.prototype,"headline",void 0),Xe([N()],se.prototype,"error",void 0),Xe([N({attribute:"icon-size"})],se.prototype,"iconSize",void 0),se=Xe([cc("display-error")],se);/**
* @license
* Copyright 2021 Google LLC
* SPDX-License-Identifier: BSD-3-Clause
*/const Bi="lit-localize-status";/**
* @license
* Copyright 2021 Google LLC
* SPDX-License-Identifier: BSD-3-Clause
*/const Th=r=>typeof r!="string"&&"strTag"in r,Ah=(r,t,e)=>{let o=r[0];for(let n=1;n<r.length;n++)o+=t[n-1],o+=r[n];return o};/**
* @license
* Copyright 2021 Google LLC
* SPDX-License-Identifier: BSD-3-Clause
*/const Dh=r=>Th(r)?Ah(r.strings,r.values):r;let Eh=Dh;/**
* @license
* Copyright 2021 Google LLC
* SPDX-License-Identifier: BSD-3-Clause
*/class Rh{constructor(t){this.__litLocalizeEventHandler=e=>{e.detail.status==="ready"&&this.host.requestUpdate()},this.host=t}hostConnected(){window.addEventListener(Bi,this.__litLocalizeEventHandler)}hostDisconnected(){window.removeEventListener(Bi,this.__litLocalizeEventHandler)}}const Ph=r=>r.addController(new Rh(r)),Bh=Ph;/**
* @license
* Copyright 2021 Google LLC
* SPDX-License-Identifier: BSD-3-Clause
*/const Ih=()=>(r,t)=>(r.addInitializer(Bh),r);/**
* @license
* Copyright 2020 Google LLC
* SPDX-License-Identifier: BSD-3-Clause
*/class zh{constructor(){this.settled=!1,this.promise=new Promise((t,e)=>{this._resolve=t,this._reject=e})}resolve(t){this.settled=!0,this._resolve(t)}reject(t){this.settled=!0,this._reject(t)}}/**
* @license
* Copyright 2014 Travis Webb
* SPDX-License-Identifier: MIT
*/for(let r=0;r<256;r++)(r>>4&15).toString(16)+(r&15).toString(16);/**
* @license
* Copyright 2021 Google LLC
* SPDX-License-Identifier: BSD-3-Clause
*/let $h=new zh;$h.resolve();var Fh=vt`
  :host {
    --track-width: 2px;
    --track-color: rgb(128 128 128 / 25%);
    --indicator-color: var(--sl-color-primary-600);
    --speed: 2s;

    display: inline-flex;
    width: 1em;
    height: 1em;
    flex: none;
  }

  .spinner {
    flex: 1 1 auto;
    height: 100%;
    width: 100%;
  }

  .spinner__track,
  .spinner__indicator {
    fill: none;
    stroke-width: var(--track-width);
    r: calc(0.5em - var(--track-width) / 2);
    cx: 0.5em;
    cy: 0.5em;
    transform-origin: 50% 50%;
  }

  .spinner__track {
    stroke: var(--track-color);
    transform-origin: 0% 0%;
  }

  .spinner__indicator {
    stroke: var(--indicator-color);
    stroke-linecap: round;
    stroke-dasharray: 150% 75%;
    animation: spin var(--speed) linear infinite;
  }

  @keyframes spin {
    0% {
      transform: rotate(0deg);
      stroke-dasharray: 0.05em, 3em;
    }

    50% {
      transform: rotate(450deg);
      stroke-dasharray: 1.375em, 1.375em;
    }

    100% {
      transform: rotate(1080deg);
      stroke-dasharray: 0.05em, 3em;
    }
  }
`,Po=class extends bt{constructor(){super(...arguments),this.localize=new wr(this)}render(){return ut`
      <svg part="base" class="spinner" role="progressbar" aria-label=${this.localize.term("loading")}>
        <circle class="spinner__track"></circle>
        <circle class="spinner__indicator"></circle>
      </svg>
    `}};Po.styles=[Me,Fh],Po.define("sl-spinner");function H(r){this.content=r}H.prototype={constructor:H,find:function(r){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===r)return t;return-1},get:function(r){var t=this.find(r);return t==-1?void 0:this.content[t+1]},update:function(r,t,e){var o=e&&e!=r?this.remove(e):this,n=o.find(r),i=o.content.slice();return n==-1?i.push(e||r,t):(i[n+1]=t,e&&(i[n]=e)),new H(i)},remove:function(r){var t=this.find(r);if(t==-1)return this;var e=this.content.slice();return e.splice(t,2),new H(e)},addToStart:function(r,t){return new H([r,t].concat(this.remove(r).content))},addToEnd:function(r,t){var e=this.remove(r).content.slice();return e.push(r,t),new H(e)},addBefore:function(r,t,e){var o=this.remove(t),n=o.content.slice(),i=o.find(r);return n.splice(i==-1?n.length:i,0,t,e),new H(n)},forEach:function(r){for(var t=0;t<this.content.length;t+=2)r(this.content[t],this.content[t+1])},prepend:function(r){return r=H.from(r),r.size?new H(r.content.concat(this.subtract(r).content)):this},append:function(r){return r=H.from(r),r.size?new H(this.subtract(r).content.concat(r.content)):this},subtract:function(r){var t=this;r=H.from(r);for(var e=0;e<r.content.length;e+=2)t=t.remove(r.content[e]);return t},toObject:function(){var r={};return this.forEach(function(t,e){r[t]=e}),r},get size(){return this.content.length>>1}},H.from=function(r){if(r instanceof H)return r;var t=[];if(r)for(var e in r)t.push(e,r[e]);return new H(t)};function Ii(r,t,e){for(let o=0;;o++){if(o==r.childCount||o==t.childCount)return r.childCount==t.childCount?null:e;let n=r.child(o),i=t.child(o);if(n==i){e+=n.nodeSize;continue}if(!n.sameMarkup(i))return e;if(n.isText&&n.text!=i.text){for(let s=0;n.text[s]==i.text[s];s++)e++;return e}if(n.content.size||i.content.size){let s=Ii(n.content,i.content,e+1);if(s!=null)return s}e+=n.nodeSize}}function zi(r,t,e,o){for(let n=r.childCount,i=t.childCount;;){if(n==0||i==0)return n==i?null:{a:e,b:o};let s=r.child(--n),l=t.child(--i),a=s.nodeSize;if(s==l){e-=a,o-=a;continue}if(!s.sameMarkup(l))return{a:e,b:o};if(s.isText&&s.text!=l.text){let c=0,h=Math.min(s.text.length,l.text.length);for(;c<h&&s.text[s.text.length-c-1]==l.text[l.text.length-c-1];)c++,e--,o--;return{a:e,b:o}}if(s.content.size||l.content.size){let c=zi(s.content,l.content,e-1,o-1);if(c)return c}e-=a,o-=a}}class w{constructor(t,e){if(this.content=t,this.size=e||0,e==null)for(let o=0;o<t.length;o++)this.size+=t[o].nodeSize}nodesBetween(t,e,o,n=0,i){for(let s=0,l=0;l<e;s++){let a=this.content[s],c=l+a.nodeSize;if(c>t&&o(a,n+l,i||null,s)!==!1&&a.content.size){let h=l+1;a.nodesBetween(Math.max(0,t-h),Math.min(a.content.size,e-h),o,n+h)}l=c}}descendants(t){this.nodesBetween(0,this.size,t)}textBetween(t,e,o,n){let i="",s=!0;return this.nodesBetween(t,e,(l,a)=>{let c=l.isText?l.text.slice(Math.max(t,a)-a,e-a):l.isLeaf?n?typeof n=="function"?n(l):n:l.type.spec.leafText?l.type.spec.leafText(l):"":"";l.isBlock&&(l.isLeaf&&c||l.isTextblock)&&o&&(s?s=!1:i+=o),i+=c},0),i}append(t){if(!t.size)return this;if(!this.size)return t;let e=this.lastChild,o=t.firstChild,n=this.content.slice(),i=0;for(e.isText&&e.sameMarkup(o)&&(n[n.length-1]=e.withText(e.text+o.text),i=1);i<t.content.length;i++)n.push(t.content[i]);return new w(n,this.size+t.size)}cut(t,e=this.size){if(t==0&&e==this.size)return this;let o=[],n=0;if(e>t)for(let i=0,s=0;s<e;i++){let l=this.content[i],a=s+l.nodeSize;a>t&&((s<t||a>e)&&(l.isText?l=l.cut(Math.max(0,t-s),Math.min(l.text.length,e-s)):l=l.cut(Math.max(0,t-s-1),Math.min(l.content.size,e-s-1))),o.push(l),n+=l.nodeSize),s=a}return new w(o,n)}cutByIndex(t,e){return t==e?w.empty:t==0&&e==this.content.length?this:new w(this.content.slice(t,e))}replaceChild(t,e){let o=this.content[t];if(o==e)return this;let n=this.content.slice(),i=this.size+e.nodeSize-o.nodeSize;return n[t]=e,new w(n,i)}addToStart(t){return new w([t].concat(this.content),this.size+t.nodeSize)}addToEnd(t){return new w(this.content.concat(t),this.size+t.nodeSize)}eq(t){if(this.content.length!=t.content.length)return!1;for(let e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(t){let e=this.content[t];if(!e)throw new RangeError("Index "+t+" out of range for "+this);return e}maybeChild(t){return this.content[t]||null}forEach(t){for(let e=0,o=0;e<this.content.length;e++){let n=this.content[e];t(n,o,e),o+=n.nodeSize}}findDiffStart(t,e=0){return Ii(this,t,e)}findDiffEnd(t,e=this.size,o=t.size){return zi(this,t,e,o)}findIndex(t,e=-1){if(t==0)return Tr(0,t);if(t==this.size)return Tr(this.content.length,t);if(t>this.size||t<0)throw new RangeError(`Position ${t} outside of fragment (${this})`);for(let o=0,n=0;;o++){let i=this.child(o),s=n+i.nodeSize;if(s>=t)return s==t||e>0?Tr(o+1,s):Tr(o,n);n=s}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(t=>t.toJSON()):null}static fromJSON(t,e){if(!e)return w.empty;if(!Array.isArray(e))throw new RangeError("Invalid input for Fragment.fromJSON");return new w(e.map(t.nodeFromJSON))}static fromArray(t){if(!t.length)return w.empty;let e,o=0;for(let n=0;n<t.length;n++){let i=t[n];o+=i.nodeSize,n&&i.isText&&t[n-1].sameMarkup(i)?(e||(e=t.slice(0,n)),e[e.length-1]=i.withText(e[e.length-1].text+i.text)):e&&e.push(i)}return new w(e||t,o)}static from(t){if(!t)return w.empty;if(t instanceof w)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new w([t],t.nodeSize);throw new RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}w.empty=new w([],0);const Bo={index:0,offset:0};function Tr(r,t){return Bo.index=r,Bo.offset=t,Bo}function Ar(r,t){if(r===t)return!0;if(!(r&&typeof r=="object")||!(t&&typeof t=="object"))return!1;let e=Array.isArray(r);if(Array.isArray(t)!=e)return!1;if(e){if(r.length!=t.length)return!1;for(let o=0;o<r.length;o++)if(!Ar(r[o],t[o]))return!1}else{for(let o in r)if(!(o in t)||!Ar(r[o],t[o]))return!1;for(let o in t)if(!(o in r))return!1}return!0}class E{constructor(t,e){this.type=t,this.attrs=e}addToSet(t){let e,o=!1;for(let n=0;n<t.length;n++){let i=t[n];if(this.eq(i))return t;if(this.type.excludes(i.type))e||(e=t.slice(0,n));else{if(i.type.excludes(this.type))return t;!o&&i.type.rank>this.type.rank&&(e||(e=t.slice(0,n)),e.push(this),o=!0),e&&e.push(i)}}return e||(e=t.slice()),o||e.push(this),e}removeFromSet(t){for(let e=0;e<t.length;e++)if(this.eq(t[e]))return t.slice(0,e).concat(t.slice(e+1));return t}isInSet(t){for(let e=0;e<t.length;e++)if(this.eq(t[e]))return!0;return!1}eq(t){return this==t||this.type==t.type&&Ar(this.attrs,t.attrs)}toJSON(){let t={type:this.type.name};for(let e in this.attrs){t.attrs=this.attrs;break}return t}static fromJSON(t,e){if(!e)throw new RangeError("Invalid input for Mark.fromJSON");let o=t.marks[e.type];if(!o)throw new RangeError(`There is no mark type ${e.type} in this schema`);let n=o.create(e.attrs);return o.checkAttrs(n.attrs),n}static sameSet(t,e){if(t==e)return!0;if(t.length!=e.length)return!1;for(let o=0;o<t.length;o++)if(!t[o].eq(e[o]))return!1;return!0}static setFrom(t){if(!t||Array.isArray(t)&&t.length==0)return E.none;if(t instanceof E)return[t];let e=t.slice();return e.sort((o,n)=>o.type.rank-n.type.rank),e}}E.none=[];class Dr extends Error{}class v{constructor(t,e,o){this.content=t,this.openStart=e,this.openEnd=o}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(t,e){let o=Fi(this.content,t+this.openStart,e);return o&&new v(o,this.openStart,this.openEnd)}removeBetween(t,e){return new v($i(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)}eq(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t}static fromJSON(t,e){if(!e)return v.empty;let o=e.openStart||0,n=e.openEnd||0;if(typeof o!="number"||typeof n!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new v(w.fromJSON(t,e.content),o,n)}static maxOpen(t,e=!0){let o=0,n=0;for(let i=t.firstChild;i&&!i.isLeaf&&(e||!i.type.spec.isolating);i=i.firstChild)o++;for(let i=t.lastChild;i&&!i.isLeaf&&(e||!i.type.spec.isolating);i=i.lastChild)n++;return new v(t,o,n)}}v.empty=new v(w.empty,0,0);function $i(r,t,e){let{index:o,offset:n}=r.findIndex(t),i=r.maybeChild(o),{index:s,offset:l}=r.findIndex(e);if(n==t||i.isText){if(l!=e&&!r.child(s).isText)throw new RangeError("Removing non-flat range");return r.cut(0,t).append(r.cut(e))}if(o!=s)throw new RangeError("Removing non-flat range");return r.replaceChild(o,i.copy($i(i.content,t-n-1,e-n-1)))}function Fi(r,t,e,o){let{index:n,offset:i}=r.findIndex(t),s=r.maybeChild(n);if(i==t||s.isText)return r.cut(0,t).append(e).append(r.cut(t));let l=Fi(s.content,t-i-1,e);return l&&r.replaceChild(n,s.copy(l))}function Lh(r,t,e){if(e.openStart>r.depth)throw new Dr("Inserted content deeper than insertion position");if(r.depth-e.openStart!=t.depth-e.openEnd)throw new Dr("Inconsistent open depths");return Li(r,t,e,0)}function Li(r,t,e,o){let n=r.index(o),i=r.node(o);if(n==t.index(o)&&o<r.depth-e.openStart){let s=Li(r,t,e,o+1);return i.copy(i.content.replaceChild(n,s))}else if(e.content.size)if(!e.openStart&&!e.openEnd&&r.depth==o&&t.depth==o){let s=r.parent,l=s.content;return ae(s,l.cut(0,r.parentOffset).append(e.content).append(l.cut(t.parentOffset)))}else{let{start:s,end:l}=Vh(e,r);return ae(i,ji(r,s,l,t,o))}else return ae(i,Er(r,t,o))}function Vi(r,t){if(!t.type.compatibleContent(r.type))throw new Dr("Cannot join "+t.type.name+" onto "+r.type.name)}function Io(r,t,e){let o=r.node(e);return Vi(o,t.node(e)),o}function le(r,t){let e=t.length-1;e>=0&&r.isText&&r.sameMarkup(t[e])?t[e]=r.withText(t[e].text+r.text):t.push(r)}function Ye(r,t,e,o){let n=(t||r).node(e),i=0,s=t?t.index(e):n.childCount;r&&(i=r.index(e),r.depth>e?i++:r.textOffset&&(le(r.nodeAfter,o),i++));for(let l=i;l<s;l++)le(n.child(l),o);t&&t.depth==e&&t.textOffset&&le(t.nodeBefore,o)}function ae(r,t){return r.type.checkContent(t),r.copy(t)}function ji(r,t,e,o,n){let i=r.depth>n&&Io(r,t,n+1),s=o.depth>n&&Io(e,o,n+1),l=[];return Ye(null,r,n,l),i&&s&&t.index(n)==e.index(n)?(Vi(i,s),le(ae(i,ji(r,t,e,o,n+1)),l)):(i&&le(ae(i,Er(r,t,n+1)),l),Ye(t,e,n,l),s&&le(ae(s,Er(e,o,n+1)),l)),Ye(o,null,n,l),new w(l)}function Er(r,t,e){let o=[];if(Ye(null,r,e,o),r.depth>e){let n=Io(r,t,e+1);le(ae(n,Er(r,t,e+1)),o)}return Ye(t,null,e,o),new w(o)}function Vh(r,t){let e=t.depth-r.openStart,o=t.node(e).copy(r.content);for(let n=e-1;n>=0;n--)o=t.node(n).copy(w.from(o));return{start:o.resolveNoCache(r.openStart+e),end:o.resolveNoCache(o.content.size-r.openEnd-e)}}class fr{constructor(t,e,o){this.pos=t,this.path=e,this.parentOffset=o,this.depth=e.length/3-1}resolveDepth(t){return t==null?this.depth:t<0?this.depth+t:t}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(t){return this.path[this.resolveDepth(t)*3]}index(t){return this.path[this.resolveDepth(t)*3+1]}indexAfter(t){return t=this.resolveDepth(t),this.index(t)+(t==this.depth&&!this.textOffset?0:1)}start(t){return t=this.resolveDepth(t),t==0?0:this.path[t*3-1]+1}end(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size}before(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]}after(t){if(t=this.resolveDepth(t),!t)throw new RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[t*3-1]+this.path[t*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;let o=this.pos-this.path[this.path.length-1],n=t.child(e);return o?t.child(e).cut(o):n}get nodeBefore(){let t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):t==0?null:this.parent.child(t-1)}posAtIndex(t,e){e=this.resolveDepth(e);let o=this.path[e*3],n=e==0?0:this.path[e*3-1]+1;for(let i=0;i<t;i++)n+=o.child(i).nodeSize;return n}marks(){let t=this.parent,e=this.index();if(t.content.size==0)return E.none;if(this.textOffset)return t.child(e).marks;let o=t.maybeChild(e-1),n=t.maybeChild(e);if(!o){let l=o;o=n,n=l}let i=o.marks;for(var s=0;s<i.length;s++)i[s].type.spec.inclusive===!1&&(!n||!i[s].isInSet(n.marks))&&(i=i[s--].removeFromSet(i));return i}marksAcross(t){let e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;let o=e.marks,n=t.parent.maybeChild(t.index());for(var i=0;i<o.length;i++)o[i].type.spec.inclusive===!1&&(!n||!o[i].isInSet(n.marks))&&(o=o[i--].removeFromSet(o));return o}sharedDepth(t){for(let e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0}blockRange(t=this,e){if(t.pos<this.pos)return t.blockRange(this);for(let o=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);o>=0;o--)if(t.pos<=this.end(o)&&(!e||e(this.node(o))))return new gt(this,t,o);return null}sameParent(t){return this.pos-this.parentOffset==t.pos-t.parentOffset}max(t){return t.pos>this.pos?t:this}min(t){return t.pos<this.pos?t:this}toString(){let t="";for(let e=1;e<=this.depth;e++)t+=(t?"/":"")+this.node(e).type.name+"_"+this.index(e-1);return t+":"+this.parentOffset}static resolve(t,e){if(!(e>=0&&e<=t.content.size))throw new RangeError("Position "+e+" out of range");let o=[],n=0,i=e;for(let s=t;;){let{index:l,offset:a}=s.content.findIndex(i),c=i-a;if(o.push(s,l,n+a),!c||(s=s.child(l),s.isText))break;i=c-1,n+=a+1}return new fr(e,o,i)}static resolveCached(t,e){let o=Wi.get(t);if(o)for(let i=0;i<o.elts.length;i++){let s=o.elts[i];if(s.pos==e)return s}else Wi.set(t,o=new jh);let n=o.elts[o.i]=fr.resolve(t,e);return o.i=(o.i+1)%Wh,n}}class jh{constructor(){this.elts=[],this.i=0}}const Wh=12,Wi=new WeakMap;class gt{constructor(t,e,o){this.$from=t,this.$to=e,this.depth=o}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const qh=Object.create(null);let ce=class Jn{constructor(t,e,o,n=E.none){this.type=t,this.attrs=e,this.marks=n,this.content=o||w.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(t){return this.content.child(t)}maybeChild(t){return this.content.maybeChild(t)}forEach(t){this.content.forEach(t)}nodesBetween(t,e,o,n=0){this.content.nodesBetween(t,e,o,n,this)}descendants(t){this.nodesBetween(0,this.content.size,t)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(t,e,o,n){return this.content.textBetween(t,e,o,n)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)}sameMarkup(t){return this.hasMarkup(t.type,t.attrs,t.marks)}hasMarkup(t,e,o){return this.type==t&&Ar(this.attrs,e||t.defaultAttrs||qh)&&E.sameSet(this.marks,o||E.none)}copy(t=null){return t==this.content?this:new Jn(this.type,this.attrs,t,this.marks)}mark(t){return t==this.marks?this:new Jn(this.type,this.attrs,this.content,t)}cut(t,e=this.content.size){return t==0&&e==this.content.size?this:this.copy(this.content.cut(t,e))}slice(t,e=this.content.size,o=!1){if(t==e)return v.empty;let n=this.resolve(t),i=this.resolve(e),s=o?0:n.sharedDepth(e),l=n.start(s),a=n.node(s).content.cut(n.pos-l,i.pos-l);return new v(a,n.depth-s,i.depth-s)}replace(t,e,o){return Lh(this.resolve(t),this.resolve(e),o)}nodeAt(t){for(let e=this;;){let{index:o,offset:n}=e.content.findIndex(t);if(e=e.maybeChild(o),!e)return null;if(n==t||e.isText)return e;t-=n+1}}childAfter(t){let{index:e,offset:o}=this.content.findIndex(t);return{node:this.content.maybeChild(e),index:e,offset:o}}childBefore(t){if(t==0)return{node:null,index:0,offset:0};let{index:e,offset:o}=this.content.findIndex(t);if(o<t)return{node:this.content.child(e),index:e,offset:o};let n=this.content.child(e-1);return{node:n,index:e-1,offset:o-n.nodeSize}}resolve(t){return fr.resolveCached(this,t)}resolveNoCache(t){return fr.resolve(this,t)}rangeHasMark(t,e,o){let n=!1;return e>t&&this.nodesBetween(t,e,i=>(o.isInSet(i.marks)&&(n=!0),!n)),n}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),qi(this.marks,t)}contentMatchAt(t){let e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw new Error("Called contentMatchAt on a node with invalid content");return e}canReplace(t,e,o=w.empty,n=0,i=o.childCount){let s=this.contentMatchAt(t).matchFragment(o,n,i),l=s&&s.matchFragment(this.content,e);if(!l||!l.validEnd)return!1;for(let a=n;a<i;a++)if(!this.type.allowsMarks(o.child(a).marks))return!1;return!0}canReplaceWith(t,e,o,n){if(n&&!this.type.allowsMarks(n))return!1;let i=this.contentMatchAt(t).matchType(o),s=i&&i.matchFragment(this.content,e);return s?s.validEnd:!1}canAppend(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let t=E.none;for(let e=0;e<this.marks.length;e++){let o=this.marks[e];o.type.checkAttrs(o.attrs),t=o.addToSet(t)}if(!E.sameSet(t,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(e=>e.type.name)}`);this.content.forEach(e=>e.check())}toJSON(){let t={type:this.type.name};for(let e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map(e=>e.toJSON())),t}static fromJSON(t,e){if(!e)throw new RangeError("Invalid input for Node.fromJSON");let o;if(e.marks){if(!Array.isArray(e.marks))throw new RangeError("Invalid mark data for Node.fromJSON");o=e.marks.map(t.markFromJSON)}if(e.type=="text"){if(typeof e.text!="string")throw new RangeError("Invalid text node in JSON");return t.text(e.text,o)}let n=w.fromJSON(t,e.content),i=t.nodeType(e.type).create(e.attrs,n,o);return i.type.checkAttrs(i.attrs),i}};ce.prototype.text=void 0;class eo extends ce{constructor(t,e,o,n){if(super(t,e,null,n),!o)throw new RangeError("Empty text nodes are not allowed");this.text=o}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):qi(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(t,e){return this.text.slice(t,e)}get nodeSize(){return this.text.length}mark(t){return t==this.marks?this:new eo(this.type,this.attrs,this.text,t)}withText(t){return t==this.text?this:new eo(this.type,this.attrs,t,this.marks)}cut(t=0,e=this.text.length){return t==0&&e==this.text.length?this:this.withText(this.text.slice(t,e))}eq(t){return this.sameMarkup(t)&&this.text==t.text}toJSON(){let t=super.toJSON();return t.text=this.text,t}}function qi(r,t){for(let e=r.length-1;e>=0;e--)t=r[e].type.name+"("+t+")";return t}class we{constructor(t){this.validEnd=t,this.next=[],this.wrapCache=[]}static parse(t,e){let o=new Jh(t,e);if(o.next==null)return we.empty;let n=Ji(o);o.next&&o.err("Unexpected trailing text");let i=Yh(Xh(n));return Zh(i,o),i}matchType(t){for(let e=0;e<this.next.length;e++)if(this.next[e].type==t)return this.next[e].next;return null}matchFragment(t,e=0,o=t.childCount){let n=this;for(let i=e;n&&i<o;i++)n=n.matchType(t.child(i).type);return n}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let t=0;t<this.next.length;t++){let{type:e}=this.next[t];if(!(e.isText||e.hasRequiredAttrs()))return e}return null}compatible(t){for(let e=0;e<this.next.length;e++)for(let o=0;o<t.next.length;o++)if(this.next[e].type==t.next[o].type)return!0;return!1}fillBefore(t,e=!1,o=0){let n=[this];function i(s,l){let a=s.matchFragment(t,o);if(a&&(!e||a.validEnd))return w.from(l.map(c=>c.createAndFill()));for(let c=0;c<s.next.length;c++){let{type:h,next:d}=s.next[c];if(!(h.isText||h.hasRequiredAttrs())&&n.indexOf(d)==-1){n.push(d);let p=i(d,l.concat(h));if(p)return p}}return null}return i(this,[])}findWrapping(t){for(let o=0;o<this.wrapCache.length;o+=2)if(this.wrapCache[o]==t)return this.wrapCache[o+1];let e=this.computeWrapping(t);return this.wrapCache.push(t,e),e}computeWrapping(t){let e=Object.create(null),o=[{match:this,type:null,via:null}];for(;o.length;){let n=o.shift(),i=n.match;if(i.matchType(t)){let s=[];for(let l=n;l.type;l=l.via)s.push(l.type);return s.reverse()}for(let s=0;s<i.next.length;s++){let{type:l,next:a}=i.next[s];!l.isLeaf&&!l.hasRequiredAttrs()&&!(l.name in e)&&(!n.type||a.validEnd)&&(o.push({match:l.contentMatch,type:l,via:n}),e[l.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(t){if(t>=this.next.length)throw new RangeError(`There's no ${t}th edge in this content match`);return this.next[t]}toString(){let t=[];function e(o){t.push(o);for(let n=0;n<o.next.length;n++)t.indexOf(o.next[n].next)==-1&&e(o.next[n].next)}return e(this),t.map((o,n)=>{let i=n+(o.validEnd?"*":" ")+" ";for(let s=0;s<o.next.length;s++)i+=(s?", ":"")+o.next[s].type.name+"->"+t.indexOf(o.next[s].next);return i}).join(`
`)}}we.empty=new we(!0);class Jh{constructor(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(t){return this.next==t&&(this.pos++||!0)}err(t){throw new SyntaxError(t+" (in content expression '"+this.string+"')")}}function Ji(r){let t=[];do t.push(Hh(r));while(r.eat("|"));return t.length==1?t[0]:{type:"choice",exprs:t}}function Hh(r){let t=[];do t.push(Kh(r));while(r.next&&r.next!=")"&&r.next!="|");return t.length==1?t[0]:{type:"seq",exprs:t}}function Kh(r){let t=Gh(r);for(;;)if(r.eat("+"))t={type:"plus",expr:t};else if(r.eat("*"))t={type:"star",expr:t};else if(r.eat("?"))t={type:"opt",expr:t};else if(r.eat("{"))t=Uh(r,t);else break;return t}function Hi(r){/\D/.test(r.next)&&r.err("Expected number, got '"+r.next+"'");let t=Number(r.next);return r.pos++,t}function Uh(r,t){let e=Hi(r),o=e;return r.eat(",")&&(r.next!="}"?o=Hi(r):o=-1),r.eat("}")||r.err("Unclosed braced range"),{type:"range",min:e,max:o,expr:t}}function _h(r,t){let e=r.nodeTypes,o=e[t];if(o)return[o];let n=[];for(let i in e){let s=e[i];s.isInGroup(t)&&n.push(s)}return n.length==0&&r.err("No node type or group '"+t+"' found"),n}function Gh(r){if(r.eat("(")){let t=Ji(r);return r.eat(")")||r.err("Missing closing paren"),t}else if(/\W/.test(r.next))r.err("Unexpected token '"+r.next+"'");else{let t=_h(r,r.next).map(e=>(r.inline==null?r.inline=e.isInline:r.inline!=e.isInline&&r.err("Mixing inline and block content"),{type:"name",value:e}));return r.pos++,t.length==1?t[0]:{type:"choice",exprs:t}}}function Xh(r){let t=[[]];return n(i(r,0),e()),t;function e(){return t.push([])-1}function o(s,l,a){let c={term:a,to:l};return t[s].push(c),c}function n(s,l){s.forEach(a=>a.to=l)}function i(s,l){if(s.type=="choice")return s.exprs.reduce((a,c)=>a.concat(i(c,l)),[]);if(s.type=="seq")for(let a=0;;a++){let c=i(s.exprs[a],l);if(a==s.exprs.length-1)return c;n(c,l=e())}else if(s.type=="star"){let a=e();return o(l,a),n(i(s.expr,a),a),[o(a)]}else if(s.type=="plus"){let a=e();return n(i(s.expr,l),a),n(i(s.expr,a),a),[o(a)]}else{if(s.type=="opt")return[o(l)].concat(i(s.expr,l));if(s.type=="range"){let a=l;for(let c=0;c<s.min;c++){let h=e();n(i(s.expr,a),h),a=h}if(s.max==-1)n(i(s.expr,a),a);else for(let c=s.min;c<s.max;c++){let h=e();o(a,h),n(i(s.expr,a),h),a=h}return[o(a)]}else{if(s.type=="name")return[o(l,void 0,s.value)];throw new Error("Unknown expr type")}}}}function Ki(r,t){return t-r}function Ui(r,t){let e=[];return o(t),e.sort(Ki);function o(n){let i=r[n];if(i.length==1&&!i[0].term)return o(i[0].to);e.push(n);for(let s=0;s<i.length;s++){let{term:l,to:a}=i[s];!l&&e.indexOf(a)==-1&&o(a)}}}function Yh(r){let t=Object.create(null);return e(Ui(r,0));function e(o){let n=[];o.forEach(s=>{r[s].forEach(({term:l,to:a})=>{if(!l)return;let c;for(let h=0;h<n.length;h++)n[h][0]==l&&(c=n[h][1]);Ui(r,a).forEach(h=>{c||n.push([l,c=[]]),c.indexOf(h)==-1&&c.push(h)})})});let i=t[o.join(",")]=new we(o.indexOf(r.length-1)>-1);for(let s=0;s<n.length;s++){let l=n[s][1].sort(Ki);i.next.push({type:n[s][0],next:t[l.join(",")]||e(l)})}return i}}function Zh(r,t){for(let e=0,o=[r];e<o.length;e++){let n=o[e],i=!n.validEnd,s=[];for(let l=0;l<n.next.length;l++){let{type:a,next:c}=n.next[l];s.push(a.name),i&&!(a.isText||a.hasRequiredAttrs())&&(i=!1),o.indexOf(c)==-1&&o.push(c)}i&&t.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function _i(r){let t=Object.create(null);for(let e in r){let o=r[e];if(!o.hasDefault)return null;t[e]=o.default}return t}function Gi(r,t){let e=Object.create(null);for(let o in r){let n=t&&t[o];if(n===void 0){let i=r[o];if(i.hasDefault)n=i.default;else throw new RangeError("No value supplied for attribute "+o)}e[o]=n}return e}function Xi(r,t,e,o){for(let n in t)if(!(n in r))throw new RangeError(`Unsupported attribute ${n} for ${e} of type ${n}`);for(let n in r){let i=r[n];i.validate&&i.validate(t[n])}}function Yi(r,t){let e=Object.create(null);if(t)for(let o in t)e[o]=new td(r,o,t[o]);return e}let Zi=class Xa{constructor(t,e,o){this.name=t,this.schema=e,this.spec=o,this.markSet=null,this.groups=o.group?o.group.split(" "):[],this.attrs=Yi(t,o.attrs),this.defaultAttrs=_i(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(o.inline||t=="text"),this.isText=t=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==we.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(t){return this.groups.indexOf(t)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1}compatibleContent(t){return this==t||this.contentMatch.compatible(t.contentMatch)}computeAttrs(t){return!t&&this.defaultAttrs?this.defaultAttrs:Gi(this.attrs,t)}create(t=null,e,o){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new ce(this,this.computeAttrs(t),w.from(e),E.setFrom(o))}createChecked(t=null,e,o){return e=w.from(e),this.checkContent(e),new ce(this,this.computeAttrs(t),e,E.setFrom(o))}createAndFill(t=null,e,o){if(t=this.computeAttrs(t),e=w.from(e),e.size){let s=this.contentMatch.fillBefore(e);if(!s)return null;e=s.append(e)}let n=this.contentMatch.matchFragment(e),i=n&&n.fillBefore(w.empty,!0);return i?new ce(this,t,e.append(i),E.setFrom(o)):null}validContent(t){let e=this.contentMatch.matchFragment(t);if(!e||!e.validEnd)return!1;for(let o=0;o<t.childCount;o++)if(!this.allowsMarks(t.child(o).marks))return!1;return!0}checkContent(t){if(!this.validContent(t))throw new RangeError(`Invalid content for node ${this.name}: ${t.toString().slice(0,50)}`)}checkAttrs(t){Xi(this.attrs,t,"node",this.name)}allowsMarkType(t){return this.markSet==null||this.markSet.indexOf(t)>-1}allowsMarks(t){if(this.markSet==null)return!0;for(let e=0;e<t.length;e++)if(!this.allowsMarkType(t[e].type))return!1;return!0}allowedMarks(t){if(this.markSet==null)return t;let e;for(let o=0;o<t.length;o++)this.allowsMarkType(t[o].type)?e&&e.push(t[o]):e||(e=t.slice(0,o));return e?e.length?e:E.none:t}static compile(t,e){let o=Object.create(null);t.forEach((i,s)=>o[i]=new Xa(i,e,s));let n=e.spec.topNode||"doc";if(!o[n])throw new RangeError("Schema is missing its top node type ('"+n+"')");if(!o.text)throw new RangeError("Every schema needs a 'text' type");for(let i in o.text.attrs)throw new RangeError("The text node type should not have attributes");return o}};function Qh(r,t,e){let o=e.split("|");return n=>{let i=n===null?"null":typeof n;if(o.indexOf(i)<0)throw new RangeError(`Expected value of type ${o} for attribute ${t} on type ${r}, got ${i}`)}}class td{constructor(t,e,o){this.hasDefault=Object.prototype.hasOwnProperty.call(o,"default"),this.default=o.default,this.validate=typeof o.validate=="string"?Qh(t,e,o.validate):o.validate}get isRequired(){return!this.hasDefault}}class ro{constructor(t,e,o,n){this.name=t,this.rank=e,this.schema=o,this.spec=n,this.attrs=Yi(t,n.attrs),this.excluded=null;let i=_i(this.attrs);this.instance=i?new E(this,i):null}create(t=null){return!t&&this.instance?this.instance:new E(this,Gi(this.attrs,t))}static compile(t,e){let o=Object.create(null),n=0;return t.forEach((i,s)=>o[i]=new ro(i,n++,e,s)),o}removeFromSet(t){for(var e=0;e<t.length;e++)t[e].type==this&&(t=t.slice(0,e).concat(t.slice(e+1)),e--);return t}isInSet(t){for(let e=0;e<t.length;e++)if(t[e].type==this)return t[e]}checkAttrs(t){Xi(this.attrs,t,"mark",this.name)}excludes(t){return this.excluded.indexOf(t)>-1}}class Qi{constructor(t){this.linebreakReplacement=null,this.cached=Object.create(null);let e=this.spec={};for(let n in t)e[n]=t[n];e.nodes=H.from(t.nodes),e.marks=H.from(t.marks||{}),this.nodes=Zi.compile(this.spec.nodes,this),this.marks=ro.compile(this.spec.marks,this);let o=Object.create(null);for(let n in this.nodes){if(n in this.marks)throw new RangeError(n+" can not be both a node and a mark");let i=this.nodes[n],s=i.spec.content||"",l=i.spec.marks;if(i.contentMatch=o[s]||(o[s]=we.parse(s,this.nodes)),i.inlineContent=i.contentMatch.inlineContent,i.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!i.isInline||!i.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=i}i.markSet=l=="_"?null:l?ts(this,l.split(" ")):l==""||!i.inlineContent?[]:null}for(let n in this.marks){let i=this.marks[n],s=i.spec.excludes;i.excluded=s==null?[i]:s==""?[]:ts(this,s.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(t,e=null,o,n){if(typeof t=="string")t=this.nodeType(t);else if(t instanceof Zi){if(t.schema!=this)throw new RangeError("Node type from different schema used ("+t.name+")")}else throw new RangeError("Invalid node type: "+t);return t.createChecked(e,o,n)}text(t,e){let o=this.nodes.text;return new eo(o,o.defaultAttrs,t,E.setFrom(e))}mark(t,e){return typeof t=="string"&&(t=this.marks[t]),t.create(e)}nodeFromJSON(t){return ce.fromJSON(this,t)}markFromJSON(t){return E.fromJSON(this,t)}nodeType(t){let e=this.nodes[t];if(!e)throw new RangeError("Unknown node type: "+t);return e}}function ts(r,t){let e=[];for(let o=0;o<t.length;o++){let n=t[o],i=r.marks[n],s=i;if(i)e.push(i);else for(let l in r.marks){let a=r.marks[l];(n=="_"||a.spec.group&&a.spec.group.split(" ").indexOf(n)>-1)&&e.push(s=a)}if(!s)throw new SyntaxError("Unknown mark type: '"+t[o]+"'")}return e}function ed(r){return r.tag!=null}function rd(r){return r.style!=null}let es=class Hn{constructor(t,e){this.schema=t,this.rules=e,this.tags=[],this.styles=[];let o=this.matchedStyles=[];e.forEach(n=>{if(ed(n))this.tags.push(n);else if(rd(n)){let i=/[^=]*/.exec(n.style)[0];o.indexOf(i)<0&&o.push(i),this.styles.push(n)}}),this.normalizeLists=!this.tags.some(n=>{if(!/^(ul|ol)\b/.test(n.tag)||!n.node)return!1;let i=t.nodes[n.node];return i.contentMatch.matchType(i)})}parse(t,e={}){let o=new ss(this,e,!1);return o.addAll(t,E.none,e.from,e.to),o.finish()}parseSlice(t,e={}){let o=new ss(this,e,!0);return o.addAll(t,E.none,e.from,e.to),v.maxOpen(o.finish())}matchTag(t,e,o){for(let n=o?this.tags.indexOf(o)+1:0;n<this.tags.length;n++){let i=this.tags[n];if(id(t,i.tag)&&(i.namespace===void 0||t.namespaceURI==i.namespace)&&(!i.context||e.matchesContext(i.context))){if(i.getAttrs){let s=i.getAttrs(t);if(s===!1)continue;i.attrs=s||void 0}return i}}}matchStyle(t,e,o,n){for(let i=n?this.styles.indexOf(n)+1:0;i<this.styles.length;i++){let s=this.styles[i],l=s.style;if(!(l.indexOf(t)!=0||s.context&&!o.matchesContext(s.context)||l.length>t.length&&(l.charCodeAt(t.length)!=61||l.slice(t.length+1)!=e))){if(s.getAttrs){let a=s.getAttrs(e);if(a===!1)continue;s.attrs=a||void 0}return s}}}static schemaRules(t){let e=[];function o(n){let i=n.priority==null?50:n.priority,s=0;for(;s<e.length;s++){let l=e[s];if((l.priority==null?50:l.priority)<i)break}e.splice(s,0,n)}for(let n in t.marks){let i=t.marks[n].spec.parseDOM;i&&i.forEach(s=>{o(s=ls(s)),s.mark||s.ignore||s.clearMark||(s.mark=n)})}for(let n in t.nodes){let i=t.nodes[n].spec.parseDOM;i&&i.forEach(s=>{o(s=ls(s)),s.node||s.ignore||s.mark||(s.node=n)})}return e}static fromSchema(t){return t.cached.domParser||(t.cached.domParser=new Hn(t,Hn.schemaRules(t)))}};const rs={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},od={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},ns={ol:!0,ul:!0},Ze=1,zo=2,Rr=4;function is(r,t,e){return t!=null?(t?Ze:0)|(t==="full"?zo:0):r&&r.whitespace=="pre"?Ze|zo:e&-5}class Pr{constructor(t,e,o,n,i,s){this.type=t,this.attrs=e,this.marks=o,this.solid=n,this.options=s,this.content=[],this.activeMarks=E.none,this.match=i||(s&Rr?null:t.contentMatch)}findWrapping(t){if(!this.match){if(!this.type)return[];let e=this.type.contentMatch.fillBefore(w.from(t));if(e)this.match=this.type.contentMatch.matchFragment(e);else{let o=this.type.contentMatch,n;return(n=o.findWrapping(t.type))?(this.match=o,n):null}}return this.match.findWrapping(t.type)}finish(t){if(!(this.options&Ze)){let o=this.content[this.content.length-1],n;if(o&&o.isText&&(n=/[ \t\r\n\u000c]+$/.exec(o.text))){let i=o;o.text.length==n[0].length?this.content.pop():this.content[this.content.length-1]=i.withText(i.text.slice(0,i.text.length-n[0].length))}}let e=w.from(this.content);return!t&&this.match&&(e=e.append(this.match.fillBefore(w.empty,!0))),this.type?this.type.create(this.attrs,e,this.marks):e}inlineContext(t){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:t.parentNode&&!rs.hasOwnProperty(t.parentNode.nodeName.toLowerCase())}}class ss{constructor(t,e,o){this.parser=t,this.options=e,this.isOpen=o,this.open=0,this.localPreserveWS=!1;let n=e.topNode,i,s=is(null,e.preserveWhitespace,0)|(o?Rr:0);n?i=new Pr(n.type,n.attrs,E.none,!0,e.topMatch||n.type.contentMatch,s):o?i=new Pr(null,null,E.none,!0,null,s):i=new Pr(t.schema.topNodeType,null,E.none,!0,null,s),this.nodes=[i],this.find=e.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(t,e){t.nodeType==3?this.addTextNode(t,e):t.nodeType==1&&this.addElement(t,e)}addTextNode(t,e){let o=t.nodeValue,n=this.top,i=n.options&zo?"full":this.localPreserveWS||(n.options&Ze)>0;if(i==="full"||n.inlineContext(t)||/[^ \t\r\n\u000c]/.test(o)){if(i)i!=="full"?o=o.replace(/\r?\n|\r/g," "):o=o.replace(/\r\n?/g,`
`);else if(o=o.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(o)&&this.open==this.nodes.length-1){let s=n.content[n.content.length-1],l=t.previousSibling;(!s||l&&l.nodeName=="BR"||s.isText&&/[ \t\r\n\u000c]$/.test(s.text))&&(o=o.slice(1))}o&&this.insertNode(this.parser.schema.text(o),e,!/\S/.test(o)),this.findInText(t)}else this.findInside(t)}addElement(t,e,o){let n=this.localPreserveWS,i=this.top;(t.tagName=="PRE"||/pre/.test(t.style&&t.style.whiteSpace))&&(this.localPreserveWS=!0);let s=t.nodeName.toLowerCase(),l;ns.hasOwnProperty(s)&&this.parser.normalizeLists&&nd(t);let a=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(l=this.parser.matchTag(t,this,o));t:if(a?a.ignore:od.hasOwnProperty(s))this.findInside(t),this.ignoreFallback(t,e);else if(!a||a.skip||a.closeParent){a&&a.closeParent?this.open=Math.max(0,this.open-1):a&&a.skip.nodeType&&(t=a.skip);let c,h=this.needsBlock;if(rs.hasOwnProperty(s))i.content.length&&i.content[0].isInline&&this.open&&(this.open--,i=this.top),c=!0,i.type||(this.needsBlock=!0);else if(!t.firstChild){this.leafFallback(t,e);break t}let d=a&&a.skip?e:this.readStyles(t,e);d&&this.addAll(t,d),c&&this.sync(i),this.needsBlock=h}else{let c=this.readStyles(t,e);c&&this.addElementByRule(t,a,c,a.consuming===!1?l:void 0)}this.localPreserveWS=n}leafFallback(t,e){t.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode(`
`),e)}ignoreFallback(t,e){t.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),e,!0)}readStyles(t,e){let o=t.style;if(o&&o.length)for(let n=0;n<this.parser.matchedStyles.length;n++){let i=this.parser.matchedStyles[n],s=o.getPropertyValue(i);if(s)for(let l=void 0;;){let a=this.parser.matchStyle(i,s,this,l);if(!a)break;if(a.ignore)return null;if(a.clearMark?e=e.filter(c=>!a.clearMark(c)):e=e.concat(this.parser.schema.marks[a.mark].create(a.attrs)),a.consuming===!1)l=a;else break}}return e}addElementByRule(t,e,o,n){let i,s;if(e.node)if(s=this.parser.schema.nodes[e.node],s.isLeaf)this.insertNode(s.create(e.attrs),o,t.nodeName=="BR")||this.leafFallback(t,o);else{let a=this.enter(s,e.attrs||null,o,e.preserveWhitespace);a&&(i=!0,o=a)}else{let a=this.parser.schema.marks[e.mark];o=o.concat(a.create(e.attrs))}let l=this.top;if(s&&s.isLeaf)this.findInside(t);else if(n)this.addElement(t,o,n);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach(a=>this.insertNode(a,o,!1));else{let a=t;typeof e.contentElement=="string"?a=t.querySelector(e.contentElement):typeof e.contentElement=="function"?a=e.contentElement(t):e.contentElement&&(a=e.contentElement),this.findAround(t,a,!0),this.addAll(a,o),this.findAround(t,a,!1)}i&&this.sync(l)&&this.open--}addAll(t,e,o,n){let i=o||0;for(let s=o?t.childNodes[o]:t.firstChild,l=n==null?null:t.childNodes[n];s!=l;s=s.nextSibling,++i)this.findAtPoint(t,i),this.addDOM(s,e);this.findAtPoint(t,i)}findPlace(t,e,o){let n,i;for(let s=this.open,l=0;s>=0;s--){let a=this.nodes[s],c=a.findWrapping(t);if(c&&(!n||n.length>c.length+l)&&(n=c,i=a,!c.length))break;if(a.solid){if(o)break;l+=2}}if(!n)return null;this.sync(i);for(let s=0;s<n.length;s++)e=this.enterInner(n[s],null,e,!1);return e}insertNode(t,e,o){if(t.isInline&&this.needsBlock&&!this.top.type){let i=this.textblockFromContext();i&&(e=this.enterInner(i,null,e))}let n=this.findPlace(t,e,o);if(n){this.closeExtra();let i=this.top;i.match&&(i.match=i.match.matchType(t.type));let s=E.none;for(let l of n.concat(t.marks))(i.type?i.type.allowsMarkType(l.type):as(l.type,t.type))&&(s=l.addToSet(s));return i.content.push(t.mark(s)),!0}return!1}enter(t,e,o,n){let i=this.findPlace(t.create(e),o,!1);return i&&(i=this.enterInner(t,e,o,!0,n)),i}enterInner(t,e,o,n=!1,i){this.closeExtra();let s=this.top;s.match=s.match&&s.match.matchType(t);let l=is(t,i,s.options);s.options&Rr&&s.content.length==0&&(l|=Rr);let a=E.none;return o=o.filter(c=>(s.type?s.type.allowsMarkType(c.type):as(c.type,t))?(a=c.addToSet(a),!1):!0),this.nodes.push(new Pr(t,e,a,n,null,l)),this.open++,o}closeExtra(t=!1){let e=this.nodes.length-1;if(e>this.open){for(;e>this.open;e--)this.nodes[e-1].content.push(this.nodes[e].finish(t));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(t){for(let e=this.open;e>=0;e--){if(this.nodes[e]==t)return this.open=e,!0;this.localPreserveWS&&(this.nodes[e].options|=Ze)}return!1}get currentPos(){this.closeExtra();let t=0;for(let e=this.open;e>=0;e--){let o=this.nodes[e].content;for(let n=o.length-1;n>=0;n--)t+=o[n].nodeSize;e&&t++}return t}findAtPoint(t,e){if(this.find)for(let o=0;o<this.find.length;o++)this.find[o].node==t&&this.find[o].offset==e&&(this.find[o].pos=this.currentPos)}findInside(t){if(this.find)for(let e=0;e<this.find.length;e++)this.find[e].pos==null&&t.nodeType==1&&t.contains(this.find[e].node)&&(this.find[e].pos=this.currentPos)}findAround(t,e,o){if(t!=e&&this.find)for(let n=0;n<this.find.length;n++)this.find[n].pos==null&&t.nodeType==1&&t.contains(this.find[n].node)&&e.compareDocumentPosition(this.find[n].node)&(o?2:4)&&(this.find[n].pos=this.currentPos)}findInText(t){if(this.find)for(let e=0;e<this.find.length;e++)this.find[e].node==t&&(this.find[e].pos=this.currentPos-(t.nodeValue.length-this.find[e].offset))}matchesContext(t){if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);let e=t.split("/"),o=this.options.context,n=!this.isOpen&&(!o||o.parent.type==this.nodes[0].type),i=-(o?o.depth+1:0)+(n?0:1),s=(l,a)=>{for(;l>=0;l--){let c=e[l];if(c==""){if(l==e.length-1||l==0)continue;for(;a>=i;a--)if(s(l-1,a))return!0;return!1}else{let h=a>0||a==0&&n?this.nodes[a].type:o&&a>=i?o.node(a-i).type:null;if(!h||h.name!=c&&!h.isInGroup(c))return!1;a--}}return!0};return s(e.length-1,this.open)}textblockFromContext(){let t=this.options.context;if(t)for(let e=t.depth;e>=0;e--){let o=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(o&&o.isTextblock&&o.defaultAttrs)return o}for(let e in this.parser.schema.nodes){let o=this.parser.schema.nodes[e];if(o.isTextblock&&o.defaultAttrs)return o}}}function nd(r){for(let t=r.firstChild,e=null;t;t=t.nextSibling){let o=t.nodeType==1?t.nodeName.toLowerCase():null;o&&ns.hasOwnProperty(o)&&e?(e.appendChild(t),t=e):o=="li"?e=t:o&&(e=null)}}function id(r,t){return(r.matches||r.msMatchesSelector||r.webkitMatchesSelector||r.mozMatchesSelector).call(r,t)}function ls(r){let t={};for(let e in r)t[e]=r[e];return t}function as(r,t){let e=t.schema.nodes;for(let o in e){let n=e[o];if(!n.allowsMarkType(r))continue;let i=[],s=l=>{i.push(l);for(let a=0;a<l.edgeCount;a++){let{type:c,next:h}=l.edge(a);if(c==t||i.indexOf(h)<0&&s(h))return!0}};if(s(n.contentMatch))return!0}}class $t{constructor(t,e){this.nodes=t,this.marks=e}serializeFragment(t,e={},o){o||(o=$o(e).createDocumentFragment());let n=o,i=[];return t.forEach(s=>{if(i.length||s.marks.length){let l=0,a=0;for(;l<i.length&&a<s.marks.length;){let c=s.marks[a];if(!this.marks[c.type.name]){a++;continue}if(!c.eq(i[l][0])||c.type.spec.spanning===!1)break;l++,a++}for(;l<i.length;)n=i.pop()[1];for(;a<s.marks.length;){let c=s.marks[a++],h=this.serializeMark(c,s.isInline,e);h&&(i.push([c,n]),n.appendChild(h.dom),n=h.contentDOM||h.dom)}}n.appendChild(this.serializeNodeInner(s,e))}),o}serializeNodeInner(t,e){let{dom:o,contentDOM:n}=Br($o(e),this.nodes[t.type.name](t),null,t.attrs);if(n){if(t.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(t.content,e,n)}return o}serializeNode(t,e={}){let o=this.serializeNodeInner(t,e);for(let n=t.marks.length-1;n>=0;n--){let i=this.serializeMark(t.marks[n],t.isInline,e);i&&((i.contentDOM||i.dom).appendChild(o),o=i.dom)}return o}serializeMark(t,e,o={}){let n=this.marks[t.type.name];return n&&Br($o(o),n(t,e),null,t.attrs)}static renderSpec(t,e,o=null,n){return Br(t,e,o,n)}static fromSchema(t){return t.cached.domSerializer||(t.cached.domSerializer=new $t(this.nodesFromSchema(t),this.marksFromSchema(t)))}static nodesFromSchema(t){let e=cs(t.nodes);return e.text||(e.text=o=>o.text),e}static marksFromSchema(t){return cs(t.marks)}}function cs(r){let t={};for(let e in r){let o=r[e].spec.toDOM;o&&(t[e]=o)}return t}function $o(r){return r.document||window.document}const hs=new WeakMap;function sd(r){let t=hs.get(r);return t===void 0&&hs.set(r,t=ld(r)),t}function ld(r){let t=null;function e(o){if(o&&typeof o=="object")if(Array.isArray(o))if(typeof o[0]=="string")t||(t=[]),t.push(o);else for(let n=0;n<o.length;n++)e(o[n]);else for(let n in o)e(o[n])}return e(r),t}function Br(r,t,e,o){if(typeof t=="string")return{dom:r.createTextNode(t)};if(t.nodeType!=null)return{dom:t};if(t.dom&&t.dom.nodeType!=null)return t;let n=t[0],i;if(typeof n!="string")throw new RangeError("Invalid array passed to renderSpec");if(o&&(i=sd(o))&&i.indexOf(t)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let s=n.indexOf(" ");s>0&&(e=n.slice(0,s),n=n.slice(s+1));let l,a=e?r.createElementNS(e,n):r.createElement(n),c=t[1],h=1;if(c&&typeof c=="object"&&c.nodeType==null&&!Array.isArray(c)){h=2;for(let d in c)if(c[d]!=null){let p=d.indexOf(" ");p>0?a.setAttributeNS(d.slice(0,p),d.slice(p+1),c[d]):a.setAttribute(d,c[d])}}for(let d=h;d<t.length;d++){let p=t[d];if(p===0){if(d<t.length-1||d>h)throw new RangeError("Content hole must be the only child of its parent node");return{dom:a,contentDOM:a}}else{let{dom:f,contentDOM:u}=Br(r,p,e,o);if(a.appendChild(f),u){if(l)throw new RangeError("Multiple content holes");l=u}}}return{dom:a,contentDOM:l}}class ds{constructor(t){pt(this,"nodeMappings");pt(this,"markMappings");pt(this,"unknownBlock");pt(this,"unknownLeaf");pt(this,"unknownMark");pt(this,"schema");const e=ad(t);cd(e.nodes);const o={attrs:{unknownMarks:{default:null}},toDOM(){return["span",{"data-unknown-mark":!0}]}};e.marks!=null?e.marks.unknownMark=o:e.marks={unknownMark:o},e.nodes.unknownLeaf={inline:!0,attrs:{isAmgBlock:{default:!0},unknownBlock:{default:null}},group:"inline",toDOM(){return document.createTextNode("u{fffc}")}};const n=new Qi(e),i=[],s=[];let l=null;for(const[a,c]of Object.entries(e.nodes)){const h=c.automerge;if(h!=null){if(h.unknownBlock){if(l!=null)throw new Error("only one node can be marked as unknownBlock");l=n.nodes[a]}if(h.block!=null)if(typeof h.block=="string"){const d={blockName:h.block,outer:null,content:n.nodes[a],isEmbed:h.isEmbed||!1};h.attrParsers!=null&&(d.attrParsers=h.attrParsers),i.push(d)}else for(const[d,p]of Object.entries(h.block.within)){if(n.nodes[d]==null)throw new Error(`${c.name} references an unknown outer node
  ${d} in its within block mapping`);i.push({blockName:p,outer:n.nodes[d],content:n.nodes[a]})}}}for(const[a,c]of Object.entries(e.marks||{})){const h=c.automerge;if(h!=null&&h.markName!=null){let d;h.parsers!=null?d=h.parsers:d={fromAutomerge:()=>({}),fromProsemirror:()=>!0},s.push({automergeMarkName:h.markName,prosemirrorMark:n.marks[a],parsers:d})}}if(l==null)throw new Error(`no unknown block specified: one node must be marked as the unknownblock
by setting the automerge.unknownBlock property to true`);this.unknownMark=n.marks.unknownMark,this.nodeMappings=i,this.markMappings=s,this.unknownLeaf=n.nodes.unknownLeaf,this.unknownBlock=l,this.schema=n}}function ad(r){const t={};for(const[o,n]of Object.entries(r.nodes)){const i=Object.assign({},n);n.attrs!=null&&(i.attrs=Object.assign({},n.attrs)),t[o]=i}const e={};if(r.marks!=null)for(const[o,n]of Object.entries(r.marks)){const i=Object.assign({},n);n.attrs!=null&&(i.attrs=Object.assign({},n.attrs)),e[o]=i}return{nodes:t,marks:e}}function cd(r){var t;for(const[e,o]of Object.entries(r))e!=="text"&&(o.attrs==null?o.attrs={isAmgBlock:{default:!1},unknownAttrs:{default:null}}:(o.attrs.isAmgBlock={default:!1},o.attrs.unknownAttrs={default:null})),(t=o.automerge)!=null&&t.unknownBlock&&(o.attrs==null?o.attrs={unknownParentBlock:{default:null},unknownBlock:{default:null}}:(o.attrs.unknownParentBlock={default:null},o.attrs.unknownBlock={default:null}));return r}function ps(r,t){const e={};return t.forEach(o=>{const n=r.markMappings.find(i=>i.prosemirrorMark===o.type);if(n!=null)e[n.automergeMarkName]=n.parsers.fromProsemirror(o);else if(o.type===r.unknownMark)for(const[i,s]of Object.entries(o.attrs.unknownMarks))e[i]=s}),e}function Fo(r,t){const e={};let o=!1;const n=[];for(const[i,s]of Object.entries(t)){if(s==null)continue;const l=r.markMappings.find(a=>a.automergeMarkName===i);l==null?(e[i]=s,o=!0):n.push(l.prosemirrorMark.create(l.parsers.fromAutomerge(s)))}return o&&n.push(r.unknownMark.create({unknownMarks:e})),n}const hd=["p",0],dd=["blockquote",0],pd=["hr"],ud=["pre",["code",0]],fd=["em",0],md=["strong",0],gd=["code",0],yd=["ol",0],wd=["ul",0],vd=["li",0],bd={nodes:{doc:{content:"block+"},paragraph:{automerge:{block:"paragraph"},content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM(){return hd}},unknownBlock:{automerge:{unknownBlock:!0},group:"block",content:"block+",parseDOM:[{tag:"div",attrs:{"data-unknown-block":"true"}}],toDOM(){return["div",{"data-unknown-block":"true"},0]}},blockquote:{automerge:{block:"blockquote"},content:"block+",group:"block",defining:!0,parseDOM:[{tag:"blockquote"}],toDOM(){return dd}},horizontal_rule:{group:"block",parseDOM:[{tag:"hr"}],toDOM(){return pd}},heading:{automerge:{block:"heading",attrParsers:{fromAutomerge:r=>({level:r.attrs.level}),fromProsemirror:r=>({level:r.attrs.level})}},attrs:{level:{default:1}},content:"inline*",group:"block",defining:!0,parseDOM:[{tag:"h1",attrs:{level:1}},{tag:"h2",attrs:{level:2}},{tag:"h3",attrs:{level:3}},{tag:"h4",attrs:{level:4}},{tag:"h5",attrs:{level:5}},{tag:"h6",attrs:{level:6}}],toDOM(r){return["h"+r.attrs.level,0]}},code_block:{automerge:{block:"code-block"},content:"text*",marks:"",group:"block",code:!0,defining:!0,parseDOM:[{tag:"pre",preserveWhitespace:"full"}],toDOM(){return ud}},text:{group:"inline"},image:{automerge:{block:"image",isEmbed:!0,attrParsers:{fromAutomerge:r=>{var t;return{src:((t=r.attrs.src)==null?void 0:t.toString())||null,alt:r.attrs.alt,title:r.attrs.title}},fromProsemirror:r=>({src:new Dt(r.attrs.src),alt:r.attrs.alt,title:r.attrs.title})}},inline:!0,attrs:{src:{},alt:{default:null},title:{default:null}},group:"inline",draggable:!0,parseDOM:[{tag:"img[src]",getAttrs(r){return{src:r.getAttribute("src"),title:r.getAttribute("title"),alt:r.getAttribute("alt")}}}],toDOM(r){const{src:t,alt:e,title:o}=r.attrs;return["img",{src:t,alt:e,title:o}]}},ordered_list:{group:"block",content:"list_item+",attrs:{order:{default:1}},parseDOM:[{tag:"ol",getAttrs(r){return{order:r.hasAttribute("start")?+r.getAttribute("start"):1}}}],toDOM(r){return r.attrs.order==1?yd:["ol",{start:r.attrs.order},0]}},bullet_list:{content:"list_item+",group:"block",parseDOM:[{tag:"ul"}],toDOM(){return wd}},list_item:{automerge:{block:{within:{ordered_list:"ordered-list-item",bullet_list:"unordered-list-item"}}},content:"paragraph block*",parseDOM:[{tag:"li"}],toDOM(){return vd},defining:!0},aside:{automerge:{block:"aside"},content:"block+",group:"block",defining:!0,parseDOM:[{tag:"aside"}],toDOM(){return["aside",0]}}},marks:{link:{attrs:{href:{},title:{default:null}},inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs(r){return{href:r.getAttribute("href"),title:r.getAttribute("title")}}}],toDOM(r){const{href:t,title:e}=r.attrs;return["a",{href:t,title:e},0]},automerge:{markName:"link",parsers:{fromAutomerge:r=>{if(typeof r=="string")try{const t=JSON.parse(r);return{href:t.href||"",title:t.title||""}}catch{console.warn("failed to parse link mark as JSON")}return{href:"",title:""}},fromProsemirror:r=>JSON.stringify({href:r.attrs.href,title:r.attrs.title})}}},em:{parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style=italic"},{style:"font-style=normal",clearMark:r=>r.type.name=="em"}],toDOM(){return fd},automerge:{markName:"em"}},strong:{parseDOM:[{tag:"strong"},{tag:"b",getAttrs:r=>r.style.fontWeight!="normal"&&null},{style:"font-weight=400",clearMark:r=>r.type.name=="strong"},{style:"font-weight",getAttrs:r=>/^(bold(er)?|[5-9]\d{2,})$/.test(r)&&null}],toDOM(){return md},automerge:{markName:"strong"}},code:{parseDOM:[{tag:"code"}],toDOM(){return gd}}}},kd=new ds(bd);function xd(r){const{type:t,parents:e,attrs:o,isEmbed:n}=r;let i;t instanceof Dt?i=t:i=new Dt("paragraph");const s={};if(o&&typeof o=="object")for(const[a,c]of Object.entries(o))s[a]=c;let l;return Sd(e)?l=e:l=[],{type:i,parents:l,attrs:s,isEmbed:!!n}}function Sd(r){if(!Array.isArray(r))return!1;for(const t of r)if(!(t instanceof Dt))return!1;return!0}function Md(r){return r.type==="text"?{type:"text",value:r.value,marks:r.marks}:{type:"block",value:xd(r.value)}}function Lo(r,t){const e=Wo(r,t),o=[{tag:"doc",attrs:{},children:[]}];let n=null;for(const i of e){if(i.type==="openTag"){const s=Object.assign({},n,i.attrs);o.push({tag:i.tag,attrs:s,children:[]})}else if(i.type==="closeTag"){const{children:s,attrs:l,tag:a}=o.pop(),c=Vo(r.schema,a,l,s);o[o.length-1].children.push(c)}else if(i.type==="leafNode")o[o.length-1].children.push(Vo(r.schema,i.tag,n||{},[]));else if(i.type==="text"){const s=Fo(r,i.marks);o[o.length-1].children.push(r.schema.text(i.text,s))}i.type==="block"?(n={isAmgBlock:!0,...i.block.attrs},i.isUnknown&&(n.unknownBlock=i.block)):n=null}if(o.length!==1)throw new Error("Invalid stack length");{const{children:i,attrs:s,tag:l}=o[0];return Vo(r.schema,l,s,i)}}function Vo(r,t,e,o){var l,a,c;const n={},i={};let s=!1;for(const h of Object.keys(e)){if(h==="isAmgBlock"||h==="unknownBlock"||h==="unknownAttrs"){n[h]=e[h];continue}((c=(a=(l=r.nodes[t])==null?void 0:l.spec)==null?void 0:a.attrs)==null?void 0:c[h])!=null?n[h]=e[h]:(s=!0,i[h]=e[h])}return s&&(n.unknownAttrs=i),r.node(t,n,o)}function Ir(r,t,e){const o=us(Wo(r,t));let n=null;for(const i of o){if(i.before.amIdx>=e&&n!=null)return n;if(i.event.type==="openTag")r.schema.nodes[i.event.tag].isTextblock&&(n=i.after.pmIdx);else if(i.event.type==="leafNode")n=i.after.pmIdx;else if(i.event.type==="text"&&(n=i.after.pmIdx,i.after.amIdx>=e&&i.before.amIdx+i.event.text.length>=e)){const s=e-i.before.amIdx;return i.before.pmIdx+s-1}}return n}function*us(r){let t=0,e=-1;for(;;){const o=r.next();if(o.done)return;const n=o.value,i={amIdx:e,pmIdx:t};n.type==="openTag"&&n.tag!=="doc"||n.type==="closeTag"&&n.tag!=="doc"||n.type==="leafNode"?t+=1:n.type==="text"?(e+=n.text.length,t+=n.text.length):n.type==="block"&&(e+=1),yield{event:n,before:i,after:{amIdx:e,pmIdx:t}}}}function*Cd(r,t){const e=[{node:t,parent:null,indexInParent:0,numChildrenInParent:t.childCount,type:"node"}],o=[];for(;e.length>0;){const n=e.pop();if(n==null)return;if(n.type==="node"){const i=n.node;if(i.isText){const s=ps(r,i.marks);yield{type:"text",text:i.text,marks:s}}else{const s=Od(r,i,o,n.indexInParent,n.numChildrenInParent),l=s!=null?"explicit":"render-only";if(s!=null){const{block:a,isUnknown:c}=s;yield{type:"block",isUnknown:c,block:a}}if(i.isLeaf)yield{type:"leafNode",tag:i.type.name,role:l};else{yield{type:"openTag",tag:i.type.name,role:l},o.push(i),e.push({type:"closeTag",tag:i.type.name,role:l});for(let a=i.childCount-1;a>=0;a--)e.push({parent:i,indexInParent:a,numChildrenInParent:i.childCount,type:"node",node:i.child(a)})}}}else n.type==="closeTag"&&o.pop(),yield n}}function Od(r,t,e,o,n){var l;if(t.attrs.unknownBlock!=null)return{isUnknown:!0,block:t.attrs.unknownBlock};const i=fs(r,t,e);if(i==null){if(t.attrs.isAmgBlock)throw new Error("no mapping found for node which is marked as a block");return null}const s=((l=i.attrParsers)==null?void 0:l.fromProsemirror(t))||{};if(t.attrs.unknownAttrs!=null)for(const a of Object.keys(t.attrs.unknownAttrs))s[a]=t.attrs.unknownAttrs[a];if(t.attrs.isAmgBlock)return{isUnknown:!1,block:{type:i.blockName,parents:jo(r,e),attrs:s,isEmbed:i.isEmbed||!1}};if(i&&i.isEmbed)return{isUnknown:!1,block:{type:i.blockName,parents:jo(r,e),attrs:s,isEmbed:!0}};{const a=Td(t);if(a!=null){const h=i.content.contentMatch.fillBefore(w.from([a.first]),!0);if(h==null)throw new Error("schema could not find wrapping");if(h.eq(a.contentBeforeFirst))return null}let c=!1;if(t.isTextblock){const h=e[e.length-1];h==null||h.type===r.schema.nodes.doc&&n>1?c=!0:h.type.contentMatch.defaultType===t.type&&o===0&&!t.attrs.isAmgBlock||(c=!0)}else Nd(t)&&(c=!0);return c?{isUnknown:i.content===r.unknownBlock,block:{type:i.blockName,parents:jo(r,e),attrs:s,isEmbed:i.isEmbed||!1}}:null}}function Nd(r){for(let t=0;t<r.childCount;t++)if(r.child(t).isTextblock)return!0;return!1}function Td(r){let t=0,e=null;const o=[];for(let n=0;n<r.childCount;n++){const i=r.child(n);let s=!1;if(i.attrs.isAmgBlock?s=!0:i.descendants(l=>l.attrs.isAmgBlock?(s=!0,!1):!0),s&&(t++,e==null&&(e=i)),e==null&&o.push(i),t>1)break}return t>0?{contentBeforeFirst:w.from(o),first:e}:null}function fs(r,t,e){if(t.type===r.unknownBlock&&t.attrs.unknownParentBlock)return{blockName:t.attrs.unknownParentBlock,content:t.type,outer:null,isEmbed:!1};const o=r.nodeMappings.filter(s=>s.content===t.type);if(o.length===0)return null;const n=e[e.length-1];let i=o[0];for(const s of o)if(n!=null&&s.outer===n.type){i=s;break}return i}function jo(r,t){const e=[];for(const[o,n]of t.entries()){if(o===t.length-1&&n.isTextblock&&!n.attrs.isAmgBlock)continue;const i=fs(r,n,t.slice(0,o));i!=null&&e.push(i.blockName)}return e}function*Wo(r,t){const e=t.map(Md);if(e.length===0)return yield*[{type:"openTag",tag:"paragraph",role:"render-only"},{type:"closeTag",tag:"paragraph",role:"render-only"}];const o=new Ad(r);for(const n of e)n.type==="block"?yield*o.newBlock(n.value):yield*o.newText(n.value,n.marks||{});yield*o.finish()}class Ad{constructor(t){pt(this,"adapter");pt(this,"lastBlock",null);pt(this,"stack",[]);pt(this,"topMatch");this.adapter=t,this.stack=[],this.topMatch=this.adapter.schema.nodes.doc.contentMatch}set currentMatch(t){if(t===null)throw new Error("Match cannot be null");this.stack.length>0?this.stack[this.stack.length-1].lastMatch=t:this.topMatch=t}get currentMatch(){return this.stack.length>0?this.stack[this.stack.length-1].lastMatch:this.topMatch}*newBlock(t){if(t.isEmbed){const{content:s}=zr(this.adapter,t.type.val,t.isEmbed),l=this.currentMatch.findWrapping(s);if(l)for(let a=0;a<l.length;a++)yield this.pushNode(l[a],null,"render-only");this.currentMatch=this.currentMatch.matchType(s),yield ms(this.adapter,t),yield{type:"leafNode",tag:s.name,role:"explicit"};return}const e=Dd(this.adapter,t);let o=0;for(;o<e.length&&o<this.stack.length&&this.stack[o].node===e[o].type;)o++;const n=this.stack.splice(o);for(const{node:s,role:l,lastMatch:a}of n.toReversed())yield*this.finishStackFrame({node:s,role:l,lastMatch:a}),yield{type:"closeTag",tag:s.name,role:l};for(let s=o;s<e.length;s++){const{type:l,attrs:a}=e[s];yield*this.fillBefore(l),yield this.pushNode(l,a,"render-only")}yield ms(this.adapter,t);const{content:i}=zr(this.adapter,t.type.val,t.isEmbed||!1);yield this.pushNode(i,null,"explicit")}pushNode(t,e,o){return this.currentMatch=this.currentMatch.matchType(t),this.stack.push({node:t,role:o,lastMatch:t.contentMatch}),{type:"openTag",tag:t.name,role:o,...e&&{attrs:e}}}*newText(t,e){const o=this.currentMatch.findWrapping(this.adapter.schema.nodes.text);if(o)for(let n=0;n<o.length;n++)yield this.pushNode(o[n],null,"render-only");this.currentMatch=this.currentMatch.matchType(this.adapter.schema.nodes.text),yield{type:"text",text:t,marks:e}}*finish(){for(const{node:t,role:e,lastMatch:o}of this.stack.toReversed())yield*this.finishStackFrame({node:t,role:e,lastMatch:o}),yield{type:"closeTag",tag:t.name,role:e}}*fillBefore(t){const e=this.currentMatch.fillBefore(w.from(t.create()));e!=null&&(yield*this.emitFragment(e),this.currentMatch=this.currentMatch.matchFragment(e))}*emitFragment(t){const e=[];for(let o=t.childCount-1;o>=0;o--)e.push({type:"open",node:t.child(o)});for(;e.length>0;){const o=e.pop();if(o==null)return;if(o.type==="open")if(yield{type:"openTag",tag:o.node.type.name,role:"render-only"},o.node.isText)yield{type:"text",text:o.node.text,marks:{}},yield{type:"closeTag",tag:o.node.type.name,role:"render-only"};else{e.push({type:"close",node:o.node.type});for(let n=o.node.childCount-1;n>=0;n--)e.push({type:"open",node:o.node.child(n)})}else yield{type:"closeTag",tag:o.node.name,role:"render-only"}}}*finishStackFrame(t){const e=t.lastMatch.fillBefore(w.empty,!0);e&&(yield*this.emitFragment(e))}}function Dd(r,t){const e=[];for(const n of t.parents){const{outer:i,content:s,attrs:l}=zr(r,n.val,!1);i!=null&&e.push({type:i,attrs:null}),e.push({type:s,attrs:l||null})}const{outer:o}=zr(r,t.type.val,t.isEmbed||!1);return o!=null&&e.push({type:o,attrs:null}),e}function ms(r,t){const e=r.nodeMappings.find(n=>n.blockName===t.type.val),o={...t.attrs};for(const[n,i]of Object.entries(o))i instanceof Dt&&(o[n]=i.val);return{type:"block",isUnknown:e==null,block:{attrs:o,parents:t.parents.map(n=>n.val),type:t.type.val,isEmbed:t.isEmbed||!1}}}function qo(r,t,{from:e,to:o}){const n=us(Wo(r,t));let i=null,s=null,l=null,a=null;for(e===0&&(i=0);l==null||l<=o||i==null||s==null;){const c=n.next();if(c.done)break;const h=c.value;if(l=h.after.pmIdx,a=h.after.amIdx,i==null){if(h.after.pmIdx<e)continue;if(h.event.type==="text")if(h.before.pmIdx>e)i=Math.max(h.before.amIdx,0)+1;else if(h.before.pmIdx+h.event.text.length>e){const d=e-h.before.pmIdx;i=h.before.amIdx+d+1}else i=Math.max(h.after.amIdx,0)+1;else h.after.pmIdx>=e&&(i=h.after.amIdx+1)}if(s==null){if(h.after.pmIdx<o)continue;if(h.event.type==="text"){if(h.before.pmIdx>=o)s=h.before.amIdx+1;else if(h.before.pmIdx+h.event.text.length>o){const d=o-h.before.pmIdx;s=h.before.amIdx+d+1}}else h.before.pmIdx>=o&&(s=h.before.amIdx+1)}}if(i!=null)return s==null&&(s=a?a+1:i),{start:i,end:s};{const c=a?a+1:0;return{start:c,end:c}}}function gs(r,t){const e=Cd(r,t),o=[];for(const n of e)if(n.type=="block"){const i={...n.block.attrs};delete i.isAmgBlock,o.push({type:"block",value:{type:new Dt(n.block.type),parents:n.block.parents.map(s=>new Dt(s)),attrs:i,isEmbed:n.block.isEmbed}})}else n.type=="text"&&o.push({type:"text",value:n.text,marks:n.marks});return o}function zr(r,t,e){const o=r.nodeMappings.find(n=>n.blockName===t);return o==null?e?{outer:null,content:r.unknownLeaf}:{outer:null,content:r.unknownBlock,attrs:{unknownParentBlock:t}}:{outer:o.outer,content:o.content}}const ys=65535,ws=Math.pow(2,16);function Ed(r,t){return r+t*ws}function vs(r){return r&ys}function Rd(r){return(r-(r&ys))/ws}const bs=1,ks=2,$r=4,xs=8;class Jo{constructor(t,e,o){this.pos=t,this.delInfo=e,this.recover=o}get deleted(){return(this.delInfo&xs)>0}get deletedBefore(){return(this.delInfo&(bs|$r))>0}get deletedAfter(){return(this.delInfo&(ks|$r))>0}get deletedAcross(){return(this.delInfo&$r)>0}}class lt{constructor(t,e=!1){if(this.ranges=t,this.inverted=e,!t.length&&lt.empty)return lt.empty}recover(t){let e=0,o=vs(t);if(!this.inverted)for(let n=0;n<o;n++)e+=this.ranges[n*3+2]-this.ranges[n*3+1];return this.ranges[o*3]+e+Rd(t)}mapResult(t,e=1){return this._map(t,e,!1)}map(t,e=1){return this._map(t,e,!0)}_map(t,e,o){let n=0,i=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?n:0);if(a>t)break;let c=this.ranges[l+i],h=this.ranges[l+s],d=a+c;if(t<=d){let p=c?t==a?-1:t==d?1:e:e,f=a+n+(p<0?0:h);if(o)return f;let u=t==(e<0?a:d)?null:Ed(l/3,t-a),m=t==a?ks:t==d?bs:$r;return(e<0?t!=a:t!=d)&&(m|=xs),new Jo(f,m,u)}n+=h-c}return o?t+n:new Jo(t+n,0,null)}touches(t,e){let o=0,n=vs(e),i=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?o:0);if(a>t)break;let c=this.ranges[l+i],h=a+c;if(t<=h&&l==n*3)return!0;o+=this.ranges[l+s]-c}return!1}forEach(t){let e=this.inverted?2:1,o=this.inverted?1:2;for(let n=0,i=0;n<this.ranges.length;n+=3){let s=this.ranges[n],l=s-(this.inverted?i:0),a=s+(this.inverted?0:i),c=this.ranges[n+e],h=this.ranges[n+o];t(l,l+c,a,a+h),i+=h-c}}invert(){return new lt(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(t){return t==0?lt.empty:new lt(t<0?[0,-t,0]:[0,0,t])}}lt.empty=new lt([]);class oo{constructor(t,e,o=0,n=t?t.length:0){this.mirror=e,this.from=o,this.to=n,this._maps=t||[],this.ownData=!(t||e)}get maps(){return this._maps}slice(t=0,e=this.maps.length){return new oo(this._maps,this.mirror,t,e)}appendMap(t,e){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(t),e!=null&&this.setMirror(this._maps.length-1,e)}appendMapping(t){for(let e=0,o=this._maps.length;e<t._maps.length;e++){let n=t.getMirror(e);this.appendMap(t._maps[e],n!=null&&n<e?o+n:void 0)}}getMirror(t){if(this.mirror){for(let e=0;e<this.mirror.length;e++)if(this.mirror[e]==t)return this.mirror[e+(e%2?-1:1)]}}setMirror(t,e){this.mirror||(this.mirror=[]),this.mirror.push(t,e)}appendMappingInverted(t){for(let e=t.maps.length-1,o=this._maps.length+t._maps.length;e>=0;e--){let n=t.getMirror(e);this.appendMap(t._maps[e].invert(),n!=null&&n>e?o-n-1:void 0)}}invert(){let t=new oo;return t.appendMappingInverted(this),t}map(t,e=1){if(this.mirror)return this._map(t,e,!0);for(let o=this.from;o<this.to;o++)t=this._maps[o].map(t,e);return t}mapResult(t,e=1){return this._map(t,e,!1)}_map(t,e,o){let n=0;for(let i=this.from;i<this.to;i++){let s=this._maps[i],l=s.mapResult(t,e);if(l.recover!=null){let a=this.getMirror(i);if(a!=null&&a>i&&a<this.to){i=a,t=this._maps[a].recover(l.recover);continue}}n|=l.delInfo,t=l.pos}return o?t:new Jo(t,n,null)}}const Ho=Object.create(null);class G{getMap(){return lt.empty}merge(t){return null}static fromJSON(t,e){if(!e||!e.stepType)throw new RangeError("Invalid input for Step.fromJSON");let o=Ho[e.stepType];if(!o)throw new RangeError(`No step type ${e.stepType} defined`);return o.fromJSON(t,e)}static jsonID(t,e){if(t in Ho)throw new RangeError("Duplicate use of step JSON ID "+t);return Ho[t]=e,e.prototype.jsonID=t,e}}class ${constructor(t,e){this.doc=t,this.failed=e}static ok(t){return new $(t,null)}static fail(t){return new $(null,t)}static fromReplace(t,e,o,n){try{return $.ok(t.replace(e,o,n))}catch(i){if(i instanceof Dr)return $.fail(i.message);throw i}}}function Ko(r,t,e){let o=[];for(let n=0;n<r.childCount;n++){let i=r.child(n);i.content.size&&(i=i.copy(Ko(i.content,t,i))),i.isInline&&(i=t(i,e,n)),o.push(i)}return w.fromArray(o)}class re extends G{constructor(t,e,o){super(),this.from=t,this.to=e,this.mark=o}apply(t){let e=t.slice(this.from,this.to),o=t.resolve(this.from),n=o.node(o.sharedDepth(this.to)),i=new v(Ko(e.content,(s,l)=>!s.isAtom||!l.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),n),e.openStart,e.openEnd);return $.fromReplace(t,this.from,this.to,i)}invert(){return new Nt(this.from,this.to,this.mark)}map(t){let e=t.mapResult(this.from,1),o=t.mapResult(this.to,-1);return e.deleted&&o.deleted||e.pos>=o.pos?null:new re(e.pos,o.pos,this.mark)}merge(t){return t instanceof re&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new re(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new re(e.from,e.to,t.markFromJSON(e.mark))}}G.jsonID("addMark",re);class Nt extends G{constructor(t,e,o){super(),this.from=t,this.to=e,this.mark=o}apply(t){let e=t.slice(this.from,this.to),o=new v(Ko(e.content,n=>n.mark(this.mark.removeFromSet(n.marks)),t),e.openStart,e.openEnd);return $.fromReplace(t,this.from,this.to,o)}invert(){return new re(this.from,this.to,this.mark)}map(t){let e=t.mapResult(this.from,1),o=t.mapResult(this.to,-1);return e.deleted&&o.deleted||e.pos>=o.pos?null:new Nt(e.pos,o.pos,this.mark)}merge(t){return t instanceof Nt&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new Nt(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Nt(e.from,e.to,t.markFromJSON(e.mark))}}G.jsonID("removeMark",Nt);class oe extends G{constructor(t,e){super(),this.pos=t,this.mark=e}apply(t){let e=t.nodeAt(this.pos);if(!e)return $.fail("No node at mark step's position");let o=e.type.create(e.attrs,null,this.mark.addToSet(e.marks));return $.fromReplace(t,this.pos,this.pos+1,new v(w.from(o),0,e.isLeaf?0:1))}invert(t){let e=t.nodeAt(this.pos);if(e){let o=this.mark.addToSet(e.marks);if(o.length==e.marks.length){for(let n=0;n<e.marks.length;n++)if(!e.marks[n].isInSet(o))return new oe(this.pos,e.marks[n]);return new oe(this.pos,this.mark)}}return new ve(this.pos,this.mark)}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new oe(e.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,e){if(typeof e.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new oe(e.pos,t.markFromJSON(e.mark))}}G.jsonID("addNodeMark",oe);class ve extends G{constructor(t,e){super(),this.pos=t,this.mark=e}apply(t){let e=t.nodeAt(this.pos);if(!e)return $.fail("No node at mark step's position");let o=e.type.create(e.attrs,null,this.mark.removeFromSet(e.marks));return $.fromReplace(t,this.pos,this.pos+1,new v(w.from(o),0,e.isLeaf?0:1))}invert(t){let e=t.nodeAt(this.pos);return!e||!this.mark.isInSet(e.marks)?this:new oe(this.pos,this.mark)}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new ve(e.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,e){if(typeof e.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new ve(e.pos,t.markFromJSON(e.mark))}}G.jsonID("removeNodeMark",ve);class F extends G{constructor(t,e,o,n=!1){super(),this.from=t,this.to=e,this.slice=o,this.structure=n}apply(t){return this.structure&&Uo(t,this.from,this.to)?$.fail("Structure replace would overwrite content"):$.fromReplace(t,this.from,this.to,this.slice)}getMap(){return new lt([this.from,this.to-this.from,this.slice.size])}invert(t){return new F(this.from,this.from+this.slice.size,t.slice(this.from,this.to))}map(t){let e=t.mapResult(this.from,1),o=t.mapResult(this.to,-1);return e.deletedAcross&&o.deletedAcross?null:new F(e.pos,Math.max(e.pos,o.pos),this.slice,this.structure)}merge(t){if(!(t instanceof F)||t.structure||this.structure)return null;if(this.from+this.slice.size==t.from&&!this.slice.openEnd&&!t.slice.openStart){let e=this.slice.size+t.slice.size==0?v.empty:new v(this.slice.content.append(t.slice.content),this.slice.openStart,t.slice.openEnd);return new F(this.from,this.to+(t.to-t.from),e,this.structure)}else if(t.to==this.from&&!this.slice.openStart&&!t.slice.openEnd){let e=this.slice.size+t.slice.size==0?v.empty:new v(t.slice.content.append(this.slice.content),t.slice.openStart,this.slice.openEnd);return new F(t.from,this.to,e,this.structure)}else return null}toJSON(){let t={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new F(e.from,e.to,v.fromJSON(t,e.slice),!!e.structure)}}G.jsonID("replace",F);class V extends G{constructor(t,e,o,n,i,s,l=!1){super(),this.from=t,this.to=e,this.gapFrom=o,this.gapTo=n,this.slice=i,this.insert=s,this.structure=l}apply(t){if(this.structure&&(Uo(t,this.from,this.gapFrom)||Uo(t,this.gapTo,this.to)))return $.fail("Structure gap-replace would overwrite content");let e=t.slice(this.gapFrom,this.gapTo);if(e.openStart||e.openEnd)return $.fail("Gap is not a flat range");let o=this.slice.insertAt(this.insert,e.content);return o?$.fromReplace(t,this.from,this.to,o):$.fail("Content does not fit in gap")}getMap(){return new lt([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(t){let e=this.gapTo-this.gapFrom;return new V(this.from,this.from+this.slice.size+e,this.from+this.insert,this.from+this.insert+e,t.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(t){let e=t.mapResult(this.from,1),o=t.mapResult(this.to,-1),n=this.from==this.gapFrom?e.pos:t.map(this.gapFrom,-1),i=this.to==this.gapTo?o.pos:t.map(this.gapTo,1);return e.deletedAcross&&o.deletedAcross||n<e.pos||i>o.pos?null:new V(e.pos,o.pos,n,i,this.slice,this.insert,this.structure)}toJSON(){let t={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,e){if(typeof e.from!="number"||typeof e.to!="number"||typeof e.gapFrom!="number"||typeof e.gapTo!="number"||typeof e.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new V(e.from,e.to,e.gapFrom,e.gapTo,v.fromJSON(t,e.slice),e.insert,!!e.structure)}}G.jsonID("replaceAround",V);function Uo(r,t,e){let o=r.resolve(t),n=e-t,i=o.depth;for(;n>0&&i>0&&o.indexAfter(i)==o.node(i).childCount;)i--,n--;if(n>0){let s=o.node(i).maybeChild(o.indexAfter(i));for(;n>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,n--}}return!1}function Pd(r,t,e,o){let n=[],i=[],s,l;r.doc.nodesBetween(t,e,(a,c,h)=>{if(!a.isInline)return;let d=a.marks;if(!o.isInSet(d)&&h.type.allowsMarkType(o.type)){let p=Math.max(c,t),f=Math.min(c+a.nodeSize,e),u=o.addToSet(d);for(let m=0;m<d.length;m++)d[m].isInSet(u)||(s&&s.to==p&&s.mark.eq(d[m])?s.to=f:n.push(s=new Nt(p,f,d[m])));l&&l.to==p?l.to=f:i.push(l=new re(p,f,o))}}),n.forEach(a=>r.step(a)),i.forEach(a=>r.step(a))}function Bd(r,t,e,o){let n=[],i=0;r.doc.nodesBetween(t,e,(s,l)=>{if(!s.isInline)return;i++;let a=null;if(o instanceof ro){let c=s.marks,h;for(;h=o.isInSet(c);)(a||(a=[])).push(h),c=h.removeFromSet(c)}else o?o.isInSet(s.marks)&&(a=[o]):a=s.marks;if(a&&a.length){let c=Math.min(l+s.nodeSize,e);for(let h=0;h<a.length;h++){let d=a[h],p;for(let f=0;f<n.length;f++){let u=n[f];u.step==i-1&&d.eq(n[f].style)&&(p=u)}p?(p.to=c,p.step=i):n.push({style:d,from:Math.max(l,t),to:c,step:i})}}}),n.forEach(s=>r.step(new Nt(s.from,s.to,s.style)))}function _o(r,t,e,o=e.contentMatch,n=!0){let i=r.doc.nodeAt(t),s=[],l=t+1;for(let a=0;a<i.childCount;a++){let c=i.child(a),h=l+c.nodeSize,d=o.matchType(c.type);if(!d)s.push(new F(l,h,v.empty));else{o=d;for(let p=0;p<c.marks.length;p++)e.allowsMarkType(c.marks[p].type)||r.step(new Nt(l,h,c.marks[p]));if(n&&c.isText&&e.whitespace!="pre"){let p,f=/\r?\n|\r/g,u;for(;p=f.exec(c.text);)u||(u=new v(w.from(e.schema.text(" ",e.allowedMarks(c.marks))),0,0)),s.push(new F(l+p.index,l+p.index+p[0].length,u))}}l=h}if(!o.validEnd){let a=o.fillBefore(w.empty,!0);r.replace(l,l,new v(a,0,0))}for(let a=s.length-1;a>=0;a--)r.step(s[a])}function Id(r,t,e){return(t==0||r.canReplace(t,r.childCount))&&(e==r.childCount||r.canReplace(0,e))}function Fr(r){let t=r.parent.content.cutByIndex(r.startIndex,r.endIndex);for(let e=r.depth;;--e){let o=r.$from.node(e),n=r.$from.index(e),i=r.$to.indexAfter(e);if(e<r.depth&&o.canReplace(n,i,t))return e;if(e==0||o.type.spec.isolating||!Id(o,n,i))break}return null}function zd(r,t,e){let{$from:o,$to:n,depth:i}=t,s=o.before(i+1),l=n.after(i+1),a=s,c=l,h=w.empty,d=0;for(let u=i,m=!1;u>e;u--)m||o.index(u)>0?(m=!0,h=w.from(o.node(u).copy(h)),d++):a--;let p=w.empty,f=0;for(let u=i,m=!1;u>e;u--)m||n.after(u+1)<n.end(u)?(m=!0,p=w.from(n.node(u).copy(p)),f++):c++;r.step(new V(a,c,s,l,new v(h.append(p),d,f),h.size-d,!0))}function $d(r,t,e=null,o=r){let n=Fd(r,t),i=n&&Ld(o,t);return i?n.map(Ss).concat({type:t,attrs:e}).concat(i.map(Ss)):null}function Ss(r){return{type:r,attrs:null}}function Fd(r,t){let{parent:e,startIndex:o,endIndex:n}=r,i=e.contentMatchAt(o).findWrapping(t);if(!i)return null;let s=i.length?i[0]:t;return e.canReplaceWith(o,n,s)?i:null}function Ld(r,t){let{parent:e,startIndex:o,endIndex:n}=r,i=e.child(o),s=t.contentMatch.findWrapping(i.type);if(!s)return null;let l=(s.length?s[s.length-1]:t).contentMatch;for(let a=o;l&&a<n;a++)l=l.matchType(e.child(a).type);return!l||!l.validEnd?null:s}function Vd(r,t,e){let o=w.empty;for(let s=e.length-1;s>=0;s--){if(o.size){let l=e[s].type.contentMatch.matchFragment(o);if(!l||!l.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}o=w.from(e[s].type.create(e[s].attrs,o))}let n=t.start,i=t.end;r.step(new V(n,i,n,i,new v(o,0,0),e.length,!0))}function jd(r,t,e,o,n){if(!o.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let i=r.steps.length;r.doc.nodesBetween(t,e,(s,l)=>{let a=typeof n=="function"?n(s):n;if(s.isTextblock&&!s.hasMarkup(o,a)&&Wd(r.doc,r.mapping.slice(i).map(l),o)){let c=null;if(o.schema.linebreakReplacement){let f=o.whitespace=="pre",u=!!o.contentMatch.matchType(o.schema.linebreakReplacement);f&&!u?c=!1:!f&&u&&(c=!0)}c===!1&&Cs(r,s,l,i),_o(r,r.mapping.slice(i).map(l,1),o,void 0,c===null);let h=r.mapping.slice(i),d=h.map(l,1),p=h.map(l+s.nodeSize,1);return r.step(new V(d,p,d+1,p-1,new v(w.from(o.create(a,null,s.marks)),0,0),1,!0)),c===!0&&Ms(r,s,l,i),!1}})}function Ms(r,t,e,o){t.forEach((n,i)=>{if(n.isText){let s,l=/\r?\n|\r/g;for(;s=l.exec(n.text);){let a=r.mapping.slice(o).map(e+1+i+s.index);r.replaceWith(a,a+1,t.type.schema.linebreakReplacement.create())}}})}function Cs(r,t,e,o){t.forEach((n,i)=>{if(n.type==n.type.schema.linebreakReplacement){let s=r.mapping.slice(o).map(e+1+i);r.replaceWith(s,s+1,t.type.schema.text(`
`))}})}function Wd(r,t,e){let o=r.resolve(t),n=o.index();return o.parent.canReplaceWith(n,n+1,e)}function qd(r,t,e,o,n){let i=r.doc.nodeAt(t);if(!i)throw new RangeError("No node at given position");e||(e=i.type);let s=e.create(o,null,n||i.marks);if(i.isLeaf)return r.replaceWith(t,t+i.nodeSize,s);if(!e.validContent(i.content))throw new RangeError("Invalid content for node type "+e.name);r.step(new V(t,t+i.nodeSize,t+1,t+i.nodeSize-1,new v(w.from(s),0,0),1,!0))}function Ee(r,t,e=1,o){let n=r.resolve(t),i=n.depth-e,s=o&&o[o.length-1]||n.parent;if(i<0||n.parent.type.spec.isolating||!n.parent.canReplace(n.index(),n.parent.childCount)||!s.type.validContent(n.parent.content.cutByIndex(n.index(),n.parent.childCount)))return!1;for(let c=n.depth-1,h=e-2;c>i;c--,h--){let d=n.node(c),p=n.index(c);if(d.type.spec.isolating)return!1;let f=d.content.cutByIndex(p,d.childCount),u=o&&o[h+1];u&&(f=f.replaceChild(0,u.type.create(u.attrs)));let m=o&&o[h]||d;if(!d.canReplace(p+1,d.childCount)||!m.type.validContent(f))return!1}let l=n.indexAfter(i),a=o&&o[0];return n.node(i).canReplaceWith(l,l,a?a.type:n.node(i+1).type)}function Jd(r,t,e=1,o){let n=r.doc.resolve(t),i=w.empty,s=w.empty;for(let l=n.depth,a=n.depth-e,c=e-1;l>a;l--,c--){i=w.from(n.node(l).copy(i));let h=o&&o[c];s=w.from(h?h.type.create(h.attrs,s):n.node(l).copy(s))}r.step(new F(t,t,new v(i.append(s),e,e),!0))}function Go(r,t){let e=r.resolve(t),o=e.index();return Kd(e.nodeBefore,e.nodeAfter)&&e.parent.canReplace(o,o+1)}function Hd(r,t){t.content.size||r.type.compatibleContent(t.type);let e=r.contentMatchAt(r.childCount),{linebreakReplacement:o}=r.type.schema;for(let n=0;n<t.childCount;n++){let i=t.child(n),s=i.type==o?r.type.schema.nodes.text:i.type;if(e=e.matchType(s),!e||!r.type.allowsMarks(i.marks))return!1}return e.validEnd}function Kd(r,t){return!!(r&&t&&!r.isLeaf&&Hd(r,t))}function Ud(r,t,e){let o=null,{linebreakReplacement:n}=r.doc.type.schema,i=r.doc.resolve(t-e),s=i.node().type;if(n&&s.inlineContent){let h=s.whitespace=="pre",d=!!s.contentMatch.matchType(n);h&&!d?o=!1:!h&&d&&(o=!0)}let l=r.steps.length;if(o===!1){let h=r.doc.resolve(t+e);Cs(r,h.node(),h.before(),l)}s.inlineContent&&_o(r,t+e-1,s,i.node().contentMatchAt(i.index()),o==null);let a=r.mapping.slice(l),c=a.map(t-e);if(r.step(new F(c,a.map(t+e,-1),v.empty,!0)),o===!0){let h=r.doc.resolve(c);Ms(r,h.node(),h.before(),r.steps.length)}return r}function _d(r,t,e){let o=r.resolve(t);if(o.parent.canReplaceWith(o.index(),o.index(),e))return t;if(o.parentOffset==0)for(let n=o.depth-1;n>=0;n--){let i=o.index(n);if(o.node(n).canReplaceWith(i,i,e))return o.before(n+1);if(i>0)return null}if(o.parentOffset==o.parent.content.size)for(let n=o.depth-1;n>=0;n--){let i=o.indexAfter(n);if(o.node(n).canReplaceWith(i,i,e))return o.after(n+1);if(i<o.node(n).childCount)return null}return null}function Gd(r,t,e){let o=r.resolve(t);if(!e.content.size)return t;let n=e.content;for(let i=0;i<e.openStart;i++)n=n.firstChild.content;for(let i=1;i<=(e.openStart==0&&e.size?2:1);i++)for(let s=o.depth;s>=0;s--){let l=s==o.depth?0:o.pos<=(o.start(s+1)+o.end(s+1))/2?-1:1,a=o.index(s)+(l>0?1:0),c=o.node(s),h=!1;if(i==1)h=c.canReplace(a,a,n);else{let d=c.contentMatchAt(a).findWrapping(n.firstChild.type);h=d&&c.canReplaceWith(a,a,d[0])}if(h)return l==0?o.pos:l<0?o.before(s+1):o.after(s+1)}return null}function Qe(r,t,e=t,o=v.empty){if(t==e&&!o.size)return null;let n=r.resolve(t),i=r.resolve(e);return Os(n,i,o)?new F(t,e,o):new Xd(n,i,o).fit()}function Os(r,t,e){return!e.openStart&&!e.openEnd&&r.start()==t.start()&&r.parent.canReplace(r.index(),t.index(),e.content)}class Xd{constructor(t,e,o){this.$from=t,this.$to=e,this.unplaced=o,this.frontier=[],this.placed=w.empty;for(let n=0;n<=t.depth;n++){let i=t.node(n);this.frontier.push({type:i.type,match:i.contentMatchAt(t.indexAfter(n))})}for(let n=t.depth;n>0;n--)this.placed=w.from(t.node(n).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let t=this.mustMoveInline(),e=this.placed.size-this.depth-this.$from.depth,o=this.$from,n=this.close(t<0?this.$to:o.doc.resolve(t));if(!n)return null;let i=this.placed,s=o.depth,l=n.depth;for(;s&&l&&i.childCount==1;)i=i.firstChild.content,s--,l--;let a=new v(i,s,l);return t>-1?new V(o.pos,t,this.$to.pos,this.$to.end(),a,e):a.size||o.pos!=this.$to.pos?new F(o.pos,n.pos,a):null}findFittable(){let t=this.unplaced.openStart;for(let e=this.unplaced.content,o=0,n=this.unplaced.openEnd;o<t;o++){let i=e.firstChild;if(e.childCount>1&&(n=0),i.type.spec.isolating&&n<=o){t=o;break}e=i.content}for(let e=1;e<=2;e++)for(let o=e==1?t:this.unplaced.openStart;o>=0;o--){let n,i=null;o?(i=Xo(this.unplaced.content,o-1).firstChild,n=i.content):n=this.unplaced.content;let s=n.firstChild;for(let l=this.depth;l>=0;l--){let{type:a,match:c}=this.frontier[l],h,d=null;if(e==1&&(s?c.matchType(s.type)||(d=c.fillBefore(w.from(s),!1)):i&&a.compatibleContent(i.type)))return{sliceDepth:o,frontierDepth:l,parent:i,inject:d};if(e==2&&s&&(h=c.findWrapping(s.type)))return{sliceDepth:o,frontierDepth:l,parent:i,wrap:h};if(i&&c.matchType(i.type))break}}}openMore(){let{content:t,openStart:e,openEnd:o}=this.unplaced,n=Xo(t,e);return!n.childCount||n.firstChild.isLeaf?!1:(this.unplaced=new v(t,e+1,Math.max(o,n.size+e>=t.size-o?e+1:0)),!0)}dropNode(){let{content:t,openStart:e,openEnd:o}=this.unplaced,n=Xo(t,e);if(n.childCount<=1&&e>0){let i=t.size-e<=e+n.size;this.unplaced=new v(tr(t,e-1,1),e-1,i?e-1:o)}else this.unplaced=new v(tr(t,e,1),e,o)}placeNodes({sliceDepth:t,frontierDepth:e,parent:o,inject:n,wrap:i}){for(;this.depth>e;)this.closeFrontierNode();if(i)for(let m=0;m<i.length;m++)this.openFrontierNode(i[m]);let s=this.unplaced,l=o?o.content:s.content,a=s.openStart-t,c=0,h=[],{match:d,type:p}=this.frontier[e];if(n){for(let m=0;m<n.childCount;m++)h.push(n.child(m));d=d.matchFragment(n)}let f=l.size+t-(s.content.size-s.openEnd);for(;c<l.childCount;){let m=l.child(c),g=d.matchType(m.type);if(!g)break;c++,(c>1||a==0||m.content.size)&&(d=g,h.push(Ns(m.mark(p.allowedMarks(m.marks)),c==1?a:0,c==l.childCount?f:-1)))}let u=c==l.childCount;u||(f=-1),this.placed=er(this.placed,e,w.from(h)),this.frontier[e].match=d,u&&f<0&&o&&o.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let m=0,g=l;m<f;m++){let y=g.lastChild;this.frontier.push({type:y.type,match:y.contentMatchAt(y.childCount)}),g=y.content}this.unplaced=u?t==0?v.empty:new v(tr(s.content,t-1,1),t-1,f<0?s.openEnd:t-1):new v(tr(s.content,t,c),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let t=this.frontier[this.depth],e;if(!t.type.isTextblock||!Yo(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(e=this.findCloseLevel(this.$to))&&e.depth==this.depth)return-1;let{depth:o}=this.$to,n=this.$to.after(o);for(;o>1&&n==this.$to.end(--o);)++n;return n}findCloseLevel(t){t:for(let e=Math.min(this.depth,t.depth);e>=0;e--){let{match:o,type:n}=this.frontier[e],i=e<t.depth&&t.end(e+1)==t.pos+(t.depth-(e+1)),s=Yo(t,e,n,o,i);if(s){for(let l=e-1;l>=0;l--){let{match:a,type:c}=this.frontier[l],h=Yo(t,l,c,a,!0);if(!h||h.childCount)continue t}return{depth:e,fit:s,move:i?t.doc.resolve(t.after(e+1)):t}}}}close(t){let e=this.findCloseLevel(t);if(!e)return null;for(;this.depth>e.depth;)this.closeFrontierNode();e.fit.childCount&&(this.placed=er(this.placed,e.depth,e.fit)),t=e.move;for(let o=e.depth+1;o<=t.depth;o++){let n=t.node(o),i=n.type.contentMatch.fillBefore(n.content,!0,t.index(o));this.openFrontierNode(n.type,n.attrs,i)}return t}openFrontierNode(t,e=null,o){let n=this.frontier[this.depth];n.match=n.match.matchType(t),this.placed=er(this.placed,this.depth,w.from(t.create(e,o))),this.frontier.push({type:t,match:t.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(w.empty,!0);t.childCount&&(this.placed=er(this.placed,this.frontier.length,t))}}function tr(r,t,e){return t==0?r.cutByIndex(e,r.childCount):r.replaceChild(0,r.firstChild.copy(tr(r.firstChild.content,t-1,e)))}function er(r,t,e){return t==0?r.append(e):r.replaceChild(r.childCount-1,r.lastChild.copy(er(r.lastChild.content,t-1,e)))}function Xo(r,t){for(let e=0;e<t;e++)r=r.firstChild.content;return r}function Ns(r,t,e){if(t<=0)return r;let o=r.content;return t>1&&(o=o.replaceChild(0,Ns(o.firstChild,t-1,o.childCount==1?e-1:0))),t>0&&(o=r.type.contentMatch.fillBefore(o).append(o),e<=0&&(o=o.append(r.type.contentMatch.matchFragment(o).fillBefore(w.empty,!0)))),r.copy(o)}function Yo(r,t,e,o,n){let i=r.node(t),s=n?r.indexAfter(t):r.index(t);if(s==i.childCount&&!e.compatibleContent(i.type))return null;let l=o.fillBefore(i.content,!0,s);return l&&!Yd(e,i.content,s)?l:null}function Yd(r,t,e){for(let o=e;o<t.childCount;o++)if(!r.allowsMarks(t.child(o).marks))return!0;return!1}function Zd(r){return r.spec.defining||r.spec.definingForContent}function Qd(r,t,e,o){if(!o.size)return r.deleteRange(t,e);let n=r.doc.resolve(t),i=r.doc.resolve(e);if(Os(n,i,o))return r.step(new F(t,e,o));let s=As(n,r.doc.resolve(e));s[s.length-1]==0&&s.pop();let l=-(n.depth+1);s.unshift(l);for(let p=n.depth,f=n.pos-1;p>0;p--,f--){let u=n.node(p).type.spec;if(u.defining||u.definingAsContext||u.isolating)break;s.indexOf(p)>-1?l=p:n.before(p)==f&&s.splice(1,0,-p)}let a=s.indexOf(l),c=[],h=o.openStart;for(let p=o.content,f=0;;f++){let u=p.firstChild;if(c.push(u),f==o.openStart)break;p=u.content}for(let p=h-1;p>=0;p--){let f=c[p],u=Zd(f.type);if(u&&!f.sameMarkup(n.node(Math.abs(l)-1)))h=p;else if(u||!f.type.isTextblock)break}for(let p=o.openStart;p>=0;p--){let f=(p+h+1)%(o.openStart+1),u=c[f];if(u)for(let m=0;m<s.length;m++){let g=s[(m+a)%s.length],y=!0;g<0&&(y=!1,g=-g);let k=n.node(g-1),x=n.index(g-1);if(k.canReplaceWith(x,x,u.type,u.marks))return r.replace(n.before(g),y?i.after(g):e,new v(Ts(o.content,0,o.openStart,f),f,o.openEnd))}}let d=r.steps.length;for(let p=s.length-1;p>=0&&(r.replace(t,e,o),!(r.steps.length>d));p--){let f=s[p];f<0||(t=n.before(f),e=i.after(f))}}function Ts(r,t,e,o,n){if(t<e){let i=r.firstChild;r=r.replaceChild(0,i.copy(Ts(i.content,t+1,e,o,i)))}if(t>o){let i=n.contentMatchAt(0),s=i.fillBefore(r).append(r);r=s.append(i.matchFragment(s).fillBefore(w.empty,!0))}return r}function tp(r,t,e,o){if(!o.isInline&&t==e&&r.doc.resolve(t).parent.content.size){let n=_d(r.doc,t,o.type);n!=null&&(t=e=n)}r.replaceRange(t,e,new v(w.from(o),0,0))}function ep(r,t,e){let o=r.doc.resolve(t),n=r.doc.resolve(e),i=As(o,n);for(let s=0;s<i.length;s++){let l=i[s],a=s==i.length-1;if(a&&l==0||o.node(l).type.contentMatch.validEnd)return r.delete(o.start(l),n.end(l));if(l>0&&(a||o.node(l-1).canReplace(o.index(l-1),n.indexAfter(l-1))))return r.delete(o.before(l),n.after(l))}for(let s=1;s<=o.depth&&s<=n.depth;s++)if(t-o.start(s)==o.depth-s&&e>o.end(s)&&n.end(s)-e!=n.depth-s&&o.start(s-1)==n.start(s-1)&&o.node(s-1).canReplace(o.index(s-1),n.index(s-1)))return r.delete(o.before(s),e);r.delete(t,e)}function As(r,t){let e=[],o=Math.min(r.depth,t.depth);for(let n=o;n>=0;n--){let i=r.start(n);if(i<r.pos-(r.depth-n)||t.end(n)>t.pos+(t.depth-n)||r.node(n).type.spec.isolating||t.node(n).type.spec.isolating)break;(i==t.start(n)||n==r.depth&&n==t.depth&&r.parent.inlineContent&&t.parent.inlineContent&&n&&t.start(n-1)==i-1)&&e.push(n)}return e}class qe extends G{constructor(t,e,o){super(),this.pos=t,this.attr=e,this.value=o}apply(t){let e=t.nodeAt(this.pos);if(!e)return $.fail("No node at attribute step's position");let o=Object.create(null);for(let i in e.attrs)o[i]=e.attrs[i];o[this.attr]=this.value;let n=e.type.create(o,null,e.marks);return $.fromReplace(t,this.pos,this.pos+1,new v(w.from(n),0,e.isLeaf?0:1))}getMap(){return lt.empty}invert(t){return new qe(this.pos,this.attr,t.nodeAt(this.pos).attrs[this.attr])}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new qe(e.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(t,e){if(typeof e.pos!="number"||typeof e.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new qe(e.pos,e.attr,e.value)}}G.jsonID("attr",qe);class mr extends G{constructor(t,e){super(),this.attr=t,this.value=e}apply(t){let e=Object.create(null);for(let n in t.attrs)e[n]=t.attrs[n];e[this.attr]=this.value;let o=t.type.create(e,t.content,t.marks);return $.ok(o)}getMap(){return lt.empty}invert(t){return new mr(this.attr,t.attrs[this.attr])}map(t){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(t,e){if(typeof e.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new mr(e.attr,e.value)}}G.jsonID("docAttr",mr);let Re=class extends Error{};Re=function r(t){let e=Error.call(this,t);return e.__proto__=r.prototype,e},Re.prototype=Object.create(Error.prototype),Re.prototype.constructor=Re,Re.prototype.name="TransformError";class rp{constructor(t){this.doc=t,this.steps=[],this.docs=[],this.mapping=new oo}get before(){return this.docs.length?this.docs[0]:this.doc}step(t){let e=this.maybeStep(t);if(e.failed)throw new Re(e.failed);return this}maybeStep(t){let e=t.apply(this.doc);return e.failed||this.addStep(t,e.doc),e}get docChanged(){return this.steps.length>0}addStep(t,e){this.docs.push(this.doc),this.steps.push(t),this.mapping.appendMap(t.getMap()),this.doc=e}replace(t,e=t,o=v.empty){let n=Qe(this.doc,t,e,o);return n&&this.step(n),this}replaceWith(t,e,o){return this.replace(t,e,new v(w.from(o),0,0))}delete(t,e){return this.replace(t,e,v.empty)}insert(t,e){return this.replaceWith(t,t,e)}replaceRange(t,e,o){return Qd(this,t,e,o),this}replaceRangeWith(t,e,o){return tp(this,t,e,o),this}deleteRange(t,e){return ep(this,t,e),this}lift(t,e){return zd(this,t,e),this}join(t,e=1){return Ud(this,t,e),this}wrap(t,e){return Vd(this,t,e),this}setBlockType(t,e=t,o,n=null){return jd(this,t,e,o,n),this}setNodeMarkup(t,e,o=null,n){return qd(this,t,e,o,n),this}setNodeAttribute(t,e,o){return this.step(new qe(t,e,o)),this}setDocAttribute(t,e){return this.step(new mr(t,e)),this}addNodeMark(t,e){return this.step(new oe(t,e)),this}removeNodeMark(t,e){let o=this.doc.nodeAt(t);if(!o)throw new RangeError("No node at position "+t);if(e instanceof E)e.isInSet(o.marks)&&this.step(new ve(t,e));else{let n=o.marks,i,s=[];for(;i=e.isInSet(n);)s.push(new ve(t,i)),n=i.removeFromSet(n);for(let l=s.length-1;l>=0;l--)this.step(s[l])}return this}split(t,e=1,o){return Jd(this,t,e,o),this}addMark(t,e,o){return Pd(this,t,e,o),this}removeMark(t,e,o){return Bd(this,t,e,o),this}clearIncompatible(t,e,o){return _o(this,t,e,o),this}}const Zo=Object.create(null);class D{constructor(t,e,o){this.$anchor=t,this.$head=e,this.ranges=o||[new op(t.min(e),t.max(e))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let t=this.ranges;for(let e=0;e<t.length;e++)if(t[e].$from.pos!=t[e].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(t,e=v.empty){let o=e.content.lastChild,n=null;for(let l=0;l<e.openEnd;l++)n=o,o=o.lastChild;let i=t.steps.length,s=this.ranges;for(let l=0;l<s.length;l++){let{$from:a,$to:c}=s[l],h=t.mapping.slice(i);t.replaceRange(h.map(a.pos),h.map(c.pos),l?v.empty:e),l==0&&Rs(t,i,(o?o.isInline:n&&n.isTextblock)?-1:1)}}replaceWith(t,e){let o=t.steps.length,n=this.ranges;for(let i=0;i<n.length;i++){let{$from:s,$to:l}=n[i],a=t.mapping.slice(o),c=a.map(s.pos),h=a.map(l.pos);i?t.deleteRange(c,h):(t.replaceRangeWith(c,h,e),Rs(t,o,e.isInline?-1:1))}}static findFrom(t,e,o=!1){let n=t.parent.inlineContent?new A(t):Pe(t.node(0),t.parent,t.pos,t.index(),e,o);if(n)return n;for(let i=t.depth-1;i>=0;i--){let s=e<0?Pe(t.node(0),t.node(i),t.before(i+1),t.index(i),e,o):Pe(t.node(0),t.node(i),t.after(i+1),t.index(i)+1,e,o);if(s)return s}return null}static near(t,e=1){return this.findFrom(t,e)||this.findFrom(t,-e)||new st(t.node(0))}static atStart(t){return Pe(t,t,0,0,1)||new st(t)}static atEnd(t){return Pe(t,t,t.content.size,t.childCount,-1)||new st(t)}static fromJSON(t,e){if(!e||!e.type)throw new RangeError("Invalid input for Selection.fromJSON");let o=Zo[e.type];if(!o)throw new RangeError(`No selection type ${e.type} defined`);return o.fromJSON(t,e)}static jsonID(t,e){if(t in Zo)throw new RangeError("Duplicate use of selection JSON ID "+t);return Zo[t]=e,e.prototype.jsonID=t,e}getBookmark(){return A.between(this.$anchor,this.$head).getBookmark()}}D.prototype.visible=!0;class op{constructor(t,e){this.$from=t,this.$to=e}}let Ds=!1;function Es(r){!Ds&&!r.parent.inlineContent&&(Ds=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+r.parent.type.name+")"))}class A extends D{constructor(t,e=t){Es(t),Es(e),super(t,e)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(t,e){let o=t.resolve(e.map(this.head));if(!o.parent.inlineContent)return D.near(o);let n=t.resolve(e.map(this.anchor));return new A(n.parent.inlineContent?n:o,o)}replace(t,e=v.empty){if(super.replace(t,e),e==v.empty){let o=this.$from.marksAcross(this.$to);o&&t.ensureMarks(o)}}eq(t){return t instanceof A&&t.anchor==this.anchor&&t.head==this.head}getBookmark(){return new no(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(t,e){if(typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new A(t.resolve(e.anchor),t.resolve(e.head))}static create(t,e,o=e){let n=t.resolve(e);return new this(n,o==e?n:t.resolve(o))}static between(t,e,o){let n=t.pos-e.pos;if((!o||n)&&(o=n>=0?1:-1),!e.parent.inlineContent){let i=D.findFrom(e,o,!0)||D.findFrom(e,-o,!0);if(i)e=i.$head;else return D.near(e,o)}return t.parent.inlineContent||(n==0?t=e:(t=(D.findFrom(t,-o,!0)||D.findFrom(t,o,!0)).$anchor,t.pos<e.pos!=n<0&&(t=e))),new A(t,e)}}D.jsonID("text",A);class no{constructor(t,e){this.anchor=t,this.head=e}map(t){return new no(t.map(this.anchor),t.map(this.head))}resolve(t){return A.between(t.resolve(this.anchor),t.resolve(this.head))}}class O extends D{constructor(t){let e=t.nodeAfter,o=t.node(0).resolve(t.pos+e.nodeSize);super(t,o),this.node=e}map(t,e){let{deleted:o,pos:n}=e.mapResult(this.anchor),i=t.resolve(n);return o?D.near(i):new O(i)}content(){return new v(w.from(this.node),0,0)}eq(t){return t instanceof O&&t.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new Kn(this.anchor)}static fromJSON(t,e){if(typeof e.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new O(t.resolve(e.anchor))}static create(t,e){return new O(t.resolve(e))}static isSelectable(t){return!t.isText&&t.type.spec.selectable!==!1}}O.prototype.visible=!1,D.jsonID("node",O);class Kn{constructor(t){this.anchor=t}map(t){let{deleted:e,pos:o}=t.mapResult(this.anchor);return e?new no(o,o):new Kn(o)}resolve(t){let e=t.resolve(this.anchor),o=e.nodeAfter;return o&&O.isSelectable(o)?new O(e):D.near(e)}}class st extends D{constructor(t){super(t.resolve(0),t.resolve(t.content.size))}replace(t,e=v.empty){if(e==v.empty){t.delete(0,t.doc.content.size);let o=D.atStart(t.doc);o.eq(t.selection)||t.setSelection(o)}else super.replace(t,e)}toJSON(){return{type:"all"}}static fromJSON(t){return new st(t)}map(t){return new st(t)}eq(t){return t instanceof st}getBookmark(){return np}}D.jsonID("all",st);const np={map(){return this},resolve(r){return new st(r)}};function Pe(r,t,e,o,n,i=!1){if(t.inlineContent)return A.create(r,e);for(let s=o-(n>0?0:1);n>0?s<t.childCount:s>=0;s+=n){let l=t.child(s);if(l.isAtom){if(!i&&O.isSelectable(l))return O.create(r,e-(n<0?l.nodeSize:0))}else{let a=Pe(r,l,e+n,n<0?l.childCount:0,n,i);if(a)return a}e+=l.nodeSize*n}return null}function Rs(r,t,e){let o=r.steps.length-1;if(o<t)return;let n=r.steps[o];if(!(n instanceof F||n instanceof V))return;let i=r.mapping.maps[o],s;i.forEach((l,a,c,h)=>{s==null&&(s=h)}),r.setSelection(D.near(r.doc.resolve(s),e))}const Ps=1,Bs=2,Is=4;class ip extends rp{constructor(t){super(t.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=t.selection,this.storedMarks=t.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(t){if(t.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=t,this.curSelectionFor=this.steps.length,this.updated=(this.updated|Ps)&-3,this.storedMarks=null,this}get selectionSet(){return(this.updated&Ps)>0}setStoredMarks(t){return this.storedMarks=t,this.updated|=Bs,this}ensureMarks(t){return E.sameSet(this.storedMarks||this.selection.$from.marks(),t)||this.setStoredMarks(t),this}addStoredMark(t){return this.ensureMarks(t.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(t){return this.ensureMarks(t.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Bs)>0}addStep(t,e){super.addStep(t,e),this.updated=this.updated&-3,this.storedMarks=null}setTime(t){return this.time=t,this}replaceSelection(t){return this.selection.replace(this,t),this}replaceSelectionWith(t,e=!0){let o=this.selection;return e&&(t=t.mark(this.storedMarks||(o.empty?o.$from.marks():o.$from.marksAcross(o.$to)||E.none))),o.replaceWith(this,t),this}deleteSelection(){return this.selection.replace(this),this}insertText(t,e,o){let n=this.doc.type.schema;if(e==null)return t?this.replaceSelectionWith(n.text(t),!0):this.deleteSelection();{if(o==null&&(o=e),o=o??e,!t)return this.deleteRange(e,o);let i=this.storedMarks;if(!i){let s=this.doc.resolve(e);i=o==e?s.marks():s.marksAcross(this.doc.resolve(o))}return this.replaceRangeWith(e,o,n.text(t,i)),this.selection.empty||this.setSelection(D.near(this.selection.$to)),this}}setMeta(t,e){return this.meta[typeof t=="string"?t:t.key]=e,this}getMeta(t){return this.meta[typeof t=="string"?t:t.key]}get isGeneric(){for(let t in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=Is,this}get scrolledIntoView(){return(this.updated&Is)>0}}function zs(r,t){return!t||!r?r:r.bind(t)}class rr{constructor(t,e,o){this.name=t,this.init=zs(e.init,o),this.apply=zs(e.apply,o)}}const sp=[new rr("doc",{init(r){return r.doc||r.schema.topNodeType.createAndFill()},apply(r){return r.doc}}),new rr("selection",{init(r,t){return r.selection||D.atStart(t.doc)},apply(r){return r.selection}}),new rr("storedMarks",{init(r){return r.storedMarks||null},apply(r,t,e,o){return o.selection.$cursor?r.storedMarks:null}}),new rr("scrollToSelection",{init(){return 0},apply(r,t){return r.scrolledIntoView?t+1:t}})];class Qo{constructor(t,e){this.schema=t,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=sp.slice(),e&&e.forEach(o=>{if(this.pluginsByKey[o.key])throw new RangeError("Adding different instances of a keyed plugin ("+o.key+")");this.plugins.push(o),this.pluginsByKey[o.key]=o,o.spec.state&&this.fields.push(new rr(o.key,o.spec.state,o))})}}class We{constructor(t){this.config=t}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(t){return this.applyTransaction(t).state}filterTransaction(t,e=-1){for(let o=0;o<this.config.plugins.length;o++)if(o!=e){let n=this.config.plugins[o];if(n.spec.filterTransaction&&!n.spec.filterTransaction.call(n,t,this))return!1}return!0}applyTransaction(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};let e=[t],o=this.applyInner(t),n=null;for(;;){let i=!1;for(let s=0;s<this.config.plugins.length;s++){let l=this.config.plugins[s];if(l.spec.appendTransaction){let a=n?n[s].n:0,c=n?n[s].state:this,h=a<e.length&&l.spec.appendTransaction.call(l,a?e.slice(a):e,c,o);if(h&&o.filterTransaction(h,s)){if(h.setMeta("appendedTransaction",t),!n){n=[];for(let d=0;d<this.config.plugins.length;d++)n.push(d<s?{state:o,n:e.length}:{state:this,n:0})}e.push(h),o=o.applyInner(h),i=!0}n&&(n[s]={state:o,n:e.length})}}if(!i)return{state:o,transactions:e}}}applyInner(t){if(!t.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let e=new We(this.config),o=this.config.fields;for(let n=0;n<o.length;n++){let i=o[n];e[i.name]=i.apply(t,this[i.name],this,e)}return e}get tr(){return new ip(this)}static create(t){let e=new Qo(t.doc?t.doc.type.schema:t.schema,t.plugins),o=new We(e);for(let n=0;n<e.fields.length;n++)o[e.fields[n].name]=e.fields[n].init(t,o);return o}reconfigure(t){let e=new Qo(this.schema,t.plugins),o=e.fields,n=new We(e);for(let i=0;i<o.length;i++){let s=o[i].name;n[s]=this.hasOwnProperty(s)?this[s]:o[i].init(t,n)}return n}toJSON(t){let e={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(e.storedMarks=this.storedMarks.map(o=>o.toJSON())),t&&typeof t=="object")for(let o in t){if(o=="doc"||o=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let n=t[o],i=n.spec.state;i&&i.toJSON&&(e[o]=i.toJSON.call(n,this[n.key]))}return e}static fromJSON(t,e,o){if(!e)throw new RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw new RangeError("Required config field 'schema' missing");let n=new Qo(t.schema,t.plugins),i=new We(n);return n.fields.forEach(s=>{if(s.name=="doc")i.doc=ce.fromJSON(t.schema,e.doc);else if(s.name=="selection")i.selection=D.fromJSON(i.doc,e.selection);else if(s.name=="storedMarks")e.storedMarks&&(i.storedMarks=e.storedMarks.map(t.schema.markFromJSON));else{if(o)for(let l in o){let a=o[l],c=a.spec.state;if(a.key==s.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(e,l)){i[s.name]=c.fromJSON.call(a,t,e[l],i);return}}i[s.name]=s.init(t,i)}}),i}}function $s(r,t,e){for(let o in r){let n=r[o];n instanceof Function?n=n.bind(t):o=="handleDOMEvents"&&(n=$s(n,t,{})),e[o]=n}return e}class Ht{constructor(t){this.spec=t,this.props={},t.props&&$s(t.props,this,this.props),this.key=t.key?t.key.key:Fs("plugin")}getState(t){return t[this.key]}}const tn=Object.create(null);function Fs(r){return r in tn?r+"$"+ ++tn[r]:(tn[r]=0,r+"$")}class Ls{constructor(t="key"){this.key=Fs(t)}get(t){return t.config.pluginsByKey[this.key]}getState(t){return t[this.key]}}function lp(r,t,e,o,n,i){let s=[];function l(){s.length>0&&(dp(r,t,s,o,i),s=[])}for(const a of e){const c=a.toJSON().stepType;if(c==="addMark"){s.push(a);continue}else l();ap(r,t,c,a,o,n,i);const h=a.apply(n).doc;if(h==null)throw new Error("Could not apply step to document");n=h,t=Je(o,i)}l()}function ap(r,t,e,o,n,i,s){e==="replace"?cp(r,t,o,n,s,i):e==="replaceAround"?hp(r,o,n,i,s):e==="removeMark"&&pp(r,t,o,n,s)}function cp(r,t,e,o,n,i){var a;if(e.slice.content.childCount===1&&((a=e.slice.content.firstChild)!=null&&a.isText)){const c=qo(r,t,{from:e.from,to:e.to});if(c==null)throw new Error(`Could not find range (${e.from}, ${e.to}) in render tree`);let{start:h,end:d}=c;h>d&&([h,d]=[d,h]);const p=d-h;nc(o,n,h,p,e.slice.content.firstChild.text);const f=e.slice.content.firstChild.marks,u=e.slice.content.firstChild.text.length;up(r,o,n,h,u,f);return}const s=e.apply(i).doc;if(s==null)throw new Error("Could not apply step to document");const l=gs(r,s);Xn(o,n,l)}function hp(r,t,e,o,n){const i=t.apply(o).doc;if(i==null)throw new Error("Could not apply step to document");const s=gs(r,i);Xn(e,n,s)}function dp(r,t,e,o,n){const i=e.map(s=>{const l=qo(r,t,{from:s.from,to:s.to});if(l==null)throw new Error(`Could not find range (${s.from}, ${s.to}) in render tree`);const a=s.mark.type.name,c=s.mark.type.spec.inclusive?"both":"none",h=fp(s.mark.type,s.mark.attrs);return{range:l,markName:a,expand:c,value:h}}).reduce((s,l)=>{const a=s[s.length-1];return a==null?[l]:a.markName===l.markName&&a.expand===l.expand&&a.value===l.value&&(a.range.end===l.range.start||t.slice(a.range.end,l.range.start).every(c=>c.type==="block"))?(a.range.end=l.range.end,s):(s.push(l),s)},[]);for(const s of i)Gn(o,n,{start:s.range.start,end:s.range.end,expand:s.expand},s.markName,s.value)}function pp(r,t,e,o,n){const i=qo(r,t,{from:e.from,to:e.to});if(i==null)throw new Error(`Could not find range (${e.from}, ${e.to}) in render tree`);const{start:s,end:l}=i;if(s==null||l==null)throw new Error(`Could not find step.from (${e.from}) or step.to (${e.to}) in render tree`);const a=e.mark.type.name,c=e.mark.type.spec.inclusive?"both":"none";Yn(o,n,{start:s,end:l,expand:c},a)}function up(r,t,e,o,n,i){const s=ic(t,e,o),l=ps(r,i),a=new Set(Object.keys(l)),c=new Set(Object.keys(s));for(const h of a)(!c.has(h)||l[h]!==s[h])&&Gn(t,e,{start:o,end:o+n,expand:"both"},h,l[h]);for(const h of c)r.markMappings.find(d=>d.automergeMarkName===h)!=null&&(a.has(h)||Yn(t,e,{start:o,end:o+n,expand:"both"},h))}function fp(r,t){return r.name==="link"?JSON.stringify(t):(r.name==="strong"||r.name==="em"||r.name,!0)}function Lr(r,t){if(r.length!==t.length)return!1;for(let e=0;e<r.length;e++)if(r[e]!==t[e])return!1;return!0}function Vs(r,t){if(r.length>t.length)return!1;for(let e=0;e<r.length;e++)if(r[e]!==t[e])return!1;return!0}function Vr(r,t,e){if(Lr(r,e.path)){if(e.action==="mark")for(const o of e.marks)gp(t,o)}else if(Vs(r,e.path))if(e.path.length===r.length+1)e.action==="insert"?bp(t,e):e.action==="del"?yp(t,e):e.action==="splice"&&mp(t,e);else{const o=e.path[r.length];if(typeof o!="number")throw console.error(`Invalid path: ${e.path}`),new Error("Invalid path: expected number when patching spans");const n=Ws(t,o);if(n==null)throw new Error("Invalid path: unable to find block at index");wp(r,e,n)}}function mp(r,t){let e=0;const o=t.path[t.path.length-1];if(typeof o!="number")return;let n=0;for(;n<r.length;){const i=r[n];if(i.type==="text")if(e<=o&&e+i.value.length>o){const s=o-e,l=i.value.slice(0,s),a=i.value.slice(s);if(he(i.marks,t.marks))i.value=l+t.value+a;else{const c=[],h=r[n-1];l.length===0&&h&&h.type==="text"&&he(h.marks,t.marks)?h.value+=t.value:(l.length>0&&c.push(Et({value:l,marks:i.marks})),c.push(Et({value:t.value,marks:t.marks}))),a.length>0&&c.push(Et({value:a,marks:i.marks})),r.splice(n,1,...c)}return}else e+=i.value.length,n+=1;else{if(e===o){const s=r[n-1];if(s!=null&&s.type==="text"&&he(s.marks,t.marks))s.value+=t.value;else{const l={type:"text",value:t.value};t.marks!=null&&(l.marks=t.marks),r.splice(n,0,l)}return}e+=1,n+=1}}if(e===o){const i=r[r.length-1];if(i&&i.type==="text"&&he(i.marks||{},t.marks||{}))i.value+=t.value;else{const s={type:"text",value:t.value};t.marks!=null&&(s.marks=t.marks),r.push(s)}}}function gp(r,t){let e=0,o=0;for(;o<r.length;){const n=r[o];if(n.type==="text"){const i=e,s=e+n.value.length;if(i<t.end&&s>t.start){const l=Math.max(0,t.start-i),a=Math.min(n.value.length,t.end-i);l>0?(r.splice(o,1,Et({value:n.value.slice(0,l),marks:n.marks}),Et({value:n.value.slice(l,a),marks:{...n.marks,[t.name]:t.value}})),o++):r[o]=Et({value:n.value.slice(0,a),marks:{...n.marks,[t.name]:t.value}}),a<n.value.length&&r.splice(o+1,0,Et({value:n.value.slice(a),marks:n.marks}));const c=r[o-1];let h=r[o];o>0&&c.type==="text"&&h.type==="text"&&he(c.marks,h.marks)?(c.value+=h.value,r.splice(o,1)):o++;const d=r[o+1];h=r[o],o<r.length-1&&d.type==="text"&&h.type==="text"&&he(d.marks,h.marks)&&(h.value+=d.value,r.splice(o+1,1))}else o++;e+=n.value.length}else o++,e+=1}}function yp(r,t){const e=t.path[t.path.length-1];if(typeof e!="number")throw new Error("Invalid path: expected number when deleting spans");const o=e+(t.length||1);let n=0,i=0,s=0;function l(a){const c=r[a-1],h=r[a];if(c&&c.type==="text"&&h&&h.type==="text"&&he(c.marks,h.marks)){const d=c.value.length;return c.value+=h.value,r.splice(a,1),d}}for(;s<r.length&&n<o-e;){const a=r[s],c=o-n;if(a.type==="text"){const h=i,d=i+a.value.length;if(h>=e&&d<=c)r.splice(s,1),n+=a.value.length,l(s);else if(h<c&&d>e){const p=Math.max(0,e-h),f=Math.min(a.value.length,c-h);p>0&&f<a.value.length?(r.splice(s,1,Et({value:a.value.slice(0,p),marks:a.marks}),Et({value:a.value.slice(f),marks:a.marks})),s++,i+=p,n+=f-p):p>0?(n+=a.value.length-p,a.value=a.value.slice(0,p)):f<a.value.length&&(n+=f,a.value=a.value.slice(f));const u=l(s);u?i-=u:(s++,i+=a.value.length)}else i+=a.value.length,s++}else if(a.type==="block")if(i>=e&&i<c){r.splice(s,1),n+=1;const h=l(s);h&&(s--,i-=h)}else i++,s++}}function wp(r,t,e){const o=t.path.slice(r.length+1);if(t.action==="put"){const n=jr(e,o.slice(0,-1)),i=t.path[t.path.length-1];n[i]=js(t.value)}else if(t.action==="insert"){const n=jr(e,o.slice(0,-2)),i=o.pop(),s=o.pop(),l=n[s];if(!Array.isArray(l))throw new Error("Invalid path: expected array when inserting");l.splice(i,0,...vp(t.values))}else if(t.action==="splice"){const n=jr(e,o.slice(0,-2)),i=o.pop(),s=o.pop(),l=n[s],a=l.slice(0,i)+t.value+l.slice(i);n[s]=a}else if(t.action==="del"){const n=jr(e,o.slice(0,-1)),i=t.path[t.path.length-1];delete n[i]}}function vp(r){return r.map(t=>js(t))}function js(r){return r instanceof Dt?new Dt(r.toString()):structuredClone(r)}function jr(r,t){let e=r;for(const o of t){if(typeof e!="object")throw new Error("Invalid path: expected object when resolving target");e=e[o]}return e}function bp(r,t){let e=0,o=0;const n=t.path[t.path.length-1];if(typeof n!="number")throw new Error(`Invalid patch path, expected a number got ", ${t.path[t.path.length-1]}`);const i=[];for(const s of t.values){if(!s||typeof s!="object")throw new Error("Invalid patch: expected object when inserting");if(Object.keys(s).length!==0)throw new Error("Invalid patch: unexpected nonempty object when inserting");i.push({type:"block",value:{}})}for(;e<n&&o<r.length;){const s=r[o];if(s.type=="text"){if(s.value.length+e>n){const l=n-e,a=s.value.slice(0,l),c=s.value.slice(l);s.value=a,r.splice(o+1,0,...i),r.splice(o+i.length+1,0,{type:"text",value:c});return}e+=s.value.length}else e+=1;o+=1}r.splice(o,0,...i)}function Ws(r,t){let e=0;for(const o of r)if(o.type==="block"){if(e===t)return o.value;e+=1}else e+=o.value.length;return null}function he(r,t){if(r===t)return!0;if(!r||!t||Object.keys(r).length!==Object.keys(t).length)return!1;for(const e in r)if(r[e]!==t[e])return!1;return!0}function Et({value:r,marks:t}){const e={type:"text",value:r};return t!=null&&(e.marks=t),e}function qs(r,t,e,o,n){const i=Op(o,e);let s=n;for(const l of i)if(l.type==="text")for(const a of l.patches)if(a.action==="splice")s=kp(r,t,a,o,s),Vr(o,t,a);else if(a.action==="del"){const c=a.path[a.path.length-1];Ws(t,c)!=null?s=Js(r,o,t,c,[a],s):s=xp(r,t,a,o,s),Vr(o,t,a)}else a.action==="mark"&&(s=Sp(r,t,a,o,s),Vr(o,t,a));else s=Js(r,o,t,l.index,l.patches,s);return s}function kp(r,t,e,o,n){const i=Ks(o,e.path);if(i===null)return n;const s=Ir(r,t,i);if(s==null)throw new Error("Invalid index");const l=Cp(r,e.value,e.marks);return n=n.step(new F(s,s,new v(l,0,0))),n}function xp(r,t,e,o,n){const i=Ks(o,e.path);if(i===null)return n;const s=Ir(r,t,i);if(s==null)throw new Error("Invalid index");const l=s+(e.length||1);return n.delete(s,l)}function Sp(r,t,e,o,n){if(Lr(e.path,o))for(const i of e.marks){const s=Ir(r,t,i.start),l=Ir(r,t,i.end);if(s==null||l==null)throw new Error("Invalid index");if(i.value==null){const a=r.markMappings.find(h=>h.automergeMarkName===i.name),c=a?a.prosemirrorMark:r.unknownMark;n=n.removeMark(s,l,c)}else{const a=Fo(r,{[i.name]:i.value});for(const c of a)n=n.addMark(s,l,c)}}return n}function Js(r,t,e,o,n,i){for(const m of n)Vr(t,e,m);const s=Lo(r,e),l=Mp(i.doc.content,s.content);if(l==null)return i;const a=s.resolve(l.start),c=s.resolve(l.endB),h=i.doc.resolve(l.start),d=a.sameParent(c)&&a.parent.inlineContent&&h.end()>=l.endA,p=l.start,f=l.endA;let u=!1;if(d){if(a.pos==c.pos)u=!0,i=i.delete(p,f);else if(a.parent.child(a.index()).isText&&a.index()==c.index()-(c.textOffset?0:1)){u=!0;const m=a.parent.textBetween(a.parentOffset,c.parentOffset);i=i.insertText(m,p,f)}}return u||(i=i.replace(p,f,s.slice(l.start,l.endB))),i}function Mp(r,t){let e=r.findDiffStart(t);if(e==null)return null;let{a:o,b:n}=r.findDiffEnd(t);return o<e&&r.size<t.size?(e&&e<t.size&&Hs(t.textBetween(e-1,e+1))&&(e-=1),n=e+(n-o),o=e):n<e&&(e&&e<r.size&&Hs(r.textBetween(e-1,e+1))&&(e-=1),o=e+(o-n),n=e),{start:e,endA:o,endB:n}}function Hs(r){if(r.length!=2)return!1;const t=r.charCodeAt(0),e=r.charCodeAt(1);return t>=56320&&t<=57343&&e>=55296&&e<=56319}function Ks(r,t){if(t.length!==r.length+1)return null;for(let o=0;o<r.length;o++)if(r[o]!==t[o])return null;const e=t[t.length-1];return typeof e=="number"?e:null}function Cp(r,t,e){let o;return e!=null&&(o=Fo(r,e)),w.from(r.schema.text(t,o))}function Op(r,t){const e=[];let o={type:"gatheringText",gathered:[]};function n(){o.type==="gatheringBlock"?e.push({type:"block",index:o.index,patches:o.gathered}):o.type==="gatheringText"&&e.push({type:"text",patches:o.gathered}),o={type:"transitioning"}}for(const i of t)if(Vs(r,i.path))if(Lr(r,i.path)&&i.action==="mark")o.type==="gatheringText"?o.gathered.push(i):(n(),o={type:"gatheringText",gathered:[i]});else if(i.path.length===r.length+1){const s=i.path[i.path.length-1];typeof s=="number"&&(i.action==="splice"||i.action==="del"?o.type==="gatheringText"?o.gathered.push(i):(n(),o={type:"gatheringText",gathered:[i]}):i.action==="insert"&&(n(),o={type:"gatheringBlock",index:s,gathered:[i]}))}else{const s=i.path[r.length];if(typeof s!="number")continue;o.type==="gatheringBlock"&&o.index===s?o.gathered.push(i):(n(),o={type:"gatheringBlock",index:s,gathered:[i]})}return n(),e}function Np({adapter:r,path:t,before:e,after:o,patches:n,state:i}){const s=lo(e),l=Je(sc(o,s),t),a=qs(r,l,n,t,i.tr);return a.setMeta("addToHistory",!1),a}const Us={encodeCharacter:r=>r,encodeNodeStart:r=>r.type.name,encodeNodeEnd:()=>-1,compareTokens:(r,t)=>r===t};function en(r,t,e,o,n){for(let i=0,s=0;i<r.childCount;i++){let l=r.child(i),a=s+l.nodeSize,c=Math.max(s,e),h=Math.min(a,o);if(c<h)if(l.isText)for(let d=c;d<h;d++)n.push(t.encodeCharacter(l.text.charCodeAt(d-s),l.marks));else l.isLeaf?n.push(t.encodeNodeStart(l)):(c==s&&n.push(t.encodeNodeStart(l)),en(l.content,t,Math.max(s+1,c)-s-1,Math.min(a-1,h)-s-1,n),h==a&&n.push(t.encodeNodeEnd(l)));s=a}return n}const Tp=5e3;function Ap(r,t){return Math.min(15,Math.max(2,Math.floor(Math.max(r,t)/10)))}function _s(r,t,e,o=Us){let n=en(r,o,e.fromA,e.toA,[]),i=en(t,o,e.fromB,e.toB,[]),s=0,l=n.length,a=i.length,c=o.compareTokens;for(;s<n.length&&s<i.length&&c(n[s],i[s]);)s++;if(s==n.length&&s==i.length)return[];for(;l>s&&a>s&&c(n[l-1],i[a-1]);)l--,a--;if(l==s||a==s||l==a&&l==s+1)return[e.slice(s,l,s,a)];let h=l-s,d=a-s,p=Math.min(Tp,h+d),f=p+1,u=[],m=[];for(let g=f*2,y=0;y<g;y++)m[y]=-1;for(let g=0;g<=p;g++){for(let y=-g;y<=g;y+=2){let k=m[y+1+p],x=m[y-1+p],b=k<x?x:k+1,C=b+y;for(;b<h&&C<d&&c(n[s+b],i[s+C]);)b++,C++;if(m[y+p]=b,b>=h&&C>=d){let T=[],j=Ap(l-s,a-s),B=-1,M=-1,R=-1,W=-1,Z=(Q,_,q,Tt)=>{B>-1&&B<_+j?(B=Q,R=q):(B>-1&&T.push(e.slice(B,M,R,W)),B=Q,M=_,R=q,W=Tt)};for(let Q=g-1;Q>=0;Q--){let _=m[y+1+p],q=m[y-1+p];_<q?(y--,b=q+s,C=b+y,Z(b,b,C,C+1)):(y++,b=_+s,C=b+y,Z(b,b+1,C,C)),m=u[Q>>1]}return B>-1&&T.push(e.slice(B,M,R,W)),T.reverse()}}g%2==0&&u.push(m.slice())}return[e.slice(s,l,s,a)]}class z{constructor(t,e){this.length=t,this.data=e}cut(t){return t==this.length?this:new z(t,this.data)}static slice(t,e,o){if(e==o)return z.none;if(e==0&&o==z.len(t))return t;let n=[];for(let i=0,s=0;s<o;i++){let l=t[i],a=s+l.length,c=Math.min(o,a)-Math.max(e,s);c>0&&n.push(l.cut(c)),s=a}return n}static join(t,e,o){if(t.length==0)return e;if(e.length==0)return t;let n=o(t[t.length-1].data,e[0].data);if(n==null)return t.concat(e);let i=t.slice(0,t.length-1);i.push(new z(t[t.length-1].length+e[0].length,n));for(let s=1;s<e.length;s++)i.push(e[s]);return i}static len(t){let e=0;for(let o=0;o<t.length;o++)e+=t[o].length;return e}}z.none=[];class Ft{constructor(t,e,o,n,i,s){this.fromA=t,this.toA=e,this.fromB=o,this.toB=n,this.deleted=i,this.inserted=s}get lenA(){return this.toA-this.fromA}get lenB(){return this.toB-this.fromB}slice(t,e,o,n){return t==0&&o==0&&e==this.toA-this.fromA&&n==this.toB-this.fromB?this:new Ft(this.fromA+t,this.fromA+e,this.fromB+o,this.fromB+n,z.slice(this.deleted,t,e),z.slice(this.inserted,o,n))}static merge(t,e,o){if(t.length==0)return e;if(e.length==0)return t;let n=[];for(let i=0,s=0,l=t[0],a=e[0];;){if(!l&&!a)return n;if(l&&(!a||l.toB<a.fromA)){let c=s?e[s-1].toB-e[s-1].toA:0;n.push(c==0?l:new Ft(l.fromA,l.toA,l.fromB+c,l.toB+c,l.deleted,l.inserted)),l=i++==t.length?null:t[i]}else if(a&&(!l||a.toA<l.fromB)){let c=i?t[i-1].toB-t[i-1].toA:0;n.push(c==0?a:new Ft(a.fromA-c,a.toA-c,a.fromB,a.toB,a.deleted,a.inserted)),a=s++==e.length?null:e[s]}else{let c=Math.min(l.fromB,a.fromA),h=Math.min(l.fromA,a.fromA-(i?t[i-1].toB-t[i-1].toA:0)),d=h,p=Math.min(a.fromB,l.fromB+(s?e[s-1].toB-e[s-1].toA:0)),f=p,u=z.none,m=z.none,g=!1,y=!1;for(;;){let k=l?c>=l.fromB?l.toB:l.fromB:2e8,x=a?c>=a.fromA?a.toA:a.fromA:2e8,b=Math.min(k,x),C=l&&c>=l.fromB,T=a&&c>=a.fromA;if(!C&&!T)break;C&&c==l.fromB&&!g&&(u=z.join(u,l.deleted,o),d+=l.lenA,g=!0),C&&!T&&(m=z.join(m,z.slice(l.inserted,c-l.fromB,b-l.fromB),o),f+=b-c),T&&c==a.fromA&&!y&&(m=z.join(m,a.inserted,o),f+=a.lenB,y=!0),T&&!C&&(u=z.join(u,z.slice(a.deleted,c-a.fromA,b-a.fromA),o),d+=b-c),C&&b==l.toB&&(l=i++==t.length?null:t[i],g=!1),T&&b==a.toA&&(a=s++==e.length?null:e[s],y=!1),c=b}(h<d||p<f)&&n.push(new Ft(h,d,p,f,u,m))}}}}let Dp;try{Dp=new RegExp("[\\p{Alphabetic}_]","u")}catch{}class ke{constructor(t,e){this.config=t,this.changes=e}addSteps(t,e,o){let n=[];for(let a=0;a<e.length;a++){let c=Array.isArray(o)?o[a]:o,h=0;e[a].forEach((d,p,f,u)=>{n.push(new Ft(d+h,p+h,f,u,d==p?z.none:[new z(p-d,c)],f==u?z.none:[new z(u-f,c)])),h=u-f-(p-d)})}if(n.length==0)return this;let i=rn(n,this.config.combine),s=Ft.merge(this.changes,i,this.config.combine),l=s;for(let a=0;a<l.length;a++){let c=l[a];if(c.fromA==c.toA||c.fromB==c.toB||!i.some(d=>d.toB>c.fromB&&d.fromB<c.toB))continue;let h=_s(this.config.doc.content,t.content,c,this.config.encoder);h.length==1&&h[0].fromB==0&&h[0].toB==c.toB-c.fromB||(l==s&&(l=s.slice()),h.length==1?l[a]=h[0]:(l.splice(a,1,...h),a+=h.length-1))}return new ke(this.config,l)}get startDoc(){return this.config.doc}map(t){let e=o=>{let n=t(o);return n===o.data?o:new z(o.length,n)};return new ke(this.config,this.changes.map(o=>new Ft(o.fromA,o.toA,o.fromB,o.toB,o.deleted.map(e),o.inserted.map(e))))}changedRange(t,e){if(t==this)return null;let o=e&&Ep(e),n=o?o.toB-o.fromB-(o.toA-o.fromA):0;function i(d){return!o||d<=o.fromA?d:d+n}let s=o?o.fromB:2e8,l=o?o.toB:-2e8;function a(d,p=d){s=Math.min(d,s),l=Math.max(p,l)}let c=this.changes,h=t.changes;for(let d=0,p=0;d<c.length&&p<h.length;){let f=c[d],u=h[p];f&&u&&Rp(f,u,i)?(d++,p++):u&&(!f||i(f.fromB)>=u.fromB)?(a(u.fromB,u.toB),p++):(a(i(f.fromB),i(f.toB)),d++)}return s<=l?{from:s,to:l}:null}static create(t,e=(n,i)=>n===i?n:null,o=Us){return new ke({combine:e,doc:t,encoder:o},[])}}ke.computeDiff=_s;function rn(r,t,e=0,o=r.length){if(o==e+1)return[r[e]];let n=e+o>>1;return Ft.merge(rn(r,t,e,n),rn(r,t,n,o),t)}function Gs(r){let t=2e8,e=-2e8;for(let o=0;o<r.length;o++){let n=r[o];t!=2e8&&(t=n.map(t,-1),e=n.map(e,1)),n.forEach((i,s,l,a)=>{t=Math.min(t,l),e=Math.max(e,a)})}return t==2e8?null:{from:t,to:e}}function Ep(r){let t=Gs(r);if(!t)return null;let e=Gs(r.map(o=>o.invert()).reverse());return{fromA:e.from,toA:e.to,fromB:t.from,toB:t.to}}function Rp(r,t,e){return e(r.fromB)==t.fromB&&e(r.toB)==t.toB&&Xs(r.deleted,t.deleted)&&Xs(r.inserted,t.inserted)}function Xs(r,t){if(r.length!=t.length)return!1;for(let e=0;e<r.length;e++)if(r[e].length!=t[e].length||r[e].data!==t[e].data)return!1;return!0}const Pp=new Ls("automerge-sync"),Bp=({adapter:r,handle:t,path:e})=>{let o=!1;return new Ht({key:Pp,view:n=>{const i=({doc:s,patches:l,patchInfo:a})=>{if(o)return;const c=Np({adapter:r,path:e,before:a.before,after:s,patches:l,state:n.state});o=!0,n.dispatch(c),o=!1};return t.on("change",i),{destroy(){t.off("change",i)}}},appendTransaction(n,i,s){if(o||(n=n.filter(b=>b.docChanged),n.length===0))return;o=!0,t.change(b=>{for(const C of n){const T=Je(b,e);lp(r,T,C.steps,b,C.docs[0],e)}}),o=!1;const l=t.docSync(),a=lo(l),c=Je(l,e),h=t.docSync(),d=lo(h),p=Je(h,e);if(Lr(a,d))return;const f=lc(h,a,d),u=qs(r,c,f,e,i.tr);let m=ke.create(i.doc);m=m.addSteps(i.doc,u.mapping.maps,void 0);let g=ke.create(i.doc);for(const b of n)g=g.addSteps(b.docs[0],b.mapping.maps,void 0);const y=g.changedRange(m);if(!y||y.from===y.to)return;console.warn(`Warning: ProseMirror doc doesn't match AutoMerge spans.

State will be automatically fixed with a tr. File an issue at https://github.com/automerge/automerge-repo.
`,{spansBefore:c,steps:n.map(b=>b.steps.map(C=>C.toJSON()))});const k=Lo(r,p).slice(y.from,y.to),x=s.tr;x.replace(y.from,y.to,k);try{x.setSelection(D.fromJSON(x.doc,s.selection.toJSON()))}catch(b){if(!(b instanceof RangeError))throw b}return x.setStoredMarks(s.storedMarks),x}})},K=function(r){for(var t=0;;t++)if(r=r.previousSibling,!r)return t},Be=function(r){let t=r.assignedSlot||r.parentNode;return t&&t.nodeType==11?t.host:t};let on=null;const Rt=function(r,t,e){let o=on||(on=document.createRange());return o.setEnd(r,e??r.nodeValue.length),o.setStart(r,t||0),o},Ip=function(){on=null},de=function(r,t,e,o){return e&&(Ys(r,t,e,o,-1)||Ys(r,t,e,o,1))},zp=/^(img|br|input|textarea|hr)$/i;function Ys(r,t,e,o,n){for(;;){if(r==e&&t==o)return!0;if(t==(n<0?0:at(r))){let i=r.parentNode;if(!i||i.nodeType!=1||or(r)||zp.test(r.nodeName)||r.contentEditable=="false")return!1;t=K(r)+(n<0?0:1),r=i}else if(r.nodeType==1){if(r=r.childNodes[t+(n<0?-1:0)],r.contentEditable=="false")return!1;t=n<0?at(r):0}else return!1}}function at(r){return r.nodeType==3?r.nodeValue.length:r.childNodes.length}function $p(r,t){for(;;){if(r.nodeType==3&&t)return r;if(r.nodeType==1&&t>0){if(r.contentEditable=="false")return null;r=r.childNodes[t-1],t=at(r)}else if(r.parentNode&&!or(r))t=K(r),r=r.parentNode;else return null}}function Fp(r,t){for(;;){if(r.nodeType==3&&t<r.nodeValue.length)return r;if(r.nodeType==1&&t<r.childNodes.length){if(r.contentEditable=="false")return null;r=r.childNodes[t],t=0}else if(r.parentNode&&!or(r))t=K(r)+1,r=r.parentNode;else return null}}function Lp(r,t,e){for(let o=t==0,n=t==at(r);o||n;){if(r==e)return!0;let i=K(r);if(r=r.parentNode,!r)return!1;o=o&&i==0,n=n&&i==at(r)}}function or(r){let t;for(let e=r;e&&!(t=e.pmViewDesc);e=e.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==r||t.contentDOM==r)}const Wr=function(r){return r.focusNode&&de(r.focusNode,r.focusOffset,r.anchorNode,r.anchorOffset)};function pe(r,t){let e=document.createEvent("Event");return e.initEvent("keydown",!0,!0),e.keyCode=r,e.key=e.code=t,e}function Vp(r){let t=r.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}function jp(r,t,e){if(r.caretPositionFromPoint)try{let o=r.caretPositionFromPoint(t,e);if(o)return{node:o.offsetNode,offset:Math.min(at(o.offsetNode),o.offset)}}catch{}if(r.caretRangeFromPoint){let o=r.caretRangeFromPoint(t,e);if(o)return{node:o.startContainer,offset:Math.min(at(o.startContainer),o.startOffset)}}}const Ct=typeof navigator<"u"?navigator:null,Zs=typeof document<"u"?document:null,Kt=Ct&&Ct.userAgent||"",nn=/Edge\/(\d+)/.exec(Kt),Qs=/MSIE \d/.exec(Kt),sn=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Kt),ot=!!(Qs||sn||nn),Ut=Qs?document.documentMode:sn?+sn[1]:nn?+nn[1]:0,yt=!ot&&/gecko\/(\d+)/i.test(Kt);yt&&+(/Firefox\/(\d+)/.exec(Kt)||[0,0])[1];const ln=!ot&&/Chrome\/(\d+)/.exec(Kt),X=!!ln,tl=ln?+ln[1]:0,tt=!ot&&!!Ct&&/Apple Computer/.test(Ct.vendor),Ie=tt&&(/Mobile\/\w+/.test(Kt)||!!Ct&&Ct.maxTouchPoints>2),ct=Ie||(Ct?/Mac/.test(Ct.platform):!1),Wp=Ct?/Win/.test(Ct.platform):!1,Pt=/Android \d/.test(Kt),nr=!!Zs&&"webkitFontSmoothing"in Zs.documentElement.style,qp=nr?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function Jp(r){let t=r.defaultView&&r.defaultView.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:r.documentElement.clientWidth,top:0,bottom:r.documentElement.clientHeight}}function Bt(r,t){return typeof r=="number"?r:r[t]}function Hp(r){let t=r.getBoundingClientRect(),e=t.width/r.offsetWidth||1,o=t.height/r.offsetHeight||1;return{left:t.left,right:t.left+r.clientWidth*e,top:t.top,bottom:t.top+r.clientHeight*o}}function el(r,t,e){let o=r.someProp("scrollThreshold")||0,n=r.someProp("scrollMargin")||5,i=r.dom.ownerDocument;for(let s=e||r.dom;s;){if(s.nodeType!=1){s=Be(s);continue}let l=s,a=l==i.body,c=a?Jp(i):Hp(l),h=0,d=0;if(t.top<c.top+Bt(o,"top")?d=-(c.top-t.top+Bt(n,"top")):t.bottom>c.bottom-Bt(o,"bottom")&&(d=t.bottom-t.top>c.bottom-c.top?t.top+Bt(n,"top")-c.top:t.bottom-c.bottom+Bt(n,"bottom")),t.left<c.left+Bt(o,"left")?h=-(c.left-t.left+Bt(n,"left")):t.right>c.right-Bt(o,"right")&&(h=t.right-c.right+Bt(n,"right")),h||d)if(a)i.defaultView.scrollBy(h,d);else{let f=l.scrollLeft,u=l.scrollTop;d&&(l.scrollTop+=d),h&&(l.scrollLeft+=h);let m=l.scrollLeft-f,g=l.scrollTop-u;t={left:t.left-m,top:t.top-g,right:t.right-m,bottom:t.bottom-g}}let p=a?"fixed":getComputedStyle(s).position;if(/^(fixed|sticky)$/.test(p))break;s=p=="absolute"?s.offsetParent:Be(s)}}function Kp(r){let t=r.dom.getBoundingClientRect(),e=Math.max(0,t.top),o,n;for(let i=(t.left+t.right)/2,s=e+1;s<Math.min(innerHeight,t.bottom);s+=5){let l=r.root.elementFromPoint(i,s);if(!l||l==r.dom||!r.dom.contains(l))continue;let a=l.getBoundingClientRect();if(a.top>=e-20){o=l,n=a.top;break}}return{refDOM:o,refTop:n,stack:rl(r.dom)}}function rl(r){let t=[],e=r.ownerDocument;for(let o=r;o&&(t.push({dom:o,top:o.scrollTop,left:o.scrollLeft}),r!=e);o=Be(o));return t}function Up({refDOM:r,refTop:t,stack:e}){let o=r?r.getBoundingClientRect().top:0;ol(e,o==0?0:o-t)}function ol(r,t){for(let e=0;e<r.length;e++){let{dom:o,top:n,left:i}=r[e];o.scrollTop!=n+t&&(o.scrollTop=n+t),o.scrollLeft!=i&&(o.scrollLeft=i)}}let ze=null;function _p(r){if(r.setActive)return r.setActive();if(ze)return r.focus(ze);let t=rl(r);r.focus(ze==null?{get preventScroll(){return ze={preventScroll:!0},!0}}:void 0),ze||(ze=!1,ol(t,0))}function nl(r,t){let e,o=2e8,n,i=0,s=t.top,l=t.top,a,c;for(let h=r.firstChild,d=0;h;h=h.nextSibling,d++){let p;if(h.nodeType==1)p=h.getClientRects();else if(h.nodeType==3)p=Rt(h).getClientRects();else continue;for(let f=0;f<p.length;f++){let u=p[f];if(u.top<=s&&u.bottom>=l){s=Math.max(u.bottom,s),l=Math.min(u.top,l);let m=u.left>t.left?u.left-t.left:u.right<t.left?t.left-u.right:0;if(m<o){e=h,o=m,n=m&&e.nodeType==3?{left:u.right<t.left?u.right:u.left,top:t.top}:t,h.nodeType==1&&m&&(i=d+(t.left>=(u.left+u.right)/2?1:0));continue}}else u.top>t.top&&!a&&u.left<=t.left&&u.right>=t.left&&(a=h,c={left:Math.max(u.left,Math.min(u.right,t.left)),top:u.top});!e&&(t.left>=u.right&&t.top>=u.top||t.left>=u.left&&t.top>=u.bottom)&&(i=d+1)}}return!e&&a&&(e=a,n=c,o=0),e&&e.nodeType==3?Gp(e,n):!e||o&&e.nodeType==1?{node:r,offset:i}:nl(e,n)}function Gp(r,t){let e=r.nodeValue.length,o=document.createRange();for(let n=0;n<e;n++){o.setEnd(r,n+1),o.setStart(r,n);let i=_t(o,1);if(i.top!=i.bottom&&an(t,i))return{node:r,offset:n+(t.left>=(i.left+i.right)/2?1:0)}}return{node:r,offset:0}}function an(r,t){return r.left>=t.left-1&&r.left<=t.right+1&&r.top>=t.top-1&&r.top<=t.bottom+1}function Xp(r,t){let e=r.parentNode;return e&&/^li$/i.test(e.nodeName)&&t.left<r.getBoundingClientRect().left?e:r}function Yp(r,t,e){let{node:o,offset:n}=nl(t,e),i=-1;if(o.nodeType==1&&!o.firstChild){let s=o.getBoundingClientRect();i=s.left!=s.right&&e.left>(s.left+s.right)/2?1:-1}return r.docView.posFromDOM(o,n,i)}function Zp(r,t,e,o){let n=-1;for(let i=t,s=!1;i!=r.dom;){let l=r.docView.nearestDesc(i,!0),a;if(!l)return null;if(l.dom.nodeType==1&&(l.node.isBlock&&l.parent||!l.contentDOM)&&((a=l.dom.getBoundingClientRect()).width||a.height)&&(l.node.isBlock&&l.parent&&(!s&&a.left>o.left||a.top>o.top?n=l.posBefore:(!s&&a.right<o.left||a.bottom<o.top)&&(n=l.posAfter),s=!0),!l.contentDOM&&n<0&&!l.node.isText))return(l.node.isBlock?o.top<(a.top+a.bottom)/2:o.left<(a.left+a.right)/2)?l.posBefore:l.posAfter;i=l.dom.parentNode}return n>-1?n:r.docView.posFromDOM(t,e,-1)}function il(r,t,e){let o=r.childNodes.length;if(o&&e.top<e.bottom)for(let n=Math.max(0,Math.min(o-1,Math.floor(o*(t.top-e.top)/(e.bottom-e.top))-2)),i=n;;){let s=r.childNodes[i];if(s.nodeType==1){let l=s.getClientRects();for(let a=0;a<l.length;a++){let c=l[a];if(an(t,c))return il(s,t,c)}}if((i=(i+1)%o)==n)break}return r}function Qp(r,t){let e=r.dom.ownerDocument,o,n=0,i=jp(e,t.left,t.top);i&&({node:o,offset:n}=i);let s=(r.root.elementFromPoint?r.root:e).elementFromPoint(t.left,t.top),l;if(!s||!r.dom.contains(s.nodeType!=1?s.parentNode:s)){let c=r.dom.getBoundingClientRect();if(!an(t,c)||(s=il(r.dom,t,c),!s))return null}if(tt)for(let c=s;o&&c;c=Be(c))c.draggable&&(o=void 0);if(s=Xp(s,t),o){if(yt&&o.nodeType==1&&(n=Math.min(n,o.childNodes.length),n<o.childNodes.length)){let h=o.childNodes[n],d;h.nodeName=="IMG"&&(d=h.getBoundingClientRect()).right<=t.left&&d.bottom>t.top&&n++}let c;nr&&n&&o.nodeType==1&&(c=o.childNodes[n-1]).nodeType==1&&c.contentEditable=="false"&&c.getBoundingClientRect().top>=t.top&&n--,o==r.dom&&n==o.childNodes.length-1&&o.lastChild.nodeType==1&&t.top>o.lastChild.getBoundingClientRect().bottom?l=r.state.doc.content.size:(n==0||o.nodeType!=1||o.childNodes[n-1].nodeName!="BR")&&(l=Zp(r,o,n,t))}l==null&&(l=Yp(r,s,t));let a=r.docView.nearestDesc(s,!0);return{pos:l,inside:a?a.posAtStart-a.border:-1}}function sl(r){return r.top<r.bottom||r.left<r.right}function _t(r,t){let e=r.getClientRects();if(e.length){let o=e[t<0?0:e.length-1];if(sl(o))return o}return Array.prototype.find.call(e,sl)||r.getBoundingClientRect()}const tu=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function ll(r,t,e){let{node:o,offset:n,atom:i}=r.docView.domFromPos(t,e<0?-1:1),s=nr||yt;if(o.nodeType==3)if(s&&(tu.test(o.nodeValue)||(e<0?!n:n==o.nodeValue.length))){let l=_t(Rt(o,n,n),e);if(yt&&n&&/\s/.test(o.nodeValue[n-1])&&n<o.nodeValue.length){let a=_t(Rt(o,n-1,n-1),-1);if(a.top==l.top){let c=_t(Rt(o,n,n+1),-1);if(c.top!=l.top)return ir(c,c.left<a.left)}}return l}else{let l=n,a=n,c=e<0?1:-1;return e<0&&!n?(a++,c=-1):e>=0&&n==o.nodeValue.length?(l--,c=1):e<0?l--:a++,ir(_t(Rt(o,l,a),c),c<0)}if(!r.state.doc.resolve(t-(i||0)).parent.inlineContent){if(i==null&&n&&(e<0||n==at(o))){let l=o.childNodes[n-1];if(l.nodeType==1)return cn(l.getBoundingClientRect(),!1)}if(i==null&&n<at(o)){let l=o.childNodes[n];if(l.nodeType==1)return cn(l.getBoundingClientRect(),!0)}return cn(o.getBoundingClientRect(),e>=0)}if(i==null&&n&&(e<0||n==at(o))){let l=o.childNodes[n-1],a=l.nodeType==3?Rt(l,at(l)-(s?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(a)return ir(_t(a,1),!1)}if(i==null&&n<at(o)){let l=o.childNodes[n];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let a=l?l.nodeType==3?Rt(l,0,s?0:1):l.nodeType==1?l:null:null;if(a)return ir(_t(a,-1),!0)}return ir(_t(o.nodeType==3?Rt(o):o,-e),e>=0)}function ir(r,t){if(r.width==0)return r;let e=t?r.left:r.right;return{top:r.top,bottom:r.bottom,left:e,right:e}}function cn(r,t){if(r.height==0)return r;let e=t?r.top:r.bottom;return{top:e,bottom:e,left:r.left,right:r.right}}function al(r,t,e){let o=r.state,n=r.root.activeElement;o!=t&&r.updateState(t),n!=r.dom&&r.focus();try{return e()}finally{o!=t&&r.updateState(o),n!=r.dom&&n&&n.focus()}}function eu(r,t,e){let o=t.selection,n=e=="up"?o.$from:o.$to;return al(r,t,()=>{let{node:i}=r.docView.domFromPos(n.pos,e=="up"?-1:1);for(;;){let l=r.docView.nearestDesc(i,!0);if(!l)break;if(l.node.isBlock){i=l.contentDOM||l.dom;break}i=l.dom.parentNode}let s=ll(r,n.pos,1);for(let l=i.firstChild;l;l=l.nextSibling){let a;if(l.nodeType==1)a=l.getClientRects();else if(l.nodeType==3)a=Rt(l,0,l.nodeValue.length).getClientRects();else continue;for(let c=0;c<a.length;c++){let h=a[c];if(h.bottom>h.top+1&&(e=="up"?s.top-h.top>(h.bottom-s.top)*2:h.bottom-s.bottom>(s.bottom-h.top)*2))return!1}}return!0})}const ru=/[\u0590-\u08ac]/;function ou(r,t,e){let{$head:o}=t.selection;if(!o.parent.isTextblock)return!1;let n=o.parentOffset,i=!n,s=n==o.parent.content.size,l=r.domSelection();return l?!ru.test(o.parent.textContent)||!l.modify?e=="left"||e=="backward"?i:s:al(r,t,()=>{let{focusNode:a,focusOffset:c,anchorNode:h,anchorOffset:d}=r.domSelectionRange(),p=l.caretBidiLevel;l.modify("move",e,"character");let f=o.depth?r.docView.domAfterPos(o.before()):r.dom,{focusNode:u,focusOffset:m}=r.domSelectionRange(),g=u&&!f.contains(u.nodeType==1?u:u.parentNode)||a==u&&c==m;try{l.collapse(h,d),a&&(a!=h||c!=d)&&l.extend&&l.extend(a,c)}catch{}return p!=null&&(l.caretBidiLevel=p),g}):o.pos==o.start()||o.pos==o.end()}let cl=null,hl=null,dl=!1;function nu(r,t,e){return cl==t&&hl==e?dl:(cl=t,hl=e,dl=e=="up"||e=="down"?eu(r,t,e):ou(r,t,e))}const ht=0,pl=1,ue=2,Ot=3;class sr{constructor(t,e,o,n){this.parent=t,this.children=e,this.dom=o,this.contentDOM=n,this.dirty=ht,o.pmViewDesc=this}matchesWidget(t){return!1}matchesMark(t){return!1}matchesNode(t,e,o){return!1}matchesHack(t){return!1}parseRule(){return null}stopEvent(t){return!1}get size(){let t=0;for(let e=0;e<this.children.length;e++)t+=this.children[e].size;return t}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let t=0;t<this.children.length;t++)this.children[t].destroy()}posBeforeChild(t){for(let e=0,o=this.posAtStart;;e++){let n=this.children[e];if(n==t)return o;o+=n.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(t,e,o){if(this.contentDOM&&this.contentDOM.contains(t.nodeType==1?t:t.parentNode))if(o<0){let i,s;if(t==this.contentDOM)i=t.childNodes[e-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;i=t.previousSibling}for(;i&&!((s=i.pmViewDesc)&&s.parent==this);)i=i.previousSibling;return i?this.posBeforeChild(s)+s.size:this.posAtStart}else{let i,s;if(t==this.contentDOM)i=t.childNodes[e];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;i=t.nextSibling}for(;i&&!((s=i.pmViewDesc)&&s.parent==this);)i=i.nextSibling;return i?this.posBeforeChild(s):this.posAtEnd}let n;if(t==this.dom&&this.contentDOM)n=e>K(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))n=t.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(e==0)for(let i=t;;i=i.parentNode){if(i==this.dom){n=!1;break}if(i.previousSibling)break}if(n==null&&e==t.childNodes.length)for(let i=t;;i=i.parentNode){if(i==this.dom){n=!0;break}if(i.nextSibling)break}}return n??o>0?this.posAtEnd:this.posAtStart}nearestDesc(t,e=!1){for(let o=!0,n=t;n;n=n.parentNode){let i=this.getDesc(n),s;if(i&&(!e||i.node))if(o&&(s=i.nodeDOM)&&!(s.nodeType==1?s.contains(t.nodeType==1?t:t.parentNode):s==t))o=!1;else return i}}getDesc(t){let e=t.pmViewDesc;for(let o=e;o;o=o.parent)if(o==this)return e}posFromDOM(t,e,o){for(let n=t;n;n=n.parentNode){let i=this.getDesc(n);if(i)return i.localPosFromDOM(t,e,o)}return-1}descAt(t){for(let e=0,o=0;e<this.children.length;e++){let n=this.children[e],i=o+n.size;if(o==t&&i!=o){for(;!n.border&&n.children.length;)for(let s=0;s<n.children.length;s++){let l=n.children[s];if(l.size){n=l;break}}return n}if(t<i)return n.descAt(t-o-n.border);o=i}}domFromPos(t,e){if(!this.contentDOM)return{node:this.dom,offset:0,atom:t+1};let o=0,n=0;for(let i=0;o<this.children.length;o++){let s=this.children[o],l=i+s.size;if(l>t||s instanceof ml){n=t-i;break}i=l}if(n)return this.children[o].domFromPos(n-this.children[o].border,e);for(let i;o&&!(i=this.children[o-1]).size&&i instanceof ul&&i.side>=0;o--);if(e<=0){let i,s=!0;for(;i=o?this.children[o-1]:null,!(!i||i.dom.parentNode==this.contentDOM);o--,s=!1);return i&&e&&s&&!i.border&&!i.domAtom?i.domFromPos(i.size,e):{node:this.contentDOM,offset:i?K(i.dom)+1:0}}else{let i,s=!0;for(;i=o<this.children.length?this.children[o]:null,!(!i||i.dom.parentNode==this.contentDOM);o++,s=!1);return i&&s&&!i.border&&!i.domAtom?i.domFromPos(0,e):{node:this.contentDOM,offset:i?K(i.dom):this.contentDOM.childNodes.length}}}parseRange(t,e,o=0){if(this.children.length==0)return{node:this.contentDOM,from:t,to:e,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let n=-1,i=-1;for(let s=o,l=0;;l++){let a=this.children[l],c=s+a.size;if(n==-1&&t<=c){let h=s+a.border;if(t>=h&&e<=c-a.border&&a.node&&a.contentDOM&&this.contentDOM.contains(a.contentDOM))return a.parseRange(t,e,h);t=s;for(let d=l;d>0;d--){let p=this.children[d-1];if(p.size&&p.dom.parentNode==this.contentDOM&&!p.emptyChildAt(1)){n=K(p.dom)+1;break}t-=p.size}n==-1&&(n=0)}if(n>-1&&(c>e||l==this.children.length-1)){e=c;for(let h=l+1;h<this.children.length;h++){let d=this.children[h];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(-1)){i=K(d.dom);break}e+=d.size}i==-1&&(i=this.contentDOM.childNodes.length);break}s=c}return{node:this.contentDOM,from:t,to:e,fromOffset:n,toOffset:i}}emptyChildAt(t){if(this.border||!this.contentDOM||!this.children.length)return!1;let e=this.children[t<0?0:this.children.length-1];return e.size==0||e.emptyChildAt(t)}domAfterPos(t){let{node:e,offset:o}=this.domFromPos(t,0);if(e.nodeType!=1||o==e.childNodes.length)throw new RangeError("No node after pos "+t);return e.childNodes[o]}setSelection(t,e,o,n=!1){let i=Math.min(t,e),s=Math.max(t,e);for(let f=0,u=0;f<this.children.length;f++){let m=this.children[f],g=u+m.size;if(i>u&&s<g)return m.setSelection(t-u-m.border,e-u-m.border,o,n);u=g}let l=this.domFromPos(t,t?-1:1),a=e==t?l:this.domFromPos(e,e?-1:1),c=o.root.getSelection(),h=o.domSelectionRange(),d=!1;if((yt||tt)&&t==e){let{node:f,offset:u}=l;if(f.nodeType==3){if(d=!!(u&&f.nodeValue[u-1]==`
`),d&&u==f.nodeValue.length)for(let m=f,g;m;m=m.parentNode){if(g=m.nextSibling){g.nodeName=="BR"&&(l=a={node:g.parentNode,offset:K(g)+1});break}let y=m.pmViewDesc;if(y&&y.node&&y.node.isBlock)break}}else{let m=f.childNodes[u-1];d=m&&(m.nodeName=="BR"||m.contentEditable=="false")}}if(yt&&h.focusNode&&h.focusNode!=a.node&&h.focusNode.nodeType==1){let f=h.focusNode.childNodes[h.focusOffset];f&&f.contentEditable=="false"&&(n=!0)}if(!(n||d&&tt)&&de(l.node,l.offset,h.anchorNode,h.anchorOffset)&&de(a.node,a.offset,h.focusNode,h.focusOffset))return;let p=!1;if((c.extend||t==e)&&!d){c.collapse(l.node,l.offset);try{t!=e&&c.extend(a.node,a.offset),p=!0}catch{}}if(!p){if(t>e){let u=l;l=a,a=u}let f=document.createRange();f.setEnd(a.node,a.offset),f.setStart(l.node,l.offset),c.removeAllRanges(),c.addRange(f)}}ignoreMutation(t){return!this.contentDOM&&t.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(t,e){for(let o=0,n=0;n<this.children.length;n++){let i=this.children[n],s=o+i.size;if(o==s?t<=s&&e>=o:t<s&&e>o){let l=o+i.border,a=s-i.border;if(t>=l&&e<=a){this.dirty=t==o||e==s?ue:pl,t==l&&e==a&&(i.contentLost||i.dom.parentNode!=this.contentDOM)?i.dirty=Ot:i.markDirty(t-l,e-l);return}else i.dirty=i.dom==i.contentDOM&&i.dom.parentNode==this.contentDOM&&!i.children.length?ue:Ot}o=s}this.dirty=ue}markParentsDirty(){let t=1;for(let e=this.parent;e;e=e.parent,t++){let o=t==1?ue:pl;e.dirty<o&&(e.dirty=o)}}get domAtom(){return!1}get ignoreForCoords(){return!1}isText(t){return!1}}class ul extends sr{constructor(t,e,o,n){let i,s=e.type.toDOM;if(typeof s=="function"&&(s=s(o,()=>{if(!i)return n;if(i.parent)return i.parent.posBeforeChild(i)})),!e.type.spec.raw){if(s.nodeType!=1){let l=document.createElement("span");l.appendChild(s),s=l}s.contentEditable="false",s.classList.add("ProseMirror-widget")}super(t,[],s,null),this.widget=e,this.widget=e,i=this}matchesWidget(t){return this.dirty==ht&&t.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(t){let e=this.widget.spec.stopEvent;return e?e(t):!1}ignoreMutation(t){return t.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class iu extends sr{constructor(t,e,o,n){super(t,[],e,null),this.textDOM=o,this.text=n}get size(){return this.text.length}localPosFromDOM(t,e){return t!=this.textDOM?this.posAtStart+(e?this.size:0):this.posAtStart+e}domFromPos(t){return{node:this.textDOM,offset:t}}ignoreMutation(t){return t.type==="characterData"&&t.target.nodeValue==t.oldValue}}class be extends sr{constructor(t,e,o,n,i){super(t,[],o,n),this.mark=e,this.spec=i}static create(t,e,o,n){let i=n.nodeViews[e.type.name],s=i&&i(e,n,o);return(!s||!s.dom)&&(s=$t.renderSpec(document,e.type.spec.toDOM(e,o),null,e.attrs)),new be(t,e,s.dom,s.contentDOM||s.dom,s)}parseRule(){return this.dirty&Ot||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(t){return this.dirty!=Ot&&this.mark.eq(t)}markDirty(t,e){if(super.markDirty(t,e),this.dirty!=ht){let o=this.parent;for(;!o.node;)o=o.parent;o.dirty<this.dirty&&(o.dirty=this.dirty),this.dirty=ht}}slice(t,e,o){let n=be.create(this.parent,this.mark,!0,o),i=this.children,s=this.size;e<s&&(i=dn(i,e,s,o)),t>0&&(i=dn(i,0,t,o));for(let l=0;l<i.length;l++)i[l].parent=n;return n.children=i,n}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class Qt extends sr{constructor(t,e,o,n,i,s,l,a,c){super(t,[],i,s),this.node=e,this.outerDeco=o,this.innerDeco=n,this.nodeDOM=l}static create(t,e,o,n,i,s){let l=i.nodeViews[e.type.name],a,c=l&&l(e,i,()=>{if(!a)return s;if(a.parent)return a.parent.posBeforeChild(a)},o,n),h=c&&c.dom,d=c&&c.contentDOM;if(e.isText){if(!h)h=document.createTextNode(e.text);else if(h.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else h||({dom:h,contentDOM:d}=$t.renderSpec(document,e.type.spec.toDOM(e),null,e.attrs));!d&&!e.isText&&h.nodeName!="BR"&&(h.hasAttribute("contenteditable")||(h.contentEditable="false"),e.type.spec.draggable&&(h.draggable=!0));let p=h;return h=wl(h,o,e),c?a=new su(t,e,o,n,h,d||null,p,c,i,s+1):e.isText?new io(t,e,o,n,h,p,i):new Qt(t,e,o,n,h,d||null,p,i,s+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let t={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(t.preserveWhitespace="full"),!this.contentDOM)t.getContent=()=>this.node.content;else if(!this.contentLost)t.contentElement=this.contentDOM;else{for(let e=this.children.length-1;e>=0;e--){let o=this.children[e];if(this.dom.contains(o.dom.parentNode)){t.contentElement=o.dom.parentNode;break}}t.contentElement||(t.getContent=()=>w.empty)}return t}matchesNode(t,e,o){return this.dirty==ht&&t.eq(this.node)&&qr(e,this.outerDeco)&&o.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(t,e){let o=this.node.inlineContent,n=e,i=t.composing?this.localCompositionInfo(t,e):null,s=i&&i.pos>-1?i:null,l=i&&i.pos<0,a=new au(this,s&&s.node,t);du(this.node,this.innerDeco,(c,h,d)=>{c.spec.marks?a.syncToMarks(c.spec.marks,o,t):c.type.side>=0&&!d&&a.syncToMarks(h==this.node.childCount?E.none:this.node.child(h).marks,o,t),a.placeWidget(c,t,n)},(c,h,d,p)=>{a.syncToMarks(c.marks,o,t);let f;a.findNodeMatch(c,h,d,p)||l&&t.state.selection.from>n&&t.state.selection.to<n+c.nodeSize&&(f=a.findIndexWithChild(i.node))>-1&&a.updateNodeAt(c,h,d,f,t)||a.updateNextNode(c,h,d,t,p,n)||a.addNode(c,h,d,t,n),n+=c.nodeSize}),a.syncToMarks([],o,t),this.node.isTextblock&&a.addTextblockHacks(),a.destroyRest(),(a.changed||this.dirty==ue)&&(s&&this.protectLocalComposition(t,s),gl(this.contentDOM,this.children,t),Ie&&pu(this.dom))}localCompositionInfo(t,e){let{from:o,to:n}=t.state.selection;if(!(t.state.selection instanceof A)||o<e||n>e+this.node.content.size)return null;let i=t.input.compositionNode;if(!i||!this.dom.contains(i.parentNode))return null;if(this.node.inlineContent){let s=i.nodeValue,l=uu(this.node.content,s,o-e,n-e);return l<0?null:{node:i,pos:l,text:s}}else return{node:i,pos:-1,text:""}}protectLocalComposition(t,{node:e,pos:o,text:n}){if(this.getDesc(e))return;let i=e;for(;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=void 0)}let s=new iu(this,i,e,n);t.input.compositionNodes.push(s),this.children=dn(this.children,o,o+n.length,t,s)}update(t,e,o,n){return this.dirty==Ot||!t.sameMarkup(this.node)?!1:(this.updateInner(t,e,o,n),!0)}updateInner(t,e,o,n){this.updateOuterDeco(e),this.node=t,this.innerDeco=o,this.contentDOM&&this.updateChildren(n,this.posAtStart),this.dirty=ht}updateOuterDeco(t){if(qr(t,this.outerDeco))return;let e=this.nodeDOM.nodeType!=1,o=this.dom;this.dom=yl(this.dom,this.nodeDOM,hn(this.outerDeco,this.node,e),hn(t,this.node,e)),this.dom!=o&&(o.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=t}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function fl(r,t,e,o,n){wl(o,t,r);let i=new Qt(void 0,r,t,e,o,o,o,n,0);return i.contentDOM&&i.updateChildren(n,0),i}class io extends Qt{constructor(t,e,o,n,i,s,l){super(t,e,o,n,i,null,s,l,0)}parseRule(){let t=this.nodeDOM.parentNode;for(;t&&t!=this.dom&&!t.pmIsDeco;)t=t.parentNode;return{skip:t||!0}}update(t,e,o,n){return this.dirty==Ot||this.dirty!=ht&&!this.inParent()||!t.sameMarkup(this.node)?!1:(this.updateOuterDeco(e),(this.dirty!=ht||t.text!=this.node.text)&&t.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=t.text,n.trackWrites==this.nodeDOM&&(n.trackWrites=null)),this.node=t,this.dirty=ht,!0)}inParent(){let t=this.parent.contentDOM;for(let e=this.nodeDOM;e;e=e.parentNode)if(e==t)return!0;return!1}domFromPos(t){return{node:this.nodeDOM,offset:t}}localPosFromDOM(t,e,o){return t==this.nodeDOM?this.posAtStart+Math.min(e,this.node.text.length):super.localPosFromDOM(t,e,o)}ignoreMutation(t){return t.type!="characterData"&&t.type!="selection"}slice(t,e,o){let n=this.node.cut(t,e),i=document.createTextNode(n.text);return new io(this.parent,n,this.outerDeco,this.innerDeco,i,i,o)}markDirty(t,e){super.markDirty(t,e),this.dom!=this.nodeDOM&&(t==0||e==this.nodeDOM.nodeValue.length)&&(this.dirty=Ot)}get domAtom(){return!1}isText(t){return this.node.text==t}}class ml extends sr{parseRule(){return{ignore:!0}}matchesHack(t){return this.dirty==ht&&this.dom.nodeName==t}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class su extends Qt{constructor(t,e,o,n,i,s,l,a,c,h){super(t,e,o,n,i,s,l,c,h),this.spec=a}update(t,e,o,n){if(this.dirty==Ot)return!1;if(this.spec.update&&(this.node.type==t.type||this.spec.multiType)){let i=this.spec.update(t,e,o);return i&&this.updateInner(t,e,o,n),i}else return!this.contentDOM&&!t.isLeaf?!1:super.update(t,e,o,n)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(t,e,o,n){this.spec.setSelection?this.spec.setSelection(t,e,o.root):super.setSelection(t,e,o,n)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(t){return this.spec.stopEvent?this.spec.stopEvent(t):!1}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}}function gl(r,t,e){let o=r.firstChild,n=!1;for(let i=0;i<t.length;i++){let s=t[i],l=s.dom;if(l.parentNode==r){for(;l!=o;)o=vl(o),n=!0;o=o.nextSibling}else n=!0,r.insertBefore(l,o);if(s instanceof be){let a=o?o.previousSibling:r.lastChild;gl(s.contentDOM,s.children,e),o=a?a.nextSibling:r.firstChild}}for(;o;)o=vl(o),n=!0;n&&e.trackWrites==r&&(e.trackWrites=null)}const lr=function(r){r&&(this.nodeName=r)};lr.prototype=Object.create(null);const fe=[new lr];function hn(r,t,e){if(r.length==0)return fe;let o=e?fe[0]:new lr,n=[o];for(let i=0;i<r.length;i++){let s=r[i].type.attrs;if(s){s.nodeName&&n.push(o=new lr(s.nodeName));for(let l in s){let a=s[l];a!=null&&(e&&n.length==1&&n.push(o=new lr(t.isInline?"span":"div")),l=="class"?o.class=(o.class?o.class+" ":"")+a:l=="style"?o.style=(o.style?o.style+";":"")+a:l!="nodeName"&&(o[l]=a))}}}return n}function yl(r,t,e,o){if(e==fe&&o==fe)return t;let n=t;for(let i=0;i<o.length;i++){let s=o[i],l=e[i];if(i){let a;l&&l.nodeName==s.nodeName&&n!=r&&(a=n.parentNode)&&a.nodeName.toLowerCase()==s.nodeName||(a=document.createElement(s.nodeName),a.pmIsDeco=!0,a.appendChild(n),l=fe[0]),n=a}lu(n,l||fe[0],s)}return n}function lu(r,t,e){for(let o in t)o!="class"&&o!="style"&&o!="nodeName"&&!(o in e)&&r.removeAttribute(o);for(let o in e)o!="class"&&o!="style"&&o!="nodeName"&&e[o]!=t[o]&&r.setAttribute(o,e[o]);if(t.class!=e.class){let o=t.class?t.class.split(" ").filter(Boolean):[],n=e.class?e.class.split(" ").filter(Boolean):[];for(let i=0;i<o.length;i++)n.indexOf(o[i])==-1&&r.classList.remove(o[i]);for(let i=0;i<n.length;i++)o.indexOf(n[i])==-1&&r.classList.add(n[i]);r.classList.length==0&&r.removeAttribute("class")}if(t.style!=e.style){if(t.style){let o=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,n;for(;n=o.exec(t.style);)r.style.removeProperty(n[1])}e.style&&(r.style.cssText+=e.style)}}function wl(r,t,e){return yl(r,r,fe,hn(t,e,r.nodeType!=1))}function qr(r,t){if(r.length!=t.length)return!1;for(let e=0;e<r.length;e++)if(!r[e].type.eq(t[e].type))return!1;return!0}function vl(r){let t=r.nextSibling;return r.parentNode.removeChild(r),t}class au{constructor(t,e,o){this.lock=e,this.view=o,this.index=0,this.stack=[],this.changed=!1,this.top=t,this.preMatch=cu(t.node.content,t)}destroyBetween(t,e){if(t!=e){for(let o=t;o<e;o++)this.top.children[o].destroy();this.top.children.splice(t,e-t),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(t,e,o){let n=0,i=this.stack.length>>1,s=Math.min(i,t.length);for(;n<s&&(n==i-1?this.top:this.stack[n+1<<1]).matchesMark(t[n])&&t[n].type.spec.spanning!==!1;)n++;for(;n<i;)this.destroyRest(),this.top.dirty=ht,this.index=this.stack.pop(),this.top=this.stack.pop(),i--;for(;i<t.length;){this.stack.push(this.top,this.index+1);let l=-1;for(let a=this.index;a<Math.min(this.index+3,this.top.children.length);a++){let c=this.top.children[a];if(c.matchesMark(t[i])&&!this.isLocked(c.dom)){l=a;break}}if(l>-1)l>this.index&&(this.changed=!0,this.destroyBetween(this.index,l)),this.top=this.top.children[this.index];else{let a=be.create(this.top,t[i],e,o);this.top.children.splice(this.index,0,a),this.top=a,this.changed=!0}this.index=0,i++}}findNodeMatch(t,e,o,n){let i=-1,s;if(n>=this.preMatch.index&&(s=this.preMatch.matches[n-this.preMatch.index]).parent==this.top&&s.matchesNode(t,e,o))i=this.top.children.indexOf(s,this.index);else for(let l=this.index,a=Math.min(this.top.children.length,l+5);l<a;l++){let c=this.top.children[l];if(c.matchesNode(t,e,o)&&!this.preMatch.matched.has(c)){i=l;break}}return i<0?!1:(this.destroyBetween(this.index,i),this.index++,!0)}updateNodeAt(t,e,o,n,i){let s=this.top.children[n];return s.dirty==Ot&&s.dom==s.contentDOM&&(s.dirty=ue),s.update(t,e,o,i)?(this.destroyBetween(this.index,n),this.index++,!0):!1}findIndexWithChild(t){for(;;){let e=t.parentNode;if(!e)return-1;if(e==this.top.contentDOM){let o=t.pmViewDesc;if(o){for(let n=this.index;n<this.top.children.length;n++)if(this.top.children[n]==o)return n}return-1}t=e}}updateNextNode(t,e,o,n,i,s){for(let l=this.index;l<this.top.children.length;l++){let a=this.top.children[l];if(a instanceof Qt){let c=this.preMatch.matched.get(a);if(c!=null&&c!=i)return!1;let h=a.dom,d,p=this.isLocked(h)&&!(t.isText&&a.node&&a.node.isText&&a.nodeDOM.nodeValue==t.text&&a.dirty!=Ot&&qr(e,a.outerDeco));if(!p&&a.update(t,e,o,n))return this.destroyBetween(this.index,l),a.dom!=h&&(this.changed=!0),this.index++,!0;if(!p&&(d=this.recreateWrapper(a,t,e,o,n,s)))return this.destroyBetween(this.index,l),this.top.children[this.index]=d,d.contentDOM&&(d.dirty=ue,d.updateChildren(n,s+1),d.dirty=ht),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(t,e,o,n,i,s){if(t.dirty||e.isAtom||!t.children.length||!t.node.content.eq(e.content)||!qr(o,t.outerDeco)||!n.eq(t.innerDeco))return null;let l=Qt.create(this.top,e,o,n,i,s);if(l.contentDOM){l.children=t.children,t.children=[];for(let a of l.children)a.parent=l}return t.destroy(),l}addNode(t,e,o,n,i){let s=Qt.create(this.top,t,e,o,n,i);s.contentDOM&&s.updateChildren(n,i+1),this.top.children.splice(this.index++,0,s),this.changed=!0}placeWidget(t,e,o){let n=this.index<this.top.children.length?this.top.children[this.index]:null;if(n&&n.matchesWidget(t)&&(t==n.widget||!n.widget.type.toDOM.parentNode))this.index++;else{let i=new ul(this.top,t,e,o);this.top.children.splice(this.index++,0,i),this.changed=!0}}addTextblockHacks(){let t=this.top.children[this.index-1],e=this.top;for(;t instanceof be;)e=t,t=e.children[e.children.length-1];(!t||!(t instanceof io)||/\n$/.test(t.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(t.node.text))&&((tt||X)&&t&&t.dom.contentEditable=="false"&&this.addHackNode("IMG",e),this.addHackNode("BR",this.top))}addHackNode(t,e){if(e==this.top&&this.index<e.children.length&&e.children[this.index].matchesHack(t))this.index++;else{let o=document.createElement(t);t=="IMG"&&(o.className="ProseMirror-separator",o.alt=""),t=="BR"&&(o.className="ProseMirror-trailingBreak");let n=new ml(this.top,[],o,null);e!=this.top?e.children.push(n):e.children.splice(this.index++,0,n),this.changed=!0}}isLocked(t){return this.lock&&(t==this.lock||t.nodeType==1&&t.contains(this.lock.parentNode))}}function cu(r,t){let e=t,o=e.children.length,n=r.childCount,i=new Map,s=[];t:for(;n>0;){let l;for(;;)if(o){let c=e.children[o-1];if(c instanceof be)e=c,o=c.children.length;else{l=c,o--;break}}else{if(e==t)break t;o=e.parent.children.indexOf(e),e=e.parent}let a=l.node;if(a){if(a!=r.child(n-1))break;--n,i.set(l,n),s.push(l)}}return{index:n,matched:i,matches:s.reverse()}}function hu(r,t){return r.type.side-t.type.side}function du(r,t,e,o){let n=t.locals(r),i=0;if(n.length==0){for(let c=0;c<r.childCount;c++){let h=r.child(c);o(h,n,t.forChild(i,h),c),i+=h.nodeSize}return}let s=0,l=[],a=null;for(let c=0;;){let h,d;for(;s<n.length&&n[s].to==i;){let g=n[s++];g.widget&&(h?(d||(d=[h])).push(g):h=g)}if(h)if(d){d.sort(hu);for(let g=0;g<d.length;g++)e(d[g],c,!!a)}else e(h,c,!!a);let p,f;if(a)f=-1,p=a,a=null;else if(c<r.childCount)f=c,p=r.child(c++);else break;for(let g=0;g<l.length;g++)l[g].to<=i&&l.splice(g--,1);for(;s<n.length&&n[s].from<=i&&n[s].to>i;)l.push(n[s++]);let u=i+p.nodeSize;if(p.isText){let g=u;s<n.length&&n[s].from<g&&(g=n[s].from);for(let y=0;y<l.length;y++)l[y].to<g&&(g=l[y].to);g<u&&(a=p.cut(g-i),p=p.cut(0,g-i),u=g,f=-1)}else for(;s<n.length&&n[s].to<u;)s++;let m=p.isInline&&!p.isLeaf?l.filter(g=>!g.inline):l.slice();o(p,m,t.forChild(i,p),f),i=u}}function pu(r){if(r.nodeName=="UL"||r.nodeName=="OL"){let t=r.style.cssText;r.style.cssText=t+"; list-style: square !important",window.getComputedStyle(r).listStyle,r.style.cssText=t}}function uu(r,t,e,o){for(let n=0,i=0;n<r.childCount&&i<=o;){let s=r.child(n++),l=i;if(i+=s.nodeSize,!s.isText)continue;let a=s.text;for(;n<r.childCount;){let c=r.child(n++);if(i+=c.nodeSize,!c.isText)break;a+=c.text}if(i>=e){if(i>=o&&a.slice(o-t.length-l,o-l)==t)return o-t.length;let c=l<o?a.lastIndexOf(t,o-l-1):-1;if(c>=0&&c+t.length+l>=e)return l+c;if(e==o&&a.length>=o+t.length-l&&a.slice(o-l,o-l+t.length)==t)return o}}return-1}function dn(r,t,e,o,n){let i=[];for(let s=0,l=0;s<r.length;s++){let a=r[s],c=l,h=l+=a.size;c>=e||h<=t?i.push(a):(c<t&&i.push(a.slice(0,t-c,o)),n&&(i.push(n),n=void 0),h>e&&i.push(a.slice(e-c,a.size,o)))}return i}function pn(r,t=null){let e=r.domSelectionRange(),o=r.state.doc;if(!e.focusNode)return null;let n=r.docView.nearestDesc(e.focusNode),i=n&&n.size==0,s=r.docView.posFromDOM(e.focusNode,e.focusOffset,1);if(s<0)return null;let l=o.resolve(s),a,c;if(Wr(e)){for(a=s;n&&!n.node;)n=n.parent;let d=n.node;if(n&&d.isAtom&&O.isSelectable(d)&&n.parent&&!(d.isInline&&Lp(e.focusNode,e.focusOffset,n.dom))){let p=n.posBefore;c=new O(s==p?l:o.resolve(p))}}else{if(e instanceof r.dom.ownerDocument.defaultView.Selection&&e.rangeCount>1){let d=s,p=s;for(let f=0;f<e.rangeCount;f++){let u=e.getRangeAt(f);d=Math.min(d,r.docView.posFromDOM(u.startContainer,u.startOffset,1)),p=Math.max(p,r.docView.posFromDOM(u.endContainer,u.endOffset,-1))}if(d<0)return null;[a,s]=p==r.state.selection.anchor?[p,d]:[d,p],l=o.resolve(s)}else a=r.docView.posFromDOM(e.anchorNode,e.anchorOffset,1);if(a<0)return null}let h=o.resolve(a);if(!c){let d=t=="pointer"||r.state.selection.head<l.pos&&!i?1:-1;c=fn(r,h,l,d)}return c}function bl(r){return r.editable?r.hasFocus():Nl(r)&&document.activeElement&&document.activeElement.contains(r.dom)}function It(r,t=!1){let e=r.state.selection;if(Ml(r,e),!!bl(r)){if(!t&&r.input.mouseDown&&r.input.mouseDown.allowDefault&&X){let o=r.domSelectionRange(),n=r.domObserver.currentSelection;if(o.anchorNode&&n.anchorNode&&de(o.anchorNode,o.anchorOffset,n.anchorNode,n.anchorOffset)){r.input.mouseDown.delayedSelectionSync=!0,r.domObserver.setCurSelection();return}}if(r.domObserver.disconnectSelection(),r.cursorWrapper)mu(r);else{let{anchor:o,head:n}=e,i,s;kl&&!(e instanceof A)&&(e.$from.parent.inlineContent||(i=xl(r,e.from)),!e.empty&&!e.$from.parent.inlineContent&&(s=xl(r,e.to))),r.docView.setSelection(o,n,r,t),kl&&(i&&Sl(i),s&&Sl(s)),e.visible?r.dom.classList.remove("ProseMirror-hideselection"):(r.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&fu(r))}r.domObserver.setCurSelection(),r.domObserver.connectSelection()}}const kl=tt||X&&tl<63;function xl(r,t){let{node:e,offset:o}=r.docView.domFromPos(t,0),n=o<e.childNodes.length?e.childNodes[o]:null,i=o?e.childNodes[o-1]:null;if(tt&&n&&n.contentEditable=="false")return un(n);if((!n||n.contentEditable=="false")&&(!i||i.contentEditable=="false")){if(n)return un(n);if(i)return un(i)}}function un(r){return r.contentEditable="true",tt&&r.draggable&&(r.draggable=!1,r.wasDraggable=!0),r}function Sl(r){r.contentEditable="false",r.wasDraggable&&(r.draggable=!0,r.wasDraggable=null)}function fu(r){let t=r.dom.ownerDocument;t.removeEventListener("selectionchange",r.input.hideSelectionGuard);let e=r.domSelectionRange(),o=e.anchorNode,n=e.anchorOffset;t.addEventListener("selectionchange",r.input.hideSelectionGuard=()=>{(e.anchorNode!=o||e.anchorOffset!=n)&&(t.removeEventListener("selectionchange",r.input.hideSelectionGuard),setTimeout(()=>{(!bl(r)||r.state.selection.visible)&&r.dom.classList.remove("ProseMirror-hideselection")},20))})}function mu(r){let t=r.domSelection(),e=document.createRange();if(!t)return;let o=r.cursorWrapper.dom,n=o.nodeName=="IMG";n?e.setStart(o.parentNode,K(o)+1):e.setStart(o,0),e.collapse(!0),t.removeAllRanges(),t.addRange(e),!n&&!r.state.selection.visible&&ot&&Ut<=11&&(o.disabled=!0,o.disabled=!1)}function Ml(r,t){if(t instanceof O){let e=r.docView.descAt(t.from);e!=r.lastSelectedViewDesc&&(Cl(r),e&&e.selectNode(),r.lastSelectedViewDesc=e)}else Cl(r)}function Cl(r){r.lastSelectedViewDesc&&(r.lastSelectedViewDesc.parent&&r.lastSelectedViewDesc.deselectNode(),r.lastSelectedViewDesc=void 0)}function fn(r,t,e,o){return r.someProp("createSelectionBetween",n=>n(r,t,e))||A.between(t,e,o)}function Ol(r){return r.editable&&!r.hasFocus()?!1:Nl(r)}function Nl(r){let t=r.domSelectionRange();if(!t.anchorNode)return!1;try{return r.dom.contains(t.anchorNode.nodeType==3?t.anchorNode.parentNode:t.anchorNode)&&(r.editable||r.dom.contains(t.focusNode.nodeType==3?t.focusNode.parentNode:t.focusNode))}catch{return!1}}function gu(r){let t=r.docView.domFromPos(r.state.selection.anchor,0),e=r.domSelectionRange();return de(t.node,t.offset,e.anchorNode,e.anchorOffset)}function mn(r,t){let{$anchor:e,$head:o}=r.selection,n=t>0?e.max(o):e.min(o),i=n.parent.inlineContent?n.depth?r.doc.resolve(t>0?n.after():n.before()):null:n;return i&&D.findFrom(i,t)}function Gt(r,t){return r.dispatch(r.state.tr.setSelection(t).scrollIntoView()),!0}function Tl(r,t,e){let o=r.state.selection;if(o instanceof A)if(e.indexOf("s")>-1){let{$head:n}=o,i=n.textOffset?null:t<0?n.nodeBefore:n.nodeAfter;if(!i||i.isText||!i.isLeaf)return!1;let s=r.state.doc.resolve(n.pos+i.nodeSize*(t<0?-1:1));return Gt(r,new A(o.$anchor,s))}else if(o.empty){if(r.endOfTextblock(t>0?"forward":"backward")){let n=mn(r.state,t);return n&&n instanceof O?Gt(r,n):!1}else if(!(ct&&e.indexOf("m")>-1)){let n=o.$head,i=n.textOffset?null:t<0?n.nodeBefore:n.nodeAfter,s;if(!i||i.isText)return!1;let l=t<0?n.pos-i.nodeSize:n.pos;return i.isAtom||(s=r.docView.descAt(l))&&!s.contentDOM?O.isSelectable(i)?Gt(r,new O(t<0?r.state.doc.resolve(n.pos-i.nodeSize):n)):nr?Gt(r,new A(r.state.doc.resolve(t<0?l:l+i.nodeSize))):!1:!1}}else return!1;else{if(o instanceof O&&o.node.isInline)return Gt(r,new A(t>0?o.$to:o.$from));{let n=mn(r.state,t);return n?Gt(r,n):!1}}}function Jr(r){return r.nodeType==3?r.nodeValue.length:r.childNodes.length}function ar(r,t){let e=r.pmViewDesc;return e&&e.size==0&&(t<0||r.nextSibling||r.nodeName!="BR")}function $e(r,t){return t<0?yu(r):wu(r)}function yu(r){let t=r.domSelectionRange(),e=t.focusNode,o=t.focusOffset;if(!e)return;let n,i,s=!1;for(yt&&e.nodeType==1&&o<Jr(e)&&ar(e.childNodes[o],-1)&&(s=!0);;)if(o>0){if(e.nodeType!=1)break;{let l=e.childNodes[o-1];if(ar(l,-1))n=e,i=--o;else if(l.nodeType==3)e=l,o=e.nodeValue.length;else break}}else{if(Al(e))break;{let l=e.previousSibling;for(;l&&ar(l,-1);)n=e.parentNode,i=K(l),l=l.previousSibling;if(l)e=l,o=Jr(e);else{if(e=e.parentNode,e==r.dom)break;o=0}}}s?gn(r,e,o):n&&gn(r,n,i)}function wu(r){let t=r.domSelectionRange(),e=t.focusNode,o=t.focusOffset;if(!e)return;let n=Jr(e),i,s;for(;;)if(o<n){if(e.nodeType!=1)break;let l=e.childNodes[o];if(ar(l,1))i=e,s=++o;else break}else{if(Al(e))break;{let l=e.nextSibling;for(;l&&ar(l,1);)i=l.parentNode,s=K(l)+1,l=l.nextSibling;if(l)e=l,o=0,n=Jr(e);else{if(e=e.parentNode,e==r.dom)break;o=n=0}}}i&&gn(r,i,s)}function Al(r){let t=r.pmViewDesc;return t&&t.node&&t.node.isBlock}function vu(r,t){for(;r&&t==r.childNodes.length&&!or(r);)t=K(r)+1,r=r.parentNode;for(;r&&t<r.childNodes.length;){let e=r.childNodes[t];if(e.nodeType==3)return e;if(e.nodeType==1&&e.contentEditable=="false")break;r=e,t=0}}function bu(r,t){for(;r&&!t&&!or(r);)t=K(r),r=r.parentNode;for(;r&&t;){let e=r.childNodes[t-1];if(e.nodeType==3)return e;if(e.nodeType==1&&e.contentEditable=="false")break;r=e,t=r.childNodes.length}}function gn(r,t,e){if(t.nodeType!=3){let i,s;(s=vu(t,e))?(t=s,e=0):(i=bu(t,e))&&(t=i,e=i.nodeValue.length)}let o=r.domSelection();if(!o)return;if(Wr(o)){let i=document.createRange();i.setEnd(t,e),i.setStart(t,e),o.removeAllRanges(),o.addRange(i)}else o.extend&&o.extend(t,e);r.domObserver.setCurSelection();let{state:n}=r;setTimeout(()=>{r.state==n&&It(r)},50)}function Dl(r,t){let e=r.state.doc.resolve(t);if(!(X||Wp)&&e.parent.inlineContent){let o=r.coordsAtPos(t);if(t>e.start()){let n=r.coordsAtPos(t-1),i=(n.top+n.bottom)/2;if(i>o.top&&i<o.bottom&&Math.abs(n.left-o.left)>1)return n.left<o.left?"ltr":"rtl"}if(t<e.end()){let n=r.coordsAtPos(t+1),i=(n.top+n.bottom)/2;if(i>o.top&&i<o.bottom&&Math.abs(n.left-o.left)>1)return n.left>o.left?"ltr":"rtl"}}return getComputedStyle(r.dom).direction=="rtl"?"rtl":"ltr"}function El(r,t,e){let o=r.state.selection;if(o instanceof A&&!o.empty||e.indexOf("s")>-1||ct&&e.indexOf("m")>-1)return!1;let{$from:n,$to:i}=o;if(!n.parent.inlineContent||r.endOfTextblock(t<0?"up":"down")){let s=mn(r.state,t);if(s&&s instanceof O)return Gt(r,s)}if(!n.parent.inlineContent){let s=t<0?n:i,l=o instanceof st?D.near(s,t):D.findFrom(s,t);return l?Gt(r,l):!1}return!1}function Rl(r,t){if(!(r.state.selection instanceof A))return!0;let{$head:e,$anchor:o,empty:n}=r.state.selection;if(!e.sameParent(o))return!0;if(!n)return!1;if(r.endOfTextblock(t>0?"forward":"backward"))return!0;let i=!e.textOffset&&(t<0?e.nodeBefore:e.nodeAfter);if(i&&!i.isText){let s=r.state.tr;return t<0?s.delete(e.pos-i.nodeSize,e.pos):s.delete(e.pos,e.pos+i.nodeSize),r.dispatch(s),!0}return!1}function Pl(r,t,e){r.domObserver.stop(),t.contentEditable=e,r.domObserver.start()}function ku(r){if(!tt||r.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:e}=r.domSelectionRange();if(t&&t.nodeType==1&&e==0&&t.firstChild&&t.firstChild.contentEditable=="false"){let o=t.firstChild;Pl(r,o,"true"),setTimeout(()=>Pl(r,o,"false"),20)}return!1}function xu(r){let t="";return r.ctrlKey&&(t+="c"),r.metaKey&&(t+="m"),r.altKey&&(t+="a"),r.shiftKey&&(t+="s"),t}function Su(r,t){let e=t.keyCode,o=xu(t);if(e==8||ct&&e==72&&o=="c")return Rl(r,-1)||$e(r,-1);if(e==46&&!t.shiftKey||ct&&e==68&&o=="c")return Rl(r,1)||$e(r,1);if(e==13||e==27)return!0;if(e==37||ct&&e==66&&o=="c"){let n=e==37?Dl(r,r.state.selection.from)=="ltr"?-1:1:-1;return Tl(r,n,o)||$e(r,n)}else if(e==39||ct&&e==70&&o=="c"){let n=e==39?Dl(r,r.state.selection.from)=="ltr"?1:-1:1;return Tl(r,n,o)||$e(r,n)}else{if(e==38||ct&&e==80&&o=="c")return El(r,-1,o)||$e(r,-1);if(e==40||ct&&e==78&&o=="c")return ku(r)||El(r,1,o)||$e(r,1);if(o==(ct?"m":"c")&&(e==66||e==73||e==89||e==90))return!0}return!1}function yn(r,t){r.someProp("transformCopied",f=>{t=f(t,r)});let e=[],{content:o,openStart:n,openEnd:i}=t;for(;n>1&&i>1&&o.childCount==1&&o.firstChild.childCount==1;){n--,i--;let f=o.firstChild;e.push(f.type.name,f.attrs!=f.type.defaultAttrs?f.attrs:null),o=f.content}let s=r.someProp("clipboardSerializer")||$t.fromSchema(r.state.schema),l=jl(),a=l.createElement("div");a.appendChild(s.serializeFragment(o,{document:l}));let c=a.firstChild,h,d=0;for(;c&&c.nodeType==1&&(h=Ll[c.nodeName.toLowerCase()]);){for(let f=h.length-1;f>=0;f--){let u=l.createElement(h[f]);for(;a.firstChild;)u.appendChild(a.firstChild);a.appendChild(u),d++}c=a.firstChild}c&&c.nodeType==1&&c.setAttribute("data-pm-slice",`${n} ${i}${d?` -${d}`:""} ${JSON.stringify(e)}`);let p=r.someProp("clipboardTextSerializer",f=>f(t,r))||t.content.textBetween(0,t.content.size,`

`);return{dom:a,text:p,slice:t}}function Bl(r,t,e,o,n){let i=n.parent.type.spec.code,s,l;if(!e&&!t)return null;let a=t&&(o||i||!e);if(a){if(r.someProp("transformPastedText",p=>{t=p(t,i||o,r)}),i)return t?new v(w.from(r.state.schema.text(t.replace(/\r\n?/g,`
`))),0,0):v.empty;let d=r.someProp("clipboardTextParser",p=>p(t,n,o,r));if(d)l=d;else{let p=n.marks(),{schema:f}=r.state,u=$t.fromSchema(f);s=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(m=>{let g=s.appendChild(document.createElement("p"));m&&g.appendChild(u.serializeNode(f.text(m,p)))})}}else r.someProp("transformPastedHTML",d=>{e=d(e,r)}),s=Nu(e),nr&&Tu(s);let c=s&&s.querySelector("[data-pm-slice]"),h=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(h&&h[3])for(let d=+h[3];d>0;d--){let p=s.firstChild;for(;p&&p.nodeType!=1;)p=p.nextSibling;if(!p)break;s=p}if(l||(l=(r.someProp("clipboardParser")||r.someProp("domParser")||es.fromSchema(r.state.schema)).parseSlice(s,{preserveWhitespace:!!(a||h),context:n,ruleFromNode(d){return d.nodeName=="BR"&&!d.nextSibling&&d.parentNode&&!Mu.test(d.parentNode.nodeName)?{ignore:!0}:null}})),h)l=Au(Fl(l,+h[1],+h[2]),h[4]);else if(l=v.maxOpen(Cu(l.content,n),!0),l.openStart||l.openEnd){let d=0,p=0;for(let f=l.content.firstChild;d<l.openStart&&!f.type.spec.isolating;d++,f=f.firstChild);for(let f=l.content.lastChild;p<l.openEnd&&!f.type.spec.isolating;p++,f=f.lastChild);l=Fl(l,d,p)}return r.someProp("transformPasted",d=>{l=d(l,r)}),l}const Mu=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function Cu(r,t){if(r.childCount<2)return r;for(let e=t.depth;e>=0;e--){let o=t.node(e).contentMatchAt(t.index(e)),n,i=[];if(r.forEach(s=>{if(!i)return;let l=o.findWrapping(s.type),a;if(!l)return i=null;if(a=i.length&&n.length&&zl(l,n,s,i[i.length-1],0))i[i.length-1]=a;else{i.length&&(i[i.length-1]=$l(i[i.length-1],n.length));let c=Il(s,l);i.push(c),o=o.matchType(c.type),n=l}}),i)return w.from(i)}return r}function Il(r,t,e=0){for(let o=t.length-1;o>=e;o--)r=t[o].create(null,w.from(r));return r}function zl(r,t,e,o,n){if(n<r.length&&n<t.length&&r[n]==t[n]){let i=zl(r,t,e,o.lastChild,n+1);if(i)return o.copy(o.content.replaceChild(o.childCount-1,i));if(o.contentMatchAt(o.childCount).matchType(n==r.length-1?e.type:r[n+1]))return o.copy(o.content.append(w.from(Il(e,r,n+1))))}}function $l(r,t){if(t==0)return r;let e=r.content.replaceChild(r.childCount-1,$l(r.lastChild,t-1)),o=r.contentMatchAt(r.childCount).fillBefore(w.empty,!0);return r.copy(e.append(o))}function wn(r,t,e,o,n,i){let s=t<0?r.firstChild:r.lastChild,l=s.content;return r.childCount>1&&(i=0),n<o-1&&(l=wn(l,t,e,o,n+1,i)),n>=e&&(l=t<0?s.contentMatchAt(0).fillBefore(l,i<=n).append(l):l.append(s.contentMatchAt(s.childCount).fillBefore(w.empty,!0))),r.replaceChild(t<0?0:r.childCount-1,s.copy(l))}function Fl(r,t,e){return t<r.openStart&&(r=new v(wn(r.content,-1,t,r.openStart,0,r.openEnd),t,r.openEnd)),e<r.openEnd&&(r=new v(wn(r.content,1,e,r.openEnd,0,0),r.openStart,e)),r}const Ll={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let Vl=null;function jl(){return Vl||(Vl=document.implementation.createHTMLDocument("title"))}let vn=null;function Ou(r){let t=window.trustedTypes;return t?(vn||(vn=t.defaultPolicy||t.createPolicy("ProseMirrorClipboard",{createHTML:e=>e})),vn.createHTML(r)):r}function Nu(r){let t=/^(\s*<meta [^>]*>)*/.exec(r);t&&(r=r.slice(t[0].length));let e=jl().createElement("div"),o=/<([a-z][^>\s]+)/i.exec(r),n;if((n=o&&Ll[o[1].toLowerCase()])&&(r=n.map(i=>"<"+i+">").join("")+r+n.map(i=>"</"+i+">").reverse().join("")),e.innerHTML=Ou(r),n)for(let i=0;i<n.length;i++)e=e.querySelector(n[i])||e;return e}function Tu(r){let t=r.querySelectorAll(X?"span:not([class]):not([style])":"span.Apple-converted-space");for(let e=0;e<t.length;e++){let o=t[e];o.childNodes.length==1&&o.textContent=="\xA0"&&o.parentNode&&o.parentNode.replaceChild(r.ownerDocument.createTextNode(" "),o)}}function Au(r,t){if(!r.size)return r;let e=r.content.firstChild.type.schema,o;try{o=JSON.parse(t)}catch{return r}let{content:n,openStart:i,openEnd:s}=r;for(let l=o.length-2;l>=0;l-=2){let a=e.nodes[o[l]];if(!a||a.hasRequiredAttrs())break;n=w.from(a.create(o[l+1],n)),i++,s++}return new v(n,i,s)}const et={},rt={},Du={touchstart:!0,touchmove:!0};class Eu{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function Ru(r){for(let t in et){let e=et[t];r.dom.addEventListener(t,r.input.eventHandlers[t]=o=>{Bu(r,o)&&!kn(r,o)&&(r.editable||!(o.type in rt))&&e(r,o)},Du[t]?{passive:!0}:void 0)}tt&&r.dom.addEventListener("input",()=>null),bn(r)}function Xt(r,t){r.input.lastSelectionOrigin=t,r.input.lastSelectionTime=Date.now()}function Pu(r){r.domObserver.stop();for(let t in r.input.eventHandlers)r.dom.removeEventListener(t,r.input.eventHandlers[t]);clearTimeout(r.input.composingTimeout),clearTimeout(r.input.lastIOSEnterFallbackTimeout)}function bn(r){r.someProp("handleDOMEvents",t=>{for(let e in t)r.input.eventHandlers[e]||r.dom.addEventListener(e,r.input.eventHandlers[e]=o=>kn(r,o))})}function kn(r,t){return r.someProp("handleDOMEvents",e=>{let o=e[t.type];return o?o(r,t)||t.defaultPrevented:!1})}function Bu(r,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let e=t.target;e!=r.dom;e=e.parentNode)if(!e||e.nodeType==11||e.pmViewDesc&&e.pmViewDesc.stopEvent(t))return!1;return!0}function Iu(r,t){!kn(r,t)&&et[t.type]&&(r.editable||!(t.type in rt))&&et[t.type](r,t)}rt.keydown=(r,t)=>{let e=t;if(r.input.shiftKey=e.keyCode==16||e.shiftKey,!ql(r,e)&&(r.input.lastKeyCode=e.keyCode,r.input.lastKeyCodeTime=Date.now(),!(Pt&&X&&e.keyCode==13)))if(e.keyCode!=229&&r.domObserver.forceFlush(),Ie&&e.keyCode==13&&!e.ctrlKey&&!e.altKey&&!e.metaKey){let o=Date.now();r.input.lastIOSEnter=o,r.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{r.input.lastIOSEnter==o&&(r.someProp("handleKeyDown",n=>n(r,pe(13,"Enter"))),r.input.lastIOSEnter=0)},200)}else r.someProp("handleKeyDown",o=>o(r,e))||Su(r,e)?e.preventDefault():Xt(r,"key")},rt.keyup=(r,t)=>{t.keyCode==16&&(r.input.shiftKey=!1)},rt.keypress=(r,t)=>{let e=t;if(ql(r,e)||!e.charCode||e.ctrlKey&&!e.altKey||ct&&e.metaKey)return;if(r.someProp("handleKeyPress",n=>n(r,e))){e.preventDefault();return}let o=r.state.selection;if(!(o instanceof A)||!o.$from.sameParent(o.$to)){let n=String.fromCharCode(e.charCode);!/[\r\n]/.test(n)&&!r.someProp("handleTextInput",i=>i(r,o.$from.pos,o.$to.pos,n))&&r.dispatch(r.state.tr.insertText(n).scrollIntoView()),e.preventDefault()}};function Hr(r){return{left:r.clientX,top:r.clientY}}function zu(r,t){let e=t.x-r.clientX,o=t.y-r.clientY;return e*e+o*o<100}function xn(r,t,e,o,n){if(o==-1)return!1;let i=r.state.doc.resolve(o);for(let s=i.depth+1;s>0;s--)if(r.someProp(t,l=>s>i.depth?l(r,e,i.nodeAfter,i.before(s),n,!0):l(r,e,i.node(s),i.before(s),n,!1)))return!0;return!1}function Fe(r,t,e){if(r.focused||r.focus(),r.state.selection.eq(t))return;let o=r.state.tr.setSelection(t);o.setMeta("pointer",!0),r.dispatch(o)}function $u(r,t){if(t==-1)return!1;let e=r.state.doc.resolve(t),o=e.nodeAfter;return o&&o.isAtom&&O.isSelectable(o)?(Fe(r,new O(e)),!0):!1}function Fu(r,t){if(t==-1)return!1;let e=r.state.selection,o,n;e instanceof O&&(o=e.node);let i=r.state.doc.resolve(t);for(let s=i.depth+1;s>0;s--){let l=s>i.depth?i.nodeAfter:i.node(s);if(O.isSelectable(l)){o&&e.$from.depth>0&&s>=e.$from.depth&&i.before(e.$from.depth+1)==e.$from.pos?n=i.before(e.$from.depth):n=i.before(s);break}}return n!=null?(Fe(r,O.create(r.state.doc,n)),!0):!1}function Lu(r,t,e,o,n){return xn(r,"handleClickOn",t,e,o)||r.someProp("handleClick",i=>i(r,t,o))||(n?Fu(r,e):$u(r,e))}function Vu(r,t,e,o){return xn(r,"handleDoubleClickOn",t,e,o)||r.someProp("handleDoubleClick",n=>n(r,t,o))}function ju(r,t,e,o){return xn(r,"handleTripleClickOn",t,e,o)||r.someProp("handleTripleClick",n=>n(r,t,o))||Wu(r,e,o)}function Wu(r,t,e){if(e.button!=0)return!1;let o=r.state.doc;if(t==-1)return o.inlineContent?(Fe(r,A.create(o,0,o.content.size)),!0):!1;let n=o.resolve(t);for(let i=n.depth+1;i>0;i--){let s=i>n.depth?n.nodeAfter:n.node(i),l=n.before(i);if(s.inlineContent)Fe(r,A.create(o,l+1,l+1+s.content.size));else if(O.isSelectable(s))Fe(r,O.create(o,l));else continue;return!0}}function Sn(r){return Kr(r)}const Wl=ct?"metaKey":"ctrlKey";et.mousedown=(r,t)=>{let e=t;r.input.shiftKey=e.shiftKey;let o=Sn(r),n=Date.now(),i="singleClick";n-r.input.lastClick.time<500&&zu(e,r.input.lastClick)&&!e[Wl]&&r.input.lastClick.button==e.button&&(r.input.lastClick.type=="singleClick"?i="doubleClick":r.input.lastClick.type=="doubleClick"&&(i="tripleClick")),r.input.lastClick={time:n,x:e.clientX,y:e.clientY,type:i,button:e.button};let s=r.posAtCoords(Hr(e));s&&(i=="singleClick"?(r.input.mouseDown&&r.input.mouseDown.done(),r.input.mouseDown=new qu(r,s,e,!!o)):(i=="doubleClick"?Vu:ju)(r,s.pos,s.inside,e)?e.preventDefault():Xt(r,"pointer"))};class qu{constructor(t,e,o,n){this.view=t,this.pos=e,this.event=o,this.flushed=n,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=t.state.doc,this.selectNode=!!o[Wl],this.allowDefault=o.shiftKey;let i,s;if(e.inside>-1)i=t.state.doc.nodeAt(e.inside),s=e.inside;else{let h=t.state.doc.resolve(e.pos);i=h.parent,s=h.depth?h.before():0}const l=n?null:o.target,a=l?t.docView.nearestDesc(l,!0):null;this.target=a&&a.dom.nodeType==1?a.dom:null;let{selection:c}=t.state;(o.button==0&&i.type.spec.draggable&&i.type.spec.selectable!==!1||c instanceof O&&c.from<=s&&c.to>s)&&(this.mightDrag={node:i,pos:s,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&yt&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),Xt(t,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>It(this.view)),this.view.input.mouseDown=null}up(t){if(this.done(),!this.view.dom.contains(t.target))return;let e=this.pos;this.view.state.doc!=this.startDoc&&(e=this.view.posAtCoords(Hr(t))),this.updateAllowDefault(t),this.allowDefault||!e?Xt(this.view,"pointer"):Lu(this.view,e.pos,e.inside,t,this.selectNode)?t.preventDefault():t.button==0&&(this.flushed||tt&&this.mightDrag&&!this.mightDrag.node.isAtom||X&&!this.view.state.selection.visible&&Math.min(Math.abs(e.pos-this.view.state.selection.from),Math.abs(e.pos-this.view.state.selection.to))<=2)?(Fe(this.view,D.near(this.view.state.doc.resolve(e.pos))),t.preventDefault()):Xt(this.view,"pointer")}move(t){this.updateAllowDefault(t),Xt(this.view,"pointer"),t.buttons==0&&this.done()}updateAllowDefault(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0)}}et.touchstart=r=>{r.input.lastTouch=Date.now(),Sn(r),Xt(r,"pointer")},et.touchmove=r=>{r.input.lastTouch=Date.now(),Xt(r,"pointer")},et.contextmenu=r=>Sn(r);function ql(r,t){return r.composing?!0:tt&&Math.abs(t.timeStamp-r.input.compositionEndedAt)<500?(r.input.compositionEndedAt=-2e8,!0):!1}const Ju=Pt?5e3:-1;rt.compositionstart=rt.compositionupdate=r=>{if(!r.composing){r.domObserver.flush();let{state:t}=r,e=t.selection.$to;if(t.selection instanceof A&&(t.storedMarks||!e.textOffset&&e.parentOffset&&e.nodeBefore.marks.some(o=>o.type.spec.inclusive===!1)))r.markCursor=r.state.storedMarks||e.marks(),Kr(r,!0),r.markCursor=null;else if(Kr(r,!t.selection.empty),yt&&t.selection.empty&&e.parentOffset&&!e.textOffset&&e.nodeBefore.marks.length){let o=r.domSelectionRange();for(let n=o.focusNode,i=o.focusOffset;n&&n.nodeType==1&&i!=0;){let s=i<0?n.lastChild:n.childNodes[i-1];if(!s)break;if(s.nodeType==3){let l=r.domSelection();l&&l.collapse(s,s.nodeValue.length);break}else n=s,i=-1}}r.input.composing=!0}Jl(r,Ju)},rt.compositionend=(r,t)=>{r.composing&&(r.input.composing=!1,r.input.compositionEndedAt=t.timeStamp,r.input.compositionPendingChanges=r.domObserver.pendingRecords().length?r.input.compositionID:0,r.input.compositionNode=null,r.input.compositionPendingChanges&&Promise.resolve().then(()=>r.domObserver.flush()),r.input.compositionID++,Jl(r,20))};function Jl(r,t){clearTimeout(r.input.composingTimeout),t>-1&&(r.input.composingTimeout=setTimeout(()=>Kr(r),t))}function Hl(r){for(r.composing&&(r.input.composing=!1,r.input.compositionEndedAt=Ku());r.input.compositionNodes.length>0;)r.input.compositionNodes.pop().markParentsDirty()}function Hu(r){let t=r.domSelectionRange();if(!t.focusNode)return null;let e=$p(t.focusNode,t.focusOffset),o=Fp(t.focusNode,t.focusOffset);if(e&&o&&e!=o){let n=o.pmViewDesc,i=r.domObserver.lastChangedTextNode;if(e==i||o==i)return i;if(!n||!n.isText(o.nodeValue))return o;if(r.input.compositionNode==o){let s=e.pmViewDesc;if(!(!s||!s.isText(e.nodeValue)))return o}}return e||o}function Ku(){let r=document.createEvent("Event");return r.initEvent("event",!0,!0),r.timeStamp}function Kr(r,t=!1){if(!(Pt&&r.domObserver.flushingSoon>=0)){if(r.domObserver.forceFlush(),Hl(r),t||r.docView&&r.docView.dirty){let e=pn(r),o=r.state.selection;return e&&!e.eq(o)?r.dispatch(r.state.tr.setSelection(e)):(r.markCursor||t)&&!o.$from.node(o.$from.sharedDepth(o.to)).inlineContent?r.dispatch(r.state.tr.deleteSelection()):r.updateState(r.state),!0}return!1}}function Uu(r,t){if(!r.dom.parentNode)return;let e=r.dom.parentNode.appendChild(document.createElement("div"));e.appendChild(t),e.style.cssText="position: fixed; left: -10000px; top: 10px";let o=getSelection(),n=document.createRange();n.selectNodeContents(t),r.dom.blur(),o.removeAllRanges(),o.addRange(n),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e),r.focus()},50)}const cr=ot&&Ut<15||Ie&&qp<604;et.copy=rt.cut=(r,t)=>{let e=t,o=r.state.selection,n=e.type=="cut";if(o.empty)return;let i=cr?null:e.clipboardData,s=o.content(),{dom:l,text:a}=yn(r,s);i?(e.preventDefault(),i.clearData(),i.setData("text/html",l.innerHTML),i.setData("text/plain",a)):Uu(r,l),n&&r.dispatch(r.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function _u(r){return r.openStart==0&&r.openEnd==0&&r.content.childCount==1?r.content.firstChild:null}function Gu(r,t){if(!r.dom.parentNode)return;let e=r.input.shiftKey||r.state.selection.$from.parent.type.spec.code,o=r.dom.parentNode.appendChild(document.createElement(e?"textarea":"div"));e||(o.contentEditable="true"),o.style.cssText="position: fixed; left: -10000px; top: 10px",o.focus();let n=r.input.shiftKey&&r.input.lastKeyCode!=45;setTimeout(()=>{r.focus(),o.parentNode&&o.parentNode.removeChild(o),e?hr(r,o.value,null,n,t):hr(r,o.textContent,o.innerHTML,n,t)},50)}function hr(r,t,e,o,n){let i=Bl(r,t,e,o,r.state.selection.$from);if(r.someProp("handlePaste",a=>a(r,n,i||v.empty)))return!0;if(!i)return!1;let s=_u(i),l=s?r.state.tr.replaceSelectionWith(s,o):r.state.tr.replaceSelection(i);return r.dispatch(l.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function Kl(r){let t=r.getData("text/plain")||r.getData("Text");if(t)return t;let e=r.getData("text/uri-list");return e?e.replace(/\r?\n/g," "):""}rt.paste=(r,t)=>{let e=t;if(r.composing&&!Pt)return;let o=cr?null:e.clipboardData,n=r.input.shiftKey&&r.input.lastKeyCode!=45;o&&hr(r,Kl(o),o.getData("text/html"),n,e)?e.preventDefault():Gu(r,e)};class Ul{constructor(t,e,o){this.slice=t,this.move=e,this.node=o}}const Xu=ct?"altKey":"ctrlKey";function _l(r,t){return r.someProp("dragCopies",o=>!o(t))??!t[Xu]}et.dragstart=(r,t)=>{let e=t,o=r.input.mouseDown;if(o&&o.done(),!e.dataTransfer)return;let n=r.state.selection,i=n.empty?null:r.posAtCoords(Hr(e)),s;if(!(i&&i.pos>=n.from&&i.pos<=(n instanceof O?n.to-1:n.to))){if(o&&o.mightDrag)s=O.create(r.state.doc,o.mightDrag.pos);else if(e.target&&e.target.nodeType==1){let d=r.docView.nearestDesc(e.target,!0);d&&d.node.type.spec.draggable&&d!=r.docView&&(s=O.create(r.state.doc,d.posBefore))}}let l=(s||r.state.selection).content(),{dom:a,text:c,slice:h}=yn(r,l);(!e.dataTransfer.files.length||!X||tl>120)&&e.dataTransfer.clearData(),e.dataTransfer.setData(cr?"Text":"text/html",a.innerHTML),e.dataTransfer.effectAllowed="copyMove",cr||e.dataTransfer.setData("text/plain",c),r.dragging=new Ul(h,_l(r,e),s)},et.dragend=r=>{let t=r.dragging;window.setTimeout(()=>{r.dragging==t&&(r.dragging=null)},50)},rt.dragover=rt.dragenter=(r,t)=>t.preventDefault(),rt.drop=(r,t)=>{let e=t,o=r.dragging;if(r.dragging=null,!e.dataTransfer)return;let n=r.posAtCoords(Hr(e));if(!n)return;let i=r.state.doc.resolve(n.pos),s=o&&o.slice;s?r.someProp("transformPasted",u=>{s=u(s,r)}):s=Bl(r,Kl(e.dataTransfer),cr?null:e.dataTransfer.getData("text/html"),!1,i);let l=!!(o&&_l(r,e));if(r.someProp("handleDrop",u=>u(r,e,s||v.empty,l))){e.preventDefault();return}if(!s)return;e.preventDefault();let a=s?Gd(r.state.doc,i.pos,s):i.pos;a==null&&(a=i.pos);let c=r.state.tr;if(l){let{node:u}=o;u?u.replace(c):c.deleteSelection()}let h=c.mapping.map(a),d=s.openStart==0&&s.openEnd==0&&s.content.childCount==1,p=c.doc;if(d?c.replaceRangeWith(h,h,s.content.firstChild):c.replaceRange(h,h,s),c.doc.eq(p))return;let f=c.doc.resolve(h);if(d&&O.isSelectable(s.content.firstChild)&&f.nodeAfter&&f.nodeAfter.sameMarkup(s.content.firstChild))c.setSelection(new O(f));else{let u=c.mapping.map(a);c.mapping.maps[c.mapping.maps.length-1].forEach((m,g,y,k)=>u=k),c.setSelection(fn(r,f,c.doc.resolve(u)))}r.focus(),r.dispatch(c.setMeta("uiEvent","drop"))},et.focus=r=>{r.input.lastFocus=Date.now(),r.focused||(r.domObserver.stop(),r.dom.classList.add("ProseMirror-focused"),r.domObserver.start(),r.focused=!0,setTimeout(()=>{r.docView&&r.hasFocus()&&!r.domObserver.currentSelection.eq(r.domSelectionRange())&&It(r)},20))},et.blur=(r,t)=>{let e=t;r.focused&&(r.domObserver.stop(),r.dom.classList.remove("ProseMirror-focused"),r.domObserver.start(),e.relatedTarget&&r.dom.contains(e.relatedTarget)&&r.domObserver.currentSelection.clear(),r.focused=!1)},et.beforeinput=(r,t)=>{if(X&&Pt&&t.inputType=="deleteContentBackward"){r.domObserver.flushSoon();let{domChangeCount:e}=r.input;setTimeout(()=>{if(r.input.domChangeCount!=e||(r.dom.blur(),r.focus(),r.someProp("handleKeyDown",n=>n(r,pe(8,"Backspace")))))return;let{$cursor:o}=r.state.selection;o&&o.pos>0&&r.dispatch(r.state.tr.delete(o.pos-1,o.pos).scrollIntoView())},50)}};for(let r in rt)et[r]=rt[r];function dr(r,t){if(r==t)return!0;for(let e in r)if(r[e]!==t[e])return!1;for(let e in t)if(!(e in r))return!1;return!0}class so{constructor(t,e){this.toDOM=t,this.spec=e||me,this.side=this.spec.side||0}map(t,e,o,n){let{pos:i,deleted:s}=t.mapResult(e.from+n,this.side<0?-1:1);return s?null:new dt(i-o,i-o,this)}valid(){return!0}eq(t){return this==t||t instanceof so&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&dr(this.spec,t.spec))}destroy(t){this.spec.destroy&&this.spec.destroy(t)}}class te{constructor(t,e){this.attrs=t,this.spec=e||me}map(t,e,o,n){let i=t.map(e.from+n,this.spec.inclusiveStart?-1:1)-o,s=t.map(e.to+n,this.spec.inclusiveEnd?1:-1)-o;return i>=s?null:new dt(i,s,this)}valid(t,e){return e.from<e.to}eq(t){return this==t||t instanceof te&&dr(this.attrs,t.attrs)&&dr(this.spec,t.spec)}static is(t){return t.type instanceof te}destroy(){}}class Un{constructor(t,e){this.attrs=t,this.spec=e||me}map(t,e,o,n){let i=t.mapResult(e.from+n,1);if(i.deleted)return null;let s=t.mapResult(e.to+n,-1);return s.deleted||s.pos<=i.pos?null:new dt(i.pos-o,s.pos-o,this)}valid(t,e){let{index:o,offset:n}=t.content.findIndex(e.from),i;return n==e.from&&!(i=t.child(o)).isText&&n+i.nodeSize==e.to}eq(t){return this==t||t instanceof Un&&dr(this.attrs,t.attrs)&&dr(this.spec,t.spec)}destroy(){}}class dt{constructor(t,e,o){this.from=t,this.to=e,this.type=o}copy(t,e){return new dt(t,e,this.type)}eq(t,e=0){return this.type.eq(t.type)&&this.from+e==t.from&&this.to+e==t.to}map(t,e,o){return this.type.map(t,this,e,o)}static widget(t,e,o){return new dt(t,t,new so(e,o))}static inline(t,e,o,n){return new dt(t,e,new te(o,n))}static node(t,e,o,n){return new dt(t,e,new Un(o,n))}get spec(){return this.type.spec}get inline(){return this.type instanceof te}get widget(){return this.type instanceof so}}const Le=[],me={};class L{constructor(t,e){this.local=t.length?t:Le,this.children=e.length?e:Le}static create(t,e){return e.length?Ur(e,t,0,me):Y}find(t,e,o){let n=[];return this.findInner(t??0,e??1e9,n,0,o),n}findInner(t,e,o,n,i){for(let s=0;s<this.local.length;s++){let l=this.local[s];l.from<=e&&l.to>=t&&(!i||i(l.spec))&&o.push(l.copy(l.from+n,l.to+n))}for(let s=0;s<this.children.length;s+=3)if(this.children[s]<e&&this.children[s+1]>t){let l=this.children[s]+1;this.children[s+2].findInner(t-l,e-l,o,n+l,i)}}map(t,e,o){return this==Y||t.maps.length==0?this:this.mapInner(t,e,0,0,o||me)}mapInner(t,e,o,n,i){let s;for(let l=0;l<this.local.length;l++){let a=this.local[l].map(t,o,n);a&&a.type.valid(e,a)?(s||(s=[])).push(a):i.onRemove&&i.onRemove(this.local[l].spec)}return this.children.length?Yu(this.children,s||[],t,e,o,n,i):s?new L(s.sort(ge),Le):Y}add(t,e){return e.length?this==Y?L.create(t,e):this.addInner(t,e,0):this}addInner(t,e,o){let n,i=0;t.forEach((l,a)=>{let c=a+o,h;if(h=Xl(e,l,c)){for(n||(n=this.children.slice());i<n.length&&n[i]<a;)i+=3;n[i]==a?n[i+2]=n[i+2].addInner(l,h,c+1):n.splice(i,0,a,a+l.nodeSize,Ur(h,l,c+1,me)),i+=3}});let s=Gl(i?Yl(e):e,-o);for(let l=0;l<s.length;l++)s[l].type.valid(t,s[l])||s.splice(l--,1);return new L(s.length?this.local.concat(s).sort(ge):this.local,n||this.children)}remove(t){return t.length==0||this==Y?this:this.removeInner(t,0)}removeInner(t,e){let o=this.children,n=this.local;for(let i=0;i<o.length;i+=3){let s,l=o[i]+e,a=o[i+1]+e;for(let h=0,d;h<t.length;h++)(d=t[h])&&d.from>l&&d.to<a&&(t[h]=null,(s||(s=[])).push(d));if(!s)continue;o==this.children&&(o=this.children.slice());let c=o[i+2].removeInner(s,l+1);c!=Y?o[i+2]=c:(o.splice(i,3),i-=3)}if(n.length){for(let i=0,s;i<t.length;i++)if(s=t[i])for(let l=0;l<n.length;l++)n[l].eq(s,e)&&(n==this.local&&(n=this.local.slice()),n.splice(l--,1))}return o==this.children&&n==this.local?this:n.length||o.length?new L(n,o):Y}forChild(t,e){if(this==Y)return this;if(e.isLeaf)return L.empty;let o,n;for(let l=0;l<this.children.length;l+=3)if(this.children[l]>=t){this.children[l]==t&&(o=this.children[l+2]);break}let i=t+1,s=i+e.content.size;for(let l=0;l<this.local.length;l++){let a=this.local[l];if(a.from<s&&a.to>i&&a.type instanceof te){let c=Math.max(i,a.from)-i,h=Math.min(s,a.to)-i;c<h&&(n||(n=[])).push(a.copy(c,h))}}if(n){let l=new L(n.sort(ge),Le);return o?new ee([l,o]):l}return o||Y}eq(t){if(this==t)return!0;if(!(t instanceof L)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(let e=0;e<this.local.length;e++)if(!this.local[e].eq(t.local[e]))return!1;for(let e=0;e<this.children.length;e+=3)if(this.children[e]!=t.children[e]||this.children[e+1]!=t.children[e+1]||!this.children[e+2].eq(t.children[e+2]))return!1;return!0}locals(t){return Mn(this.localsInner(t))}localsInner(t){if(this==Y)return Le;if(t.inlineContent||!this.local.some(te.is))return this.local;let e=[];for(let o=0;o<this.local.length;o++)this.local[o].type instanceof te||e.push(this.local[o]);return e}forEachSet(t){t(this)}}L.empty=new L([],[]),L.removeOverlap=Mn;const Y=L.empty;class ee{constructor(t){this.members=t}map(t,e){const o=this.members.map(n=>n.map(t,e,me));return ee.from(o)}forChild(t,e){if(e.isLeaf)return L.empty;let o=[];for(let n=0;n<this.members.length;n++){let i=this.members[n].forChild(t,e);i!=Y&&(i instanceof ee?o=o.concat(i.members):o.push(i))}return ee.from(o)}eq(t){if(!(t instanceof ee)||t.members.length!=this.members.length)return!1;for(let e=0;e<this.members.length;e++)if(!this.members[e].eq(t.members[e]))return!1;return!0}locals(t){let e,o=!0;for(let n=0;n<this.members.length;n++){let i=this.members[n].localsInner(t);if(i.length)if(!e)e=i;else{o&&(e=e.slice(),o=!1);for(let s=0;s<i.length;s++)e.push(i[s])}}return e?Mn(o?e:e.sort(ge)):Le}static from(t){switch(t.length){case 0:return Y;case 1:return t[0];default:return new ee(t.every(e=>e instanceof L)?t:t.reduce((e,o)=>e.concat(o instanceof L?o:o.members),[]))}}forEachSet(t){for(let e=0;e<this.members.length;e++)this.members[e].forEachSet(t)}}function Yu(r,t,e,o,n,i,s){let l=r.slice();for(let c=0,h=i;c<e.maps.length;c++){let d=0;e.maps[c].forEach((p,f,u,m)=>{let g=m-u-(f-p);for(let y=0;y<l.length;y+=3){let k=l[y+1];if(k<0||p>k+h-d)continue;let x=l[y]+h-d;f>=x?l[y+1]=p<=x?-2:-1:p>=h&&g&&(l[y]+=g,l[y+1]+=g)}d+=g}),h=e.maps[c].map(h,-1)}let a=!1;for(let c=0;c<l.length;c+=3)if(l[c+1]<0){if(l[c+1]==-2){a=!0,l[c+1]=-1;continue}let h=e.map(r[c]+i),d=h-n;if(d<0||d>=o.content.size){a=!0;continue}let p=e.map(r[c+1]+i,-1),f=p-n,{index:u,offset:m}=o.content.findIndex(d),g=o.maybeChild(u);if(g&&m==d&&m+g.nodeSize==f){let y=l[c+2].mapInner(e,g,h+1,r[c]+i+1,s);y!=Y?(l[c]=d,l[c+1]=f,l[c+2]=y):(l[c+1]=-2,a=!0)}else a=!0}if(a){let c=Zu(l,r,t,e,n,i,s),h=Ur(c,o,0,s);t=h.local;for(let d=0;d<l.length;d+=3)l[d+1]<0&&(l.splice(d,3),d-=3);for(let d=0,p=0;d<h.children.length;d+=3){let f=h.children[d];for(;p<l.length&&l[p]<f;)p+=3;l.splice(p,0,h.children[d],h.children[d+1],h.children[d+2])}}return new L(t.sort(ge),l)}function Gl(r,t){if(!t||!r.length)return r;let e=[];for(let o=0;o<r.length;o++){let n=r[o];e.push(new dt(n.from+t,n.to+t,n.type))}return e}function Zu(r,t,e,o,n,i,s){function l(a,c){for(let h=0;h<a.local.length;h++){let d=a.local[h].map(o,n,c);d?e.push(d):s.onRemove&&s.onRemove(a.local[h].spec)}for(let h=0;h<a.children.length;h+=3)l(a.children[h+2],a.children[h]+c+1)}for(let a=0;a<r.length;a+=3)r[a+1]==-1&&l(r[a+2],t[a]+i+1);return e}function Xl(r,t,e){if(t.isLeaf)return null;let o=e+t.nodeSize,n=null;for(let i=0,s;i<r.length;i++)(s=r[i])&&s.from>e&&s.to<o&&((n||(n=[])).push(s),r[i]=null);return n}function Yl(r){let t=[];for(let e=0;e<r.length;e++)r[e]!=null&&t.push(r[e]);return t}function Ur(r,t,e,o){let n=[],i=!1;t.forEach((l,a)=>{let c=Xl(r,l,a+e);if(c){i=!0;let h=Ur(c,l,e+a+1,o);h!=Y&&n.push(a,a+l.nodeSize,h)}});let s=Gl(i?Yl(r):r,-e).sort(ge);for(let l=0;l<s.length;l++)s[l].type.valid(t,s[l])||(o.onRemove&&o.onRemove(s[l].spec),s.splice(l--,1));return s.length||n.length?new L(s,n):Y}function ge(r,t){return r.from-t.from||r.to-t.to}function Mn(r){let t=r;for(let e=0;e<t.length-1;e++){let o=t[e];if(o.from!=o.to)for(let n=e+1;n<t.length;n++){let i=t[n];if(i.from==o.from){i.to!=o.to&&(t==r&&(t=r.slice()),t[n]=i.copy(i.from,o.to),Zl(t,n+1,i.copy(o.to,i.to)));continue}else{i.from<o.to&&(t==r&&(t=r.slice()),t[e]=o.copy(o.from,i.from),Zl(t,n,o.copy(i.from,o.to)));break}}}return t}function Zl(r,t,e){for(;t<r.length&&ge(e,r[t])>0;)t++;r.splice(t,0,e)}function Cn(r){let t=[];return r.someProp("decorations",e=>{let o=e(r.state);o&&o!=Y&&t.push(o)}),r.cursorWrapper&&t.push(L.create(r.state.doc,[r.cursorWrapper.deco])),ee.from(t)}const Qu={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},tf=ot&&Ut<=11;class ef{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset}}class rf{constructor(t,e){this.view=t,this.handleDOMChange=e,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new ef,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(o=>{for(let n=0;n<o.length;n++)this.queue.push(o[n]);ot&&Ut<=11&&o.some(n=>n.type=="childList"&&n.removedNodes.length||n.type=="characterData"&&n.oldValue.length>n.target.nodeValue.length)?this.flushSoon():this.flush()}),tf&&(this.onCharData=o=>{this.queue.push({target:o.target,type:"characterData",oldValue:o.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,Qu)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let t=this.observer.takeRecords();if(t.length){for(let e=0;e<t.length;e++)this.queue.push(t[e]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(Ol(this.view)){if(this.suppressingSelectionUpdates)return It(this.view);if(ot&&Ut<=11&&!this.view.state.selection.empty){let t=this.view.domSelectionRange();if(t.focusNode&&de(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(t){if(!t.focusNode)return!0;let e=new Set,o;for(let i=t.focusNode;i;i=Be(i))e.add(i);for(let i=t.anchorNode;i;i=Be(i))if(e.has(i)){o=i;break}let n=o&&this.view.docView.nearestDesc(o);if(n&&n.ignoreMutation({type:"selection",target:o.nodeType==3?o.parentNode:o}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}flush(){let{view:t}=this;if(!t.docView||this.flushingSoon>-1)return;let e=this.pendingRecords();e.length&&(this.queue=[]);let o=t.domSelectionRange(),n=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(o)&&Ol(t)&&!this.ignoreSelectionChange(o),i=-1,s=-1,l=!1,a=[];if(t.editable)for(let h=0;h<e.length;h++){let d=this.registerMutation(e[h],a);d&&(i=i<0?d.from:Math.min(d.from,i),s=s<0?d.to:Math.max(d.to,s),d.typeOver&&(l=!0))}if(yt&&a.length){let h=a.filter(d=>d.nodeName=="BR");if(h.length==2){let[d,p]=h;d.parentNode&&d.parentNode.parentNode==p.parentNode?p.remove():d.remove()}else{let{focusNode:d}=this.currentSelection;for(let p of h){let f=p.parentNode;f&&f.nodeName=="LI"&&(!d||sf(t,d)!=f)&&p.remove()}}}let c=null;i<0&&n&&t.input.lastFocus>Date.now()-200&&Math.max(t.input.lastTouch,t.input.lastClick.time)<Date.now()-300&&Wr(o)&&(c=pn(t))&&c.eq(D.near(t.state.doc.resolve(0),1))?(t.input.lastFocus=0,It(t),this.currentSelection.set(o),t.scrollToSelection()):(i>-1||n)&&(i>-1&&(t.docView.markDirty(i,s),of(t)),this.handleDOMChange(i,s,l,a),t.docView&&t.docView.dirty?t.updateState(t.state):this.currentSelection.eq(o)||It(t),this.currentSelection.set(o))}registerMutation(t,e){if(e.indexOf(t.target)>-1)return null;let o=this.view.docView.nearestDesc(t.target);if(t.type=="attributes"&&(o==this.view.docView||t.attributeName=="contenteditable"||t.attributeName=="style"&&!t.oldValue&&!t.target.getAttribute("style"))||!o||o.ignoreMutation(t))return null;if(t.type=="childList"){for(let h=0;h<t.addedNodes.length;h++){let d=t.addedNodes[h];e.push(d),d.nodeType==3&&(this.lastChangedTextNode=d)}if(o.contentDOM&&o.contentDOM!=o.dom&&!o.contentDOM.contains(t.target))return{from:o.posBefore,to:o.posAfter};let n=t.previousSibling,i=t.nextSibling;if(ot&&Ut<=11&&t.addedNodes.length)for(let h=0;h<t.addedNodes.length;h++){let{previousSibling:d,nextSibling:p}=t.addedNodes[h];(!d||Array.prototype.indexOf.call(t.addedNodes,d)<0)&&(n=d),(!p||Array.prototype.indexOf.call(t.addedNodes,p)<0)&&(i=p)}let s=n&&n.parentNode==t.target?K(n)+1:0,l=o.localPosFromDOM(t.target,s,-1),a=i&&i.parentNode==t.target?K(i):t.target.childNodes.length,c=o.localPosFromDOM(t.target,a,1);return{from:l,to:c}}else return t.type=="attributes"?{from:o.posAtStart-o.border,to:o.posAtEnd+o.border}:(this.lastChangedTextNode=t.target,{from:o.posAtStart,to:o.posAtEnd,typeOver:t.target.nodeValue==t.oldValue})}}let Ql=new WeakMap,ta=!1;function of(r){if(!Ql.has(r)&&(Ql.set(r,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(r.dom).whiteSpace)!==-1)){if(r.requiresGeckoHackNode=yt,ta)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),ta=!0}}function ea(r,t){let e=t.startContainer,o=t.startOffset,n=t.endContainer,i=t.endOffset,s=r.domAtPos(r.state.selection.anchor);return de(s.node,s.offset,n,i)&&([e,o,n,i]=[n,i,e,o]),{anchorNode:e,anchorOffset:o,focusNode:n,focusOffset:i}}function nf(r,t){if(t.getComposedRanges){let n=t.getComposedRanges(r.root)[0];if(n)return ea(r,n)}let e;function o(n){n.preventDefault(),n.stopImmediatePropagation(),e=n.getTargetRanges()[0]}return r.dom.addEventListener("beforeinput",o,!0),document.execCommand("indent"),r.dom.removeEventListener("beforeinput",o,!0),e?ea(r,e):null}function sf(r,t){for(let e=t.parentNode;e&&e!=r.dom;e=e.parentNode){let o=r.docView.nearestDesc(e,!0);if(o&&o.node.isBlock)return e}return null}function lf(r,t,e){let{node:o,fromOffset:n,toOffset:i,from:s,to:l}=r.docView.parseRange(t,e),a=r.domSelectionRange(),c,h=a.anchorNode;if(h&&r.dom.contains(h.nodeType==1?h:h.parentNode)&&(c=[{node:h,offset:a.anchorOffset}],Wr(a)||c.push({node:a.focusNode,offset:a.focusOffset})),X&&r.input.lastKeyCode===8)for(let g=i;g>n;g--){let y=o.childNodes[g-1],k=y.pmViewDesc;if(y.nodeName=="BR"&&!k){i=g;break}if(!k||k.size)break}let d=r.state.doc,p=r.someProp("domParser")||es.fromSchema(r.state.schema),f=d.resolve(s),u=null,m=p.parse(o,{topNode:f.parent,topMatch:f.parent.contentMatchAt(f.index()),topOpen:!0,from:n,to:i,preserveWhitespace:f.parent.type.whitespace=="pre"?"full":!0,findPositions:c,ruleFromNode:af,context:f});if(c&&c[0].pos!=null){let g=c[0].pos,y=c[1]&&c[1].pos;y==null&&(y=g),u={anchor:g+s,head:y+s}}return{doc:m,sel:u,from:s,to:l}}function af(r){let t=r.pmViewDesc;if(t)return t.parseRule();if(r.nodeName=="BR"&&r.parentNode){if(tt&&/^(ul|ol)$/i.test(r.parentNode.nodeName)){let e=document.createElement("div");return e.appendChild(document.createElement("li")),{skip:e}}else if(r.parentNode.lastChild==r||tt&&/^(tr|table)$/i.test(r.parentNode.nodeName))return{ignore:!0}}else if(r.nodeName=="IMG"&&r.getAttribute("mark-placeholder"))return{ignore:!0};return null}const cf=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function hf(r,t,e,o,n){let i=r.input.compositionPendingChanges||(r.composing?r.input.compositionID:0);if(r.input.compositionPendingChanges=0,t<0){let M=r.input.lastSelectionTime>Date.now()-50?r.input.lastSelectionOrigin:null,R=pn(r,M);if(R&&!r.state.selection.eq(R)){if(X&&Pt&&r.input.lastKeyCode===13&&Date.now()-100<r.input.lastKeyCodeTime&&r.someProp("handleKeyDown",Z=>Z(r,pe(13,"Enter"))))return;let W=r.state.tr.setSelection(R);M=="pointer"?W.setMeta("pointer",!0):M=="key"&&W.scrollIntoView(),i&&W.setMeta("composition",i),r.dispatch(W)}return}let s=r.state.doc.resolve(t),l=s.sharedDepth(e);t=s.before(l+1),e=r.state.doc.resolve(e).after(l+1);let a=r.state.selection,c=lf(r,t,e),h=r.state.doc,d=h.slice(c.from,c.to),p,f;r.input.lastKeyCode===8&&Date.now()-100<r.input.lastKeyCodeTime?(p=r.state.selection.to,f="end"):(p=r.state.selection.from,f="start"),r.input.lastKeyCode=null;let u=uf(d.content,c.doc.content,c.from,p,f);if(u&&r.input.domChangeCount++,(Ie&&r.input.lastIOSEnter>Date.now()-225||Pt)&&n.some(M=>M.nodeType==1&&!cf.test(M.nodeName))&&(!u||u.endA>=u.endB)&&r.someProp("handleKeyDown",M=>M(r,pe(13,"Enter")))){r.input.lastIOSEnter=0;return}if(!u)if(o&&a instanceof A&&!a.empty&&a.$head.sameParent(a.$anchor)&&!r.composing&&!(c.sel&&c.sel.anchor!=c.sel.head))u={start:a.from,endA:a.to,endB:a.to};else{if(c.sel){let M=ra(r,r.state.doc,c.sel);if(M&&!M.eq(r.state.selection)){let R=r.state.tr.setSelection(M);i&&R.setMeta("composition",i),r.dispatch(R)}}return}r.state.selection.from<r.state.selection.to&&u.start==u.endB&&r.state.selection instanceof A&&(u.start>r.state.selection.from&&u.start<=r.state.selection.from+2&&r.state.selection.from>=c.from?u.start=r.state.selection.from:u.endA<r.state.selection.to&&u.endA>=r.state.selection.to-2&&r.state.selection.to<=c.to&&(u.endB+=r.state.selection.to-u.endA,u.endA=r.state.selection.to)),ot&&Ut<=11&&u.endB==u.start+1&&u.endA==u.start&&u.start>c.from&&c.doc.textBetween(u.start-c.from-1,u.start-c.from+1)==" \xA0"&&(u.start--,u.endA--,u.endB--);let m=c.doc.resolveNoCache(u.start-c.from),g=c.doc.resolveNoCache(u.endB-c.from),y=h.resolve(u.start),k=m.sameParent(g)&&m.parent.inlineContent&&y.end()>=u.endA,x;if((Ie&&r.input.lastIOSEnter>Date.now()-225&&(!k||n.some(M=>M.nodeName=="DIV"||M.nodeName=="P"))||!k&&m.pos<c.doc.content.size&&(!m.sameParent(g)||!m.parent.inlineContent)&&!/\S/.test(c.doc.textBetween(m.pos,g.pos,"",""))&&(x=D.findFrom(c.doc.resolve(m.pos+1),1,!0))&&x.head>m.pos)&&r.someProp("handleKeyDown",M=>M(r,pe(13,"Enter")))){r.input.lastIOSEnter=0;return}if(r.state.selection.anchor>u.start&&pf(h,u.start,u.endA,m,g)&&r.someProp("handleKeyDown",M=>M(r,pe(8,"Backspace")))){Pt&&X&&r.domObserver.suppressSelectionUpdates();return}X&&u.endB==u.start&&(r.input.lastChromeDelete=Date.now()),Pt&&!k&&m.start()!=g.start()&&g.parentOffset==0&&m.depth==g.depth&&c.sel&&c.sel.anchor==c.sel.head&&c.sel.head==u.endA&&(u.endB-=2,g=c.doc.resolveNoCache(u.endB-c.from),setTimeout(()=>{r.someProp("handleKeyDown",function(M){return M(r,pe(13,"Enter"))})},20));let b=u.start,C=u.endA,T,j,B;if(k){if(m.pos==g.pos)ot&&Ut<=11&&m.parentOffset==0&&(r.domObserver.suppressSelectionUpdates(),setTimeout(()=>It(r),20)),T=r.state.tr.delete(b,C),j=h.resolve(u.start).marksAcross(h.resolve(u.endA));else if(u.endA==u.endB&&(B=df(m.parent.content.cut(m.parentOffset,g.parentOffset),y.parent.content.cut(y.parentOffset,u.endA-y.start()))))T=r.state.tr,B.type=="add"?T.addMark(b,C,B.mark):T.removeMark(b,C,B.mark);else if(m.parent.child(m.index()).isText&&m.index()==g.index()-(g.textOffset?0:1)){let M=m.parent.textBetween(m.parentOffset,g.parentOffset);if(r.someProp("handleTextInput",R=>R(r,b,C,M)))return;T=r.state.tr.insertText(M,b,C)}}if(T||(T=r.state.tr.replace(b,C,c.doc.slice(u.start-c.from,u.endB-c.from))),c.sel){let M=ra(r,T.doc,c.sel);M&&!(X&&r.composing&&M.empty&&(u.start!=u.endB||r.input.lastChromeDelete<Date.now()-100)&&(M.head==b||M.head==T.mapping.map(C)-1)||ot&&M.empty&&M.head==b)&&T.setSelection(M)}j&&T.ensureMarks(j),i&&T.setMeta("composition",i),r.dispatch(T.scrollIntoView())}function ra(r,t,e){return Math.max(e.anchor,e.head)>t.content.size?null:fn(r,t.resolve(e.anchor),t.resolve(e.head))}function df(r,t){let e=r.firstChild.marks,o=t.firstChild.marks,n=e,i=o,s,l,a;for(let h=0;h<o.length;h++)n=o[h].removeFromSet(n);for(let h=0;h<e.length;h++)i=e[h].removeFromSet(i);if(n.length==1&&i.length==0)l=n[0],s="add",a=h=>h.mark(l.addToSet(h.marks));else if(n.length==0&&i.length==1)l=i[0],s="remove",a=h=>h.mark(l.removeFromSet(h.marks));else return null;let c=[];for(let h=0;h<t.childCount;h++)c.push(a(t.child(h)));if(w.from(c).eq(r))return{mark:l,type:s}}function pf(r,t,e,o,n){if(e-t<=n.pos-o.pos||On(o,!0,!1)<n.pos)return!1;let i=r.resolve(t);if(!o.parent.isTextblock){let l=i.nodeAfter;return l!=null&&e==t+l.nodeSize}if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;let s=r.resolve(On(i,!0,!0));return!s.parent.isTextblock||s.pos>e||On(s,!0,!1)<e?!1:o.parent.content.cut(o.parentOffset).eq(s.parent.content)}function On(r,t,e){let o=r.depth,n=t?r.end():r.pos;for(;o>0&&(t||r.indexAfter(o)==r.node(o).childCount);)o--,n++,t=!1;if(e){let i=r.node(o).maybeChild(r.indexAfter(o));for(;i&&!i.isLeaf;)i=i.firstChild,n++}return n}function uf(r,t,e,o,n){let i=r.findDiffStart(t,e);if(i==null)return null;let{a:s,b:l}=r.findDiffEnd(t,e+r.size,e+t.size);if(n=="end"){let a=Math.max(0,i-Math.min(s,l));o-=s+a-i}if(s<i&&r.size<t.size){let a=o<=i&&o>=s?i-o:0;i-=a,i&&i<t.size&&oa(t.textBetween(i-1,i+1))&&(i+=a?1:-1),l=i+(l-s),s=i}else if(l<i){let a=o<=i&&o>=l?i-o:0;i-=a,i&&i<r.size&&oa(r.textBetween(i-1,i+1))&&(i+=a?1:-1),s=i+(s-l),l=i}return{start:i,endA:s,endB:l}}function oa(r){if(r.length!=2)return!1;let t=r.charCodeAt(0),e=r.charCodeAt(1);return t>=56320&&t<=57343&&e>=55296&&e<=56319}class ff{constructor(t,e){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new Eu,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=e,this.state=e.state,this.directPlugins=e.plugins||[],this.directPlugins.forEach(aa),this.dispatch=this.dispatch.bind(this),this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):typeof t=="function"?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=sa(this),ia(this),this.nodeViews=la(this),this.docView=fl(this.state.doc,na(this),Cn(this),this.dom,this),this.domObserver=new rf(this,(o,n,i,s)=>hf(this,o,n,i,s)),this.domObserver.start(),Ru(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let t=this._props;this._props={};for(let e in t)this._props[e]=t[e];this._props.state=this.state}return this._props}update(t){t.handleDOMEvents!=this._props.handleDOMEvents&&bn(this);let e=this._props;this._props=t,t.plugins&&(t.plugins.forEach(aa),this.directPlugins=t.plugins),this.updateStateInner(t.state,e)}setProps(t){let e={};for(let o in this._props)e[o]=this._props[o];e.state=this.state;for(let o in t)e[o]=t[o];this.update(e)}updateState(t){this.updateStateInner(t,this._props)}updateStateInner(t,e){var o;let n=this.state,i=!1,s=!1;t.storedMarks&&this.composing&&(Hl(this),s=!0),this.state=t;let l=n.plugins!=t.plugins||this._props.plugins!=e.plugins;if(l||this._props.plugins!=e.plugins||this._props.nodeViews!=e.nodeViews){let f=la(this);gf(f,this.nodeViews)&&(this.nodeViews=f,i=!0)}(l||e.handleDOMEvents!=this._props.handleDOMEvents)&&bn(this),this.editable=sa(this),ia(this);let a=Cn(this),c=na(this),h=n.plugins!=t.plugins&&!n.doc.eq(t.doc)?"reset":t.scrollToSelection>n.scrollToSelection?"to selection":"preserve",d=i||!this.docView.matchesNode(t.doc,c,a);(d||!t.selection.eq(n.selection))&&(s=!0);let p=h=="preserve"&&s&&this.dom.style.overflowAnchor==null&&Kp(this);if(s){this.domObserver.stop();let f=d&&(ot||X)&&!this.composing&&!n.selection.empty&&!t.selection.empty&&mf(n.selection,t.selection);if(d){let u=X?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=Hu(this)),(i||!this.docView.update(t.doc,c,a,this))&&(this.docView.updateOuterDeco(c),this.docView.destroy(),this.docView=fl(t.doc,c,a,this.dom,this)),u&&!this.trackWrites&&(f=!0)}f||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&gu(this))?It(this,f):(Ml(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(n),!((o=this.dragging)===null||o===void 0)&&o.node&&!n.doc.eq(t.doc)&&this.updateDraggedNode(this.dragging,n),h=="reset"?this.dom.scrollTop=0:h=="to selection"?this.scrollToSelection():p&&Up(p)}scrollToSelection(){let t=this.domSelectionRange().focusNode;if(!(!t||!this.dom.contains(t.nodeType==1?t:t.parentNode))&&!this.someProp("handleScrollToSelection",e=>e(this)))if(this.state.selection instanceof O){let e=this.docView.domAfterPos(this.state.selection.from);e.nodeType==1&&el(this,e.getBoundingClientRect(),t)}else el(this,this.coordsAtPos(this.state.selection.head,1),t)}destroyPluginViews(){let t;for(;t=this.pluginViews.pop();)t.destroy&&t.destroy()}updatePluginViews(t){if(!t||t.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let e=0;e<this.directPlugins.length;e++){let o=this.directPlugins[e];o.spec.view&&this.pluginViews.push(o.spec.view(this))}for(let e=0;e<this.state.plugins.length;e++){let o=this.state.plugins[e];o.spec.view&&this.pluginViews.push(o.spec.view(this))}}else for(let e=0;e<this.pluginViews.length;e++){let o=this.pluginViews[e];o.update&&o.update(this,t)}}updateDraggedNode(t,e){let o=t.node,n=-1;if(this.state.doc.nodeAt(o.from)==o.node)n=o.from;else{let i=o.from+(this.state.doc.content.size-e.doc.content.size);(i>0&&this.state.doc.nodeAt(i))==o.node&&(n=i)}this.dragging=new Ul(t.slice,t.move,n<0?void 0:O.create(this.state.doc,n))}someProp(t,e){let o=this._props&&this._props[t],n;if(o!=null&&(n=e?e(o):o))return n;for(let s=0;s<this.directPlugins.length;s++){let l=this.directPlugins[s].props[t];if(l!=null&&(n=e?e(l):l))return n}let i=this.state.plugins;if(i)for(let s=0;s<i.length;s++){let l=i[s].props[t];if(l!=null&&(n=e?e(l):l))return n}}hasFocus(){if(ot){let t=this.root.activeElement;if(t==this.dom)return!0;if(!t||!this.dom.contains(t))return!1;for(;t&&this.dom!=t&&this.dom.contains(t);){if(t.contentEditable=="false")return!1;t=t.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&_p(this.dom),It(this),this.domObserver.start()}get root(){let t=this._root;if(t==null){for(let e=this.dom.parentNode;e;e=e.parentNode)if(e.nodeType==9||e.nodeType==11&&e.host)return e.getSelection||(Object.getPrototypeOf(e).getSelection=()=>e.ownerDocument.getSelection()),this._root=e}return t||document}updateRoot(){this._root=null}posAtCoords(t){return Qp(this,t)}coordsAtPos(t,e=1){return ll(this,t,e)}domAtPos(t,e=0){return this.docView.domFromPos(t,e)}nodeDOM(t){let e=this.docView.descAt(t);return e?e.nodeDOM:null}posAtDOM(t,e,o=-1){let n=this.docView.posFromDOM(t,e,o);if(n==null)throw new RangeError("DOM position not inside the editor");return n}endOfTextblock(t,e){return nu(this,e||this.state,t)}pasteHTML(t,e){return hr(this,"",t,!1,e||new ClipboardEvent("paste"))}pasteText(t,e){return hr(this,t,null,!0,e||new ClipboardEvent("paste"))}serializeForClipboard(t){return yn(this,t)}destroy(){this.docView&&(Pu(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Cn(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,Ip())}get isDestroyed(){return this.docView==null}dispatchEvent(t){return Iu(this,t)}dispatch(t){let e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))}domSelectionRange(){let t=this.domSelection();return t?tt&&this.root.nodeType===11&&Vp(this.dom.ownerDocument)==this.dom&&nf(this,t)||t:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}function na(r){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(r.editable),r.someProp("attributes",e=>{if(typeof e=="function"&&(e=e(r.state)),e)for(let o in e)o=="class"?t.class+=" "+e[o]:o=="style"?t.style=(t.style?t.style+";":"")+e[o]:!t[o]&&o!="contenteditable"&&o!="nodeName"&&(t[o]=String(e[o]))}),t.translate||(t.translate="no"),[dt.node(0,r.state.doc.content.size,t)]}function ia(r){if(r.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),r.cursorWrapper={dom:t,deco:dt.widget(r.state.selection.from,t,{raw:!0,marks:r.markCursor})}}else r.cursorWrapper=null}function sa(r){return!r.someProp("editable",t=>t(r.state)===!1)}function mf(r,t){let e=Math.min(r.$anchor.sharedDepth(r.head),t.$anchor.sharedDepth(t.head));return r.$anchor.start(e)!=t.$anchor.start(e)}function la(r){let t=Object.create(null);function e(o){for(let n in o)Object.prototype.hasOwnProperty.call(t,n)||(t[n]=o[n])}return r.someProp("nodeViews",e),r.someProp("markViews",e),t}function gf(r,t){let e=0,o=0;for(let n in r){if(r[n]!=t[n])return!0;e++}for(let n in t)o++;return e!=o}function aa(r){if(r.spec.state||r.spec.filterTransaction||r.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}const yf=vt`
	.ProseMirror {
		position: relative;
	}

	.ProseMirror {
		word-wrap: break-word;
		white-space: pre-wrap;
		white-space: break-spaces;
		-webkit-font-variant-ligatures: none;
		font-variant-ligatures: none;
		font-feature-settings: 'liga' 0; /* the above doesn't seem to work in Edge */
	}

	.ProseMirror pre {
		white-space: pre-wrap;
	}

	.ProseMirror li {
		position: relative;
	}

	.ProseMirror-hideselection *::selection {
		background: transparent;
	}
	.ProseMirror-hideselection *::-moz-selection {
		background: transparent;
	}
	.ProseMirror-hideselection {
		caret-color: transparent;
	}

	/* See https://github.com/ProseMirror/prosemirror/issues/1421#issuecomment-1759320191 */
	.ProseMirror [draggable][contenteditable='false'] {
		user-select: text;
	}

	.ProseMirror-selectednode {
		outline: 2px solid #8cf;
	}

	/* Make sure li selections wrap around markers */

	li.ProseMirror-selectednode {
		outline: none;
	}

	li.ProseMirror-selectednode:after {
		content: '';
		position: absolute;
		left: -32px;
		right: -2px;
		top: -2px;
		bottom: -2px;
		border: 2px solid #8cf;
		pointer-events: none;
	}

	/* Protect against generic img rules */

	img.ProseMirror-separator {
		display: inline !important;
		border: none !important;
		margin: 0 !important;
	}
`,wf=vt`
	.ProseMirror-textblock-dropdown {
		min-width: 3em;
	}

	.ProseMirror-menu {
		margin: 0 -4px;
		line-height: 1;
	}

	.ProseMirror-tooltip .ProseMirror-menu {
		width: -webkit-fit-content;
		width: fit-content;
		white-space: pre;
	}

	.ProseMirror-menuitem {
		margin-right: 3px;
		display: inline-block;
	}

	.ProseMirror-menuseparator {
		border-right: 1px solid #ddd;
		margin-right: 3px;
	}

	.ProseMirror-menu-dropdown,
	.ProseMirror-menu-dropdown-menu {
		font-size: 90%;
		white-space: nowrap;
	}

	.ProseMirror-menu-dropdown {
		vertical-align: 1px;
		cursor: pointer;
		position: relative;
		padding-right: 15px;
	}

	.ProseMirror-menu-dropdown-wrap {
		padding: 1px 0 1px 4px;
		display: inline-block;
		position: relative;
	}

	.ProseMirror-menu-dropdown:after {
		content: '';
		border-left: 4px solid transparent;
		border-right: 4px solid transparent;
		border-top: 4px solid currentColor;
		opacity: 0.6;
		position: absolute;
		right: 4px;
		top: calc(50% - 2px);
	}

	.ProseMirror-menu-dropdown-menu,
	.ProseMirror-menu-submenu {
		position: absolute;
		background: white;
		color: #666;
		border: 1px solid #aaa;
		padding: 2px;
	}

	.ProseMirror-menu-dropdown-menu {
		z-index: 15;
		min-width: 6em;
	}

	.ProseMirror-menu-dropdown-item {
		cursor: pointer;
		padding: 2px 8px 2px 4px;
	}

	.ProseMirror-menu-dropdown-item:hover {
		background: #f2f2f2;
	}

	.ProseMirror-menu-submenu-wrap {
		position: relative;
		margin-right: -4px;
	}

	.ProseMirror-menu-submenu-label:after {
		content: '';
		border-top: 4px solid transparent;
		border-bottom: 4px solid transparent;
		border-left: 4px solid currentColor;
		opacity: 0.6;
		position: absolute;
		right: 4px;
		top: calc(50% - 4px);
	}

	.ProseMirror-menu-submenu {
		display: none;
		min-width: 4em;
		left: 100%;
		top: -3px;
	}

	.ProseMirror-menu-active {
		background: #eee;
		border-radius: 4px;
	}

	.ProseMirror-menu-disabled {
		opacity: 0.3;
	}

	.ProseMirror-menu-submenu-wrap:hover .ProseMirror-menu-submenu,
	.ProseMirror-menu-submenu-wrap-active .ProseMirror-menu-submenu {
		display: block;
	}

	.ProseMirror-menubar {
		border-top-left-radius: inherit;
		border-top-right-radius: inherit;
		position: relative;
		min-height: 1em;
		color: #666;
		padding: 1px 6px;
		top: 0;
		left: 0;
		right: 0;
		border-bottom: 1px solid silver;
		background: white;
		z-index: 10;
		-moz-box-sizing: border-box;
		box-sizing: border-box;
		overflow: visible;
	}

	.ProseMirror-icon {
		display: inline-block;
		line-height: 0.8;
		vertical-align: -2px; /* Compensate for padding */
		padding: 2px 8px;
		cursor: pointer;
	}

	.ProseMirror-menu-disabled.ProseMirror-icon {
		cursor: default;
	}

	.ProseMirror-icon svg {
		fill: currentColor;
		height: 1em;
	}

	.ProseMirror-icon span {
		vertical-align: text-top;
	}
`;var vf=vt`
  :host {
    --border-color: var(--sl-color-neutral-200);
    --border-radius: var(--sl-border-radius-medium);
    --border-width: 1px;
    --padding: var(--sl-spacing-large);

    display: inline-block;
  }

  .card {
    display: flex;
    flex-direction: column;
    background-color: var(--sl-panel-background-color);
    box-shadow: var(--sl-shadow-x-small);
    border: solid var(--border-width) var(--border-color);
    border-radius: var(--border-radius);
  }

  .card__image {
    display: flex;
    border-top-left-radius: var(--border-radius);
    border-top-right-radius: var(--border-radius);
    margin: calc(-1 * var(--border-width));
    overflow: hidden;
  }

  .card__image::slotted(img) {
    display: block;
    width: 100%;
  }

  .card:not(.card--has-image) .card__image {
    display: none;
  }

  .card__header {
    display: block;
    border-bottom: solid var(--border-width) var(--border-color);
    padding: calc(var(--padding) / 2) var(--padding);
  }

  .card:not(.card--has-header) .card__header {
    display: none;
  }

  .card:not(.card--has-image) .card__header {
    border-top-left-radius: var(--border-radius);
    border-top-right-radius: var(--border-radius);
  }

  .card__body {
    display: block;
    padding: var(--padding);
  }

  .card--has-footer .card__footer {
    display: block;
    border-top: solid var(--border-width) var(--border-color);
    padding: var(--padding);
  }

  .card:not(.card--has-footer) .card__footer {
    display: none;
  }
`,ca=class{constructor(r,...t){this.slotNames=[],this.handleSlotChange=e=>{const o=e.target;(this.slotNames.includes("[default]")&&!o.name||o.name&&this.slotNames.includes(o.name))&&this.host.requestUpdate()},(this.host=r).addController(this),this.slotNames=t}hasDefaultSlot(){return[...this.host.childNodes].some(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent.trim()!=="")return!0;if(r.nodeType===r.ELEMENT_NODE){const t=r;if(t.tagName.toLowerCase()==="sl-visually-hidden")return!1;if(!t.hasAttribute("slot"))return!0}return!1})}hasNamedSlot(r){return this.host.querySelector(`:scope > [slot="${r}"]`)!==null}test(r){return r==="[default]"?this.hasDefaultSlot():this.hasNamedSlot(r)}hostConnected(){this.host.shadowRoot.addEventListener("slotchange",this.handleSlotChange)}hostDisconnected(){this.host.shadowRoot.removeEventListener("slotchange",this.handleSlotChange)}},ha=class extends bt{constructor(){super(...arguments),this.hasSlotController=new ca(this,"footer","header","image")}render(){return ut`
      <div
        part="base"
        class=${Ge({card:!0,"card--has-footer":this.hasSlotController.test("footer"),"card--has-image":this.hasSlotController.test("image"),"card--has-header":this.hasSlotController.test("header")})}
      >
        <slot name="image" part="image" class="card__image"></slot>
        <slot name="header" part="header" class="card__header"></slot>
        <slot part="body" class="card__body"></slot>
        <slot name="footer" part="footer" class="card__footer"></slot>
      </div>
    `}};ha.styles=[Me,vf],ha.define("sl-card");const _r=(r,t)=>r.selection.empty?!1:(t&&t(r.tr.deleteSelection().scrollIntoView()),!0);function da(r,t){let{$cursor:e}=r.selection;return!e||(t?!t.endOfTextblock("backward",r):e.parentOffset>0)?null:e}const bf=(r,t,e)=>{let o=da(r,e);if(!o)return!1;let n=Nn(o);if(!n){let s=o.blockRange(),l=s&&Fr(s);return l==null?!1:(t&&t(r.tr.lift(s,l).scrollIntoView()),!0)}let i=n.nodeBefore;if(va(r,n,t,-1))return!0;if(o.parent.content.size==0&&(Ve(i,"end")||O.isSelectable(i)))for(let s=o.depth;;s--){let l=Qe(r.doc,o.before(s),o.after(s),v.empty);if(l&&l.slice.size<l.to-l.from){if(t){let a=r.tr.step(l);a.setSelection(Ve(i,"end")?D.findFrom(a.doc.resolve(a.mapping.map(n.pos,-1)),-1):O.create(a.doc,n.pos-i.nodeSize)),t(a.scrollIntoView())}return!0}if(s==1||o.node(s-1).childCount>1)break}return i.isAtom&&n.depth==o.depth-1?(t&&t(r.tr.delete(n.pos-i.nodeSize,n.pos).scrollIntoView()),!0):!1},kf=(r,t,e)=>{let o=da(r,e);if(!o)return!1;let n=Nn(o);return n?pa(r,n,t):!1},xf=(r,t,e)=>{let o=fa(r,e);if(!o)return!1;let n=Tn(o);return n?pa(r,n,t):!1};function pa(r,t,e){let o=t.nodeBefore,n=o,i=t.pos-1;for(;!n.isTextblock;i--){if(n.type.spec.isolating)return!1;let h=n.lastChild;if(!h)return!1;n=h}let s=t.nodeAfter,l=s,a=t.pos+1;for(;!l.isTextblock;a++){if(l.type.spec.isolating)return!1;let h=l.firstChild;if(!h)return!1;l=h}let c=Qe(r.doc,i,a,v.empty);if(!c||c.from!=i||c instanceof F&&c.slice.size>=a-i)return!1;if(e){let h=r.tr.step(c);h.setSelection(A.create(h.doc,i)),e(h.scrollIntoView())}return!0}function Ve(r,t,e=!1){for(let o=r;o;o=t=="start"?o.firstChild:o.lastChild){if(o.isTextblock)return!0;if(e&&o.childCount!=1)return!1}return!1}const ua=(r,t,e)=>{let{$head:o,empty:n}=r.selection,i=o;if(!n)return!1;if(o.parent.isTextblock){if(e?!e.endOfTextblock("backward",r):o.parentOffset>0)return!1;i=Nn(o)}let s=i&&i.nodeBefore;return!s||!O.isSelectable(s)?!1:(t&&t(r.tr.setSelection(O.create(r.doc,i.pos-s.nodeSize)).scrollIntoView()),!0)};function Nn(r){if(!r.parent.type.spec.isolating)for(let t=r.depth-1;t>=0;t--){if(r.index(t)>0)return r.doc.resolve(r.before(t+1));if(r.node(t).type.spec.isolating)break}return null}function fa(r,t){let{$cursor:e}=r.selection;return!e||(t?!t.endOfTextblock("forward",r):e.parentOffset<e.parent.content.size)?null:e}const Sf=(r,t,e)=>{let o=fa(r,e);if(!o)return!1;let n=Tn(o);if(!n)return!1;let i=n.nodeAfter;if(va(r,n,t,1))return!0;if(o.parent.content.size==0&&(Ve(i,"start")||O.isSelectable(i))){let s=Qe(r.doc,o.before(),o.after(),v.empty);if(s&&s.slice.size<s.to-s.from){if(t){let l=r.tr.step(s);l.setSelection(Ve(i,"start")?D.findFrom(l.doc.resolve(l.mapping.map(n.pos)),1):O.create(l.doc,l.mapping.map(n.pos))),t(l.scrollIntoView())}return!0}}return i.isAtom&&n.depth==o.depth-1?(t&&t(r.tr.delete(n.pos,n.pos+i.nodeSize).scrollIntoView()),!0):!1},ma=(r,t,e)=>{let{$head:o,empty:n}=r.selection,i=o;if(!n)return!1;if(o.parent.isTextblock){if(e?!e.endOfTextblock("forward",r):o.parentOffset<o.parent.content.size)return!1;i=Tn(o)}let s=i&&i.nodeAfter;return!s||!O.isSelectable(s)?!1:(t&&t(r.tr.setSelection(O.create(r.doc,i.pos)).scrollIntoView()),!0)};function Tn(r){if(!r.parent.type.spec.isolating)for(let t=r.depth-1;t>=0;t--){let e=r.node(t);if(r.index(t)+1<e.childCount)return r.doc.resolve(r.after(t+1));if(e.type.spec.isolating)break}return null}const ga=(r,t)=>{let{$head:e,$anchor:o}=r.selection;return!e.parent.type.spec.code||!e.sameParent(o)?!1:(t&&t(r.tr.insertText(`
`).scrollIntoView()),!0)};function An(r){for(let t=0;t<r.edgeCount;t++){let{type:e}=r.edge(t);if(e.isTextblock&&!e.hasRequiredAttrs())return e}return null}const Mf=(r,t)=>{let{$head:e,$anchor:o}=r.selection;if(!e.parent.type.spec.code||!e.sameParent(o))return!1;let n=e.node(-1),i=e.indexAfter(-1),s=An(n.contentMatchAt(i));if(!s||!n.canReplaceWith(i,i,s))return!1;if(t){let l=e.after(),a=r.tr.replaceWith(l,l,s.createAndFill());a.setSelection(D.near(a.doc.resolve(l),1)),t(a.scrollIntoView())}return!0},ya=(r,t)=>{let e=r.selection,{$from:o,$to:n}=e;if(e instanceof st||o.parent.inlineContent||n.parent.inlineContent)return!1;let i=An(n.parent.contentMatchAt(n.indexAfter()));if(!i||!i.isTextblock)return!1;if(t){let s=(!o.parentOffset&&n.index()<n.parent.childCount?o:n).pos,l=r.tr.insert(s,i.createAndFill());l.setSelection(A.create(l.doc,s+1)),t(l.scrollIntoView())}return!0},Cf=(r,t)=>{let{$cursor:e}=r.selection;if(!e||e.parent.content.size)return!1;if(e.depth>1&&e.after()!=e.end(-1)){let i=e.before();if(Ee(r.doc,i))return t&&t(r.tr.split(i).scrollIntoView()),!0}let o=e.blockRange(),n=o&&Fr(o);return n==null?!1:(t&&t(r.tr.lift(o,n).scrollIntoView()),!0)};function Of(r){return(t,e)=>{let{$from:o,$to:n}=t.selection;if(t.selection instanceof O&&t.selection.node.isBlock)return!o.parentOffset||!Ee(t.doc,o.pos)?!1:(e&&e(t.tr.split(o.pos).scrollIntoView()),!0);if(!o.depth)return!1;let i=[],s,l,a=!1,c=!1;for(let f=o.depth;;f--)if(o.node(f).isBlock){a=o.end(f)==o.pos+(o.depth-f),c=o.start(f)==o.pos-(o.depth-f),l=An(o.node(f-1).contentMatchAt(o.indexAfter(f-1))),i.unshift(a&&l?{type:l}:null),s=f;break}else{if(f==1)return!1;i.unshift(null)}let h=t.tr;(t.selection instanceof A||t.selection instanceof st)&&h.deleteSelection();let d=h.mapping.map(o.pos),p=Ee(h.doc,d,i.length,i);if(p||(i[0]=l?{type:l}:null,p=Ee(h.doc,d,i.length,i)),!p)return!1;if(h.split(d,i.length,i),!a&&c&&o.node(s).type!=l){let f=h.mapping.map(o.before(s)),u=h.doc.resolve(f);l&&o.node(s-1).canReplaceWith(u.index(),u.index()+1,l)&&h.setNodeMarkup(h.mapping.map(o.before(s)),l)}return e&&e(h.scrollIntoView()),!0}}const wa=Of(),Nf=(r,t)=>(t&&t(r.tr.setSelection(new st(r.doc))),!0);function Tf(r,t,e){let o=t.nodeBefore,n=t.nodeAfter,i=t.index();return!o||!n||!o.type.compatibleContent(n.type)?!1:!o.content.size&&t.parent.canReplace(i-1,i)?(e&&e(r.tr.delete(t.pos-o.nodeSize,t.pos).scrollIntoView()),!0):!t.parent.canReplace(i,i+1)||!(n.isTextblock||Go(r.doc,t.pos))?!1:(e&&e(r.tr.join(t.pos).scrollIntoView()),!0)}function va(r,t,e,o){let n=t.nodeBefore,i=t.nodeAfter,s,l,a=n.type.spec.isolating||i.type.spec.isolating;if(!a&&Tf(r,t,e))return!0;let c=!a&&t.parent.canReplace(t.index(),t.index()+1);if(c&&(s=(l=n.contentMatchAt(n.childCount)).findWrapping(i.type))&&l.matchType(s[0]||i.type).validEnd){if(e){let f=t.pos+i.nodeSize,u=w.empty;for(let y=s.length-1;y>=0;y--)u=w.from(s[y].create(null,u));u=w.from(n.copy(u));let m=r.tr.step(new V(t.pos-1,f,t.pos,f,new v(u,1,0),s.length,!0)),g=m.doc.resolve(f+2*s.length);g.nodeAfter&&g.nodeAfter.type==n.type&&Go(m.doc,g.pos)&&m.join(g.pos),e(m.scrollIntoView())}return!0}let h=i.type.spec.isolating||o>0&&a?null:D.findFrom(t,1),d=h&&h.$from.blockRange(h.$to),p=d&&Fr(d);if(p!=null&&p>=t.depth)return e&&e(r.tr.lift(d,p).scrollIntoView()),!0;if(c&&Ve(i,"start",!0)&&Ve(n,"end")){let f=n,u=[];for(;u.push(f),!f.isTextblock;)f=f.lastChild;let m=i,g=1;for(;!m.isTextblock;m=m.firstChild)g++;if(f.canReplace(f.childCount,f.childCount,m.content)){if(e){let y=w.empty;for(let x=u.length-1;x>=0;x--)y=w.from(u[x].copy(y));let k=r.tr.step(new V(t.pos-u.length,t.pos+i.nodeSize,t.pos+g,t.pos+i.nodeSize-g,new v(y,u.length,0),0,!0));e(k.scrollIntoView())}return!0}}return!1}function ba(r){return function(t,e){let o=t.selection,n=r<0?o.$from:o.$to,i=n.depth;for(;n.node(i).isInline;){if(!i)return!1;i--}return n.node(i).isTextblock?(e&&e(t.tr.setSelection(A.create(t.doc,r<0?n.start(i):n.end(i)))),!0):!1}}const Af=ba(-1),Df=ba(1);function Yt(...r){return function(t,e,o){for(let n=0;n<r.length;n++)if(r[n](t,e,o))return!0;return!1}}let Dn=Yt(_r,bf,ua),ka=Yt(_r,Sf,ma);const zt={Enter:Yt(ga,ya,Cf,wa),"Mod-Enter":Mf,Backspace:Dn,"Mod-Backspace":Dn,"Shift-Backspace":Dn,Delete:ka,"Mod-Delete":ka,"Mod-a":Nf},xa={"Ctrl-h":zt.Backspace,"Alt-Backspace":zt["Mod-Backspace"],"Ctrl-d":zt.Delete,"Ctrl-Alt-Backspace":zt["Mod-Delete"],"Alt-Delete":zt["Mod-Delete"],"Alt-d":zt["Mod-Delete"],"Ctrl-a":Af,"Ctrl-e":Df};for(let r in zt)xa[r]=zt[r];const Ef=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform?os.platform()=="darwin":!1,Rf=Ef?xa:zt;class ye{constructor(t,e,o={}){this.match=t,this.match=t,this.handler=typeof e=="string"?Pf(e):e,this.undoable=o.undoable!==!1,this.inCode=o.inCode||!1,this.inCodeMark=o.inCodeMark!==!1}}function Pf(r){return function(t,e,o,n){let i=r;if(e[1]){let s=e[0].lastIndexOf(e[1]);i+=e[0].slice(s+e[1].length),o+=s;let l=o-n;l>0&&(i=e[0].slice(s-l,s)+i,o=n)}return t.tr.insertText(i,o,n)}}const Bf=500;function If({rules:r}){let t=new Ht({state:{init(){return null},apply(e,o){return e.getMeta(this)||(e.selectionSet||e.docChanged?null:o)}},props:{handleTextInput(e,o,n,i){return Sa(e,o,n,i,r,t)},handleDOMEvents:{compositionend:e=>{setTimeout(()=>{let{$cursor:o}=e.state.selection;o&&Sa(e,o.pos,o.pos,"",r,t)})}}},isInputRules:!0});return t}function Sa(r,t,e,o,n,i){if(r.composing)return!1;let s=r.state,l=s.doc.resolve(t),a=l.parent.textBetween(Math.max(0,l.parentOffset-Bf),l.parentOffset,null,"\uFFFC")+o;for(let c=0;c<n.length;c++){let h=n[c];if(!h.inCodeMark&&l.marks().some(f=>f.type.spec.code))continue;if(l.parent.type.spec.code){if(!h.inCode)continue}else if(h.inCode==="only")continue;let d=h.match.exec(a),p=d&&d[0].length>=o.length&&h.handler(s,d,t-(d[0].length-o.length),e);if(p)return h.undoable&&p.setMeta(i,{transform:p,from:t,to:e,text:o}),r.dispatch(p),!0}return!1}new ye(/--$/,"\u2014",{inCodeMark:!1}),new ye(/\.\.\.$/,"\u2026",{inCodeMark:!1}),new ye(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,"\u201C",{inCodeMark:!1}),new ye(/"$/,"\u201D",{inCodeMark:!1}),new ye(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,"\u2018",{inCodeMark:!1}),new ye(/'$/,"\u2019",{inCodeMark:!1});var Gr=typeof navigator<"u"?navigator:null,En=Gr&&Gr.userAgent||"",zf=/Edge\/(\d+)/.exec(En),$f=/MSIE \d/.exec(En),Ff=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(En),Lf=!!($f||Ff||zf),Vf=!Lf&&!!Gr&&/Apple Computer/.test(Gr.vendor),Ma=new Ls("safari-ime-span"),Rn=!1,jf={key:Ma,props:{decorations:Wf,handleDOMEvents:{compositionstart:()=>{Rn=!0},compositionend:()=>{Rn=!1}}}};function Wf(r){const{$from:t,$to:e,to:o}=r.selection;if(Rn&&t.sameParent(e)){const n=dt.widget(o,qf,{ignoreSelection:!0,key:"safari-ime-span"});return L.create(r.doc,[n])}}function qf(r){const t=r.dom.ownerDocument.createElement("span");return t.className="ProseMirror-safari-ime-span",t}var Jf=new Ht(Vf?jf:{key:Ma});function Xr(r){if(r==null)return null;const t=Number.parseInt(r,10);return Number.isInteger(t)?t:null}function Hf(){return[{tag:"div[data-list-kind]",getAttrs:r=>typeof r=="string"?{}:{kind:r.getAttribute("data-list-kind")||"bullet",order:Xr(r.getAttribute("data-list-order")),checked:r.hasAttribute("data-list-checked"),collapsed:r.hasAttribute("data-list-collapsed")}},{tag:"div[data-list]",getAttrs:r=>typeof r=="string"?{}:{kind:r.getAttribute("data-list-kind")||"bullet",order:Xr(r.getAttribute("data-list-order")),checked:r.hasAttribute("data-list-checked"),collapsed:r.hasAttribute("data-list-collapsed")}},{tag:"ul > li",getAttrs:r=>{var t;if(typeof r!="string"){let e=r.firstChild;for(let o=0;o<3&&e&&!["INPUT","UL","OL","LI"].includes(e.nodeName);o++)e=e.firstChild;if(e&&e.nodeName==="INPUT"&&e.getAttribute("type")==="checkbox")return{kind:"task",checked:e.hasAttribute("checked")};if(r.hasAttribute("data-task-list-item")||r.getAttribute("data-list-kind")==="task")return{kind:"task",checked:r.hasAttribute("data-list-checked")||r.hasAttribute("data-checked")};if(r.hasAttribute("data-toggle-list-item")||r.getAttribute("data-list-kind")==="toggle")return{kind:"toggle",collapsed:r.hasAttribute("data-list-collapsed")};if(((t=r.firstChild)==null?void 0:t.nodeType)===3){const o=r.firstChild.textContent;if(o&&/^\[[\sx|]]\s{1,2}/.test(o))return r.firstChild.textContent=o.replace(/^\[[\sx|]]\s{1,2}/,""),{kind:"task",checked:o.startsWith("[x]")}}}return{kind:"bullet"}}},{tag:"ol > li",getAttrs:r=>typeof r=="string"?{kind:"ordered"}:{kind:"ordered",order:Xr(r.getAttribute("data-list-order"))}},{tag:":is(ul, ol) > :is(ul, ol)",getAttrs:()=>({kind:"bullet"})}]}function Ca(r){var t;const{node:e,nativeList:o=!1,getMarkers:n=Kf,getAttributes:i=Uf}=r,s=e.attrs,l=((t=e.firstChild)==null?void 0:t.type)===e.type?null:n(e),a=i(e),c=["div",{class:"list-content"},0],h=l&&["div",{class:"list-marker list-marker-click-target",contenteditable:"false"},...l];if(o){const d=s.kind==="ordered"?"ol":"ul";return h?[d,["li",a,h,c]]:[d,["li",a,0]]}else return h?["div",a,h,c]:["div",a,c]}function Kf(r){const t=r.attrs;switch(t.kind){case"task":return[["label",["input",{type:"checkbox",checked:t.checked?"":void 0}]]];case"toggle":return[];default:return null}}function Uf(r){var t;const e=r.attrs;return{class:"prosemirror-flat-list","data-list-kind":((t=r.firstChild)==null?void 0:t.type)===r.type?void 0:e.kind||"bullet","data-list-order":e.order!=null?String(e.order):void 0,"data-list-checked":e.checked?"":void 0,"data-list-collapsed":e.collapsed?"":void 0,"data-list-collapsable":r.childCount>=2?"":void 0,style:e.order!=null?`--prosemirror-flat-list-order: ${e.order};`:void 0}}var Oa="flatList";function _f(){return{content:"block+",group:`${Oa} block`,definingForContent:!0,definingAsContext:!1,attrs:{kind:{default:"bullet"},order:{default:null},checked:{default:!1},collapsed:{default:!1}},toDOM:r=>Ca({node:r}),parseDOM:Hf()}}var Na="PROSEMIRROR_FLAT_LIST_TYPE_NAME";function Ta(r){let t=r.cached[Na];if(!t){for(const e of Object.values(r.nodes))if((e.spec.group||"").split(" ").includes(Oa)){t=e.name;break}if(!t)throw new TypeError("[prosemirror-flat-list] Unable to find a flat list type in the schema");return r.cached[Na]=t,t}return t}function Gf(r){return Ta(r.schema)===r.name}function I(r){return r?Gf(r.type):!1}function Pn(r){return t=>(e,o,n)=>t(e,o?i=>o(r(i)):void 0,n)}function*Xf(r){const t=[];let e=0;for(;;){for(;e<r.mapping.maps.length;e++){const o=r.mapping.maps[e];for(let n=0;n<t.length;n++)t[n]=o.map(t[n]);o.forEach((n,i,s,l)=>t.push(s,l))}yield t}}function Aa(r,t,e){const o=new Set,n=[];for(const i of r){const s=t.resolve(i);for(let l=s.depth;l>=0;l--){const a=s.before(l+1);if(o.has(a))break;o.add(a);const c=s.index(l),h=s.node(l),d=h.maybeChild(c-1);if(!d)continue;const p=h.maybeChild(c);p&&e(d,p,h,c)&&n.push(a)}}return n.sort((i,s)=>s-i)}function Yf(r,t){return I(r)&&I(t)&&I(t.firstChild)}function Zf(r,t,e,o){return!!(o===1&&I(e)&&I(r)&&!I(t))}function Qf(r){const t=Xf(r),e=Aa(t.next().value,r.doc,Yf);for(const n of e)Go(r.doc,n)&&r.join(n);const o=Aa(t.next().value,r.doc,Zf);for(const n of o)Ee(r.doc,n)&&r.split(n);return r}var Bn=Pn(Qf);function Da(r,t){for(let e=t;e<=r.depth;e++)if(!r.node(e).isTextblock&&r.index(e)!==0)return!1;return!0}function Ea(r,t){for(let e=t;e<=r.depth;e++)if(!r.node(e).isTextblock&&r.index(e)!==r.node(e).childCount-1)return!1;return!0}function In(r){return r.nodes[Ta(r)]}function zn(r,t=r){if(t.pos<r.pos)return zn(t,r);let e=r.blockRange(t);for(;e;){if(Ra(e))return e;if(e.depth<=0)break;e=new gt(r,t,e.depth-1)}return null}function Ra(r){const{startIndex:t,endIndex:e,parent:o}=r;for(let n=t;n<e;n++)if(!I(o.child(n)))return!1;return!0}function je(r,t){let e=r.steps.length;return()=>{if(e<r.steps.length){const o=r.mapping.slice(e);e=r.steps.length,t=o.map(t)}return t}}function $n(r,t){const e=Fr(t);return e==null?!1:(r.lift(t,e),!0)}function Yr(r){const{$from:t,$to:e,depth:o,start:n,end:i}=r,s=t.doc,l=(t.pos>n?t:s.resolve(n+1)).blockRange(e.pos<i?e:s.resolve(i-1));return l&&l.depth>o?l:null}function Fn(r){return!!(I(r)&&r.attrs.collapsed)}function Pa(r,t,e,o){let n=!1;for(const i of Object.keys(o))o[i]!==e[i]&&(r.setNodeAttribute(t,i,o[i]),n=!0);return n}function tm(r,t,e){const o=r.doc.resolve(t).nodeAfter;if(o&&I(o)){const n=o.attrs,i={...n,...e};return Pa(r,t,n,i)}return!1}function Ba(r,t){for(let e=t;e<=r.depth;e++)if(Fn(r.node(e))&&r.index(e)>=1){const o=r.posAtIndex(1,e),n=r.doc.resolve(o);return A.near(n,-1)}return null}function em(r){const{$from:t,$to:e,to:o}=r.selection,n=Ba(t,0)||Ba(e,t.sharedDepth(o));return n&&r.setSelection(n),r}var rm=Pn(em);function Ia(r,t){for(let e=t;e<=r.depth;e++)if(Fn(r.node(e))&&r.index(e)>=1)return r.before(e);return null}function om(r){var t;const{$from:e,$to:o,to:n}=r.selection,i=(t=Ia(e,0))!=null?t:Ia(o,e.sharedDepth(n));return i!=null&&(r.doc.resolve(i),tm(r,i,{collapsed:!1})),r}var za=Pn(om);function nm(r){return za(Bn((t,e)=>{const o=t.tr,n=o.selection.$from,i=o.selection.$to,s=zn(n,i);return s&&pr(s,o)?(e==null||e(o),!0):!1}))}function pr(r,t,e,o){const{depth:n,$from:i,$to:s}=r;if(e=e||Da(i,n+1),!e){const{startIndex:l,endIndex:a}=r;if(a-l===1){const c=Yr(r);return c?pr(c,t):!1}else return im(r,t,l+1)}if(o=o||Ea(s,n+1),!o){La(r,t);const l=s.end(n);return r=new gt(t.doc.resolve(i.pos),t.doc.resolve(l),n),pr(r,t,void 0,!0)}return r.startIndex===0&&r.endIndex===r.parent.childCount&&I(r.parent)?Ln(new gt(i,s,n-1),t):Ln(r,t)}function im(r,t,e){const{$from:o,$to:n,depth:i}=r,s=o.posAtIndex(e,i),l=o.blockRange(t.doc.resolve(s-1));if(!l)return!1;const a=je(t,s+1),c=je(t,n.pos);pr(l,t,void 0,!0);let h=t.doc.resolve(a()).blockRange(t.doc.resolve(c()));return h&&h.depth>=i&&(h=new gt(h.$from,h.$to,i),pr(h,t,!0,void 0)),!0}function Ln(r,t){return I(r.parent)?$a(t,r):Ra(r)?sm(t,r):$a(t,r)}function $a(r,t){if(Fa(r,t)){const e=r.doc.resolve(t.$from.pos),o=r.doc.resolve(t.$to.pos);t=new gt(e,o,t.depth)}return $n(r,t)}function Fa(r,t){const e=In(r.doc.type.schema),{$to:o,depth:n,end:i,parent:s,endIndex:l}=t,a=o.end(n);if(i<a){const c=s.maybeChild(l-1);return c?l<s.childCount&&c.canReplace(c.childCount,c.childCount,s.content,l,s.childCount)?(r.step(new V(i-1,a,i,a,new v(w.from(e.create(null)),1,0),0,!0)),!0):(r.step(new V(i,a,i,a,new v(w.from(e.create(null)),0,0),1,!0)),!0):!1}return!1}function La(r,t){r.endIndex-r.startIndex>=2&&(r=new gt(r.$to.doc.resolve(r.$to.posAtIndex(r.endIndex-1,r.depth)),r.$to,r.depth));const e=Yr(r);e&&(La(e,t),r=new gt(t.doc.resolve(r.$from.pos),t.doc.resolve(r.$to.pos),r.depth)),Fa(t,r)}function sm(r,t){const{startIndex:e,endIndex:o,parent:n}=t,i=je(r,t.start),s=je(r,t.end);for(let d=s(),p=o-1;p>e;p--)d-=n.child(p).nodeSize,r.delete(d-1,d+1);const l=r.doc.resolve(i()),a=l.nodeAfter;if(!a)return!1;const c=t.start,h=c+a.nodeSize;return s()!==h||!l.parent.canReplace(e,e+1,w.from(a))?!1:(r.step(new V(c,h,c+1,h-1,new v(w.empty,0,0),0,!0)),!0)}var lm=Yt(ga,ya,wa);function am(r){for(let t=r.depth;t>=0;t--){const e=r.node(t);if(I(e)&&e.attrs.collapsed)return!0}return!1}function cm(r){return za(Bn((t,e)=>{const o=t.tr,n=o.selection.$from,i=o.selection.$to,s=zn(n,i)||n.blockRange(i);return s&&ur(s,o)?(e==null||e(o),!0):!1}))}function ur(r,t,e,o){const{depth:n,$from:i,$to:s}=r;if(e=e||Da(i,n+1),!e){const{startIndex:l,endIndex:a}=r;if(a-l===1){const c=Yr(r);return c?ur(c,t):!1}else return Va(r,t,l+1)}if(o=o||Ea(s,n+1),!o&&!am(s)){const{startIndex:l,endIndex:a}=r;if(a-l===1){const c=Yr(r);return c?ur(c,t):!1}else return Va(r,t,a-1)}return hm(r,t)}function Va(r,t,e){const{$from:o,$to:n,depth:i}=r,s=o.posAtIndex(e,i),l=o.blockRange(t.doc.resolve(s-1));if(!l)return!1;const a=je(t,s+1),c=je(t,n.pos);ur(l,t,void 0,!0);const h=t.doc.resolve(a()).blockRange(t.doc.resolve(c()));return h&&ur(h,t,!0,void 0),!0}function hm(r,t){const e=In(t.doc.type.schema),{parent:o,startIndex:n}=r,i=n>=1&&o.child(n-1);if(i&&I(i)){const{start:a,end:c}=r;return t.step(new V(a-1,c,a,c,new v(w.from(e.create(null)),1,0),0,!0)),!0}const s=I(o),l=I(o.maybeChild(n));if(n===0&&s||l){const{start:a,end:c}=r,h=l?o.child(n).attrs:s?o.attrs:null;return t.step(new V(a,c,a,c,new v(w.from(e.create(h)),0,0),1,!0)),!0}return!1}function ja(r,t){const{$cursor:e}=r.selection;return!e||(t?!t.endOfTextblock("backward",r):e.parentOffset>0)?null:e}function dm(r,t,e){let o=t.nodeBefore,n=o,i=t.pos-1;for(;!n.isTextblock;i--){if(n.type.spec.isolating)return!1;let h=n.lastChild;if(!h)return!1;n=h}let s=t.nodeAfter,l=s,a=t.pos+1;for(;!l.isTextblock;a++){if(l.type.spec.isolating)return!1;let h=l.firstChild;if(!h)return!1;l=h}let c=Qe(r.doc,i,a,v.empty);return!c||c.from!=i||c instanceof F&&c.slice.size>=a-i?!1:(e&&(r.step(c),r.setSelection(A.create(r.doc,i)),e(r.scrollIntoView())),!0)}var pm=(r,t,e)=>{const o=ja(r,e);if(!o)return!1;const n=um(o);if(!n)return!1;const{nodeBefore:i,nodeAfter:s}=n;if(i&&s&&I(i)&&i.attrs.collapsed&&s.isBlock){const l=r.tr,a=n.pos-i.nodeSize;l.delete(n.pos,n.pos+s.nodeSize);const c=a+1+i.child(0).nodeSize;l.insert(c,s);const h=l.doc.resolve(c);if(l.setSelection(A.near(h)),dm(l,h,t))return!0}return!1};function um(r){if(!r.parent.type.spec.isolating)for(let t=r.depth-1;t>=0;t--){if(r.index(t)>0)return r.doc.resolve(r.before(t+1));if(r.node(t).type.spec.isolating)break}return null}var fm=(r,t,e)=>{const o=ja(r,e);if(!o)return!1;const{depth:n}=o;if(n<2)return!1;const i=n-1,s=o.node(i);if(!I(s))return!1;const l=o.index(i);return l===0?(t&&mm(r,t,o),!0):l===s.childCount-1?(t&&gm(r,t,o),!0):!1};function mm(r,t,e){const o=r.tr,n=e.depth-1,i=new gt(e,o.doc.resolve(e.end(n)),n);$n(o,i)&&t(o)}function gm(r,t,e){const o=r.tr,n=e.blockRange();n&&$n(o,n)&&t(o)}var Vn=(r,t)=>{const e=r.tr;let o=!1;const{from:n,to:i}=r.selection;return r.doc.nodesBetween(n,i,(s,l,a,c)=>{if(o&&!t)return!1;if(a&&Fn(a)&&c>=1){if(o=!0,!t)return!1;const h=r.doc.resolve(l);e.setNodeAttribute(h.before(h.depth),"collapsed",!1)}}),o&&(t==null||t(e)),o};function Wa(r,t,e,o){const n=r.createAndFill(t,e,o);if(!n)throw new RangeError(`Failed to create '${r.name}' node`);return n.check(),n}function ym(r){return!!r.node}function qa(r){return ym(r)&&r.node.type.isBlock}function wm(r){return!!(r&&r instanceof A)}function vm(){return Bn(Yt(bm,km))}function Ja(r){return{kind:r.attrs.kind}}var bm=(r,t)=>{if(!qa(r.selection))return!1;const e=r.selection,{$to:o,node:n}=e,i=o.parent;if(I(n)||!I(i)||i.childCount!==1||i.firstChild!==n)return!1;const s=i.type,l=s.createAndFill(Ja(i));if(!l)return!1;if(t){const a=r.tr,c=o.pos;a.replace(c,c,new v(w.fromArray([s.create(),l]),1,1));const h=A.near(a.doc.resolve(c));wm(h)&&(a.setSelection(h),t(a))}return!0},km=(r,t)=>{if(qa(r.selection))return!1;const{$from:e,$to:o}=r.selection;if(!e.sameParent(o)||e.depth<2)return!1;const n=e.depth-1,i=e.node(n);if(!I(i))return!1;const s=e.parent,l=e.index(n),a=s.content.size===0;if(l===0)if(a){const c=r.doc.resolve(e.end(n)),h=n-1,d=e.node(h),p=e.index(h)===d.childCount-1?new gt(e,c,h):new gt(e,c,n),f=r.tr;return p&&Ln(p,f)?(t==null||t(f),!0):!1}else return xm(r,i,t);else return a?lm(r,t):!1};function xm(r,t,e){const o=r.tr,n=t.type,i=t.attrs,s=Ja(t);o.delete(o.selection.from,o.selection.to);const{$from:l,$to:a}=o.selection,{parentOffset:c}=a,h=c==0,d=c==a.parent.content.size;if(h){if(e){const u=l.before(-1);o.insert(u,Wa(n,s)),e(o.scrollIntoView())}return!0}if(d&&i.collapsed){if(e){const u=l.after(-1);o.insert(u,Wa(n,s)),o.setSelection(D.near(o.doc.resolve(u))),e(o.scrollIntoView())}return!0}const p=d?t.contentMatchAt(0).defaultType:void 0,f=[{type:n,attrs:s},p?{type:p}:null];return Ee(o.doc,l.pos,2,f)?(e==null||e(o.split(l.pos,2,f).scrollIntoView()),!0):!1}var Sm=Yt(Vn,vm()),Mm=Yt(Vn,_r,fm,pm,kf,ua),Cm=Yt(Vn,_r,xf,ma),Om={Enter:Sm,Backspace:Mm,Delete:Cm,"Mod-[":nm(),"Mod-]":cm()};function Ha({view:r,event:t,onListClick:e=Tm}){const o=t.target;if(o!=null&&o.closest(".list-marker-click-target")){t.preventDefault();const n=r.posAtDOM(o,-10,-10);return Nm(n,e)(r.state,i=>r.dispatch(i))}return!1}function Nm(r,t){return rm((e,o)=>{const n=e.tr,i=n.doc.resolve(r),s=i.parent;if(!I(s))return!1;const l=i.before(i.depth),a=t(s);return Pa(n,l,s.attrs,a)&&(o==null||o(n)),!0})}var Tm=r=>{const t=r.attrs;return t.kind==="task"?{...t,checked:!t.checked}:t.kind==="toggle"?{...t,collapsed:!t.collapsed}:t};function Zr(r,t){return new ye(r,(e,o,n,i)=>{const s=e.tr;s.deleteRange(n,i);const l=s.selection.$from,a=l.index(-1)===0&&l.node(-1);if(a&&I(a)){const p=a.attrs,f=typeof t=="function"?t({match:o,attributes:p}):t,u=Object.entries(f).filter(([m,g])=>p[m]!==g);if(u.length===0)return null;{const m=l.before(-1);for(const[g,y]of u)s.setNodeAttribute(m,g,y);return s}}const c=s.doc.resolve(n).blockRange();if(!c)return null;const h=typeof t=="function"?t({match:o}):t,d=$d(c,In(e.schema),h);return d?s.wrap(c,d):null})}var Am=[Zr(/^\s?([*-])\s$/,{kind:"bullet",collapsed:!1}),Zr(/^\s?(\d+)\.\s$/,({match:r})=>{const t=Xr(r[1]);return{kind:"ordered",collapsed:!1,order:t!=null&&t>=2?t:null}}),Zr(/^\s?\[([\sXx]?)]\s$/,({match:r})=>({kind:"task",checked:["x","X"].includes(r[1]),collapsed:!1})),Zr(/^\s?>>\s$/,{kind:"toggle"})],Qr=typeof navigator<"u"?navigator:null,jn=Qr&&Qr.userAgent||"",Dm=/Edge\/(\d+)/.exec(jn),Em=/MSIE \d/.exec(jn),Rm=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(jn),Pm=!!(Em||Rm||Dm),Bm=!Pm&&!!Qr&&/Apple Computer/.test(Qr.vendor),Im=r=>{var t,e;let o=r;const n=((t=r.firstChild)==null?void 0:t.type)===r.type,i=r.childCount===1,s=r.type.spec.toDOM(r),{dom:l,contentDOM:a}=$t.renderSpec(document,s);return Bm&&r.attrs.kind==="toggle"&&((e=l.querySelector(".list-marker-click-target"))==null||e.appendChild(document.createElement("span"))),{dom:l,contentDOM:a,update:c=>{var h;if(!c.sameMarkup(o))return!1;const d=((h=c.firstChild)==null?void 0:h.type)===c.type,p=c.childCount===1;return n!==d||i!==p?!1:(o=c,!0)}}},zm=class Ya extends $t{static nodesFromSchema(t){return{...$t.nodesFromSchema(t),list:e=>Ca({node:e,nativeList:!0,getMarkers:()=>null})}}static fromSchema(t){return t.cached.listDomSerializer||(t.cached.listDomSerializer=new Ya(this.nodesFromSchema(t),this.marksFromSchema(t)))}serializeFragment(t,e,o){const n=super.serializeFragment(t,e,o);return Ka(n)}};function Ka(r){for(let t=0;t<r.childNodes.length;t++){const e=r.children.item(t);if(e){if(e.tagName==="UL"||e.tagName==="OL"){let o=null;for(;o=e.nextElementSibling,(o==null?void 0:o.tagName)===e.tagName;)e.append(...Array.from(o.children)),o.remove()}Ka(e)}}return r}function $m(r){for(;r.openStart>=2&&r.openEnd>=2&&r.content.childCount===1&&I(r.content.child(0));)r=new v(r.content.child(0).content,r.openStart-1,r.openEnd-1);return r}function Ua(r){return new Ht({props:{clipboardSerializer:zm.fromSchema(r),transformCopied:$m}})}function Fm(){return new Ht({props:{handleDOMEvents:{mousedown:(r,t)=>Ha({view:r,event:t})}}})}function _a(){return new Ht({props:{nodeViews:{list:Im}}})}function Ga(){return Jf}function Lm(r){const{schema:t}=r;return[Fm(),_a(),Ua(t),Ga()]}for(var Zt={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},to={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Vm=typeof navigator<"u"&&/Mac/.test(navigator.platform),jm=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),U=0;U<10;U++)Zt[48+U]=Zt[96+U]=String(U);for(var U=1;U<=24;U++)Zt[U+111]="F"+U;for(var U=65;U<=90;U++)Zt[U]=String.fromCharCode(U+32),to[U]=String.fromCharCode(U);for(var Wn in Zt)to.hasOwnProperty(Wn)||(to[Wn]=Zt[Wn]);function Wm(r){var t=Vm&&r.metaKey&&r.shiftKey&&!r.ctrlKey&&!r.altKey||jm&&r.shiftKey&&r.key&&r.key.length==1||r.key=="Unidentified",e=!t&&r.key||(r.shiftKey?to:Zt)[r.keyCode]||r.key||"Unidentified";return e=="Esc"&&(e="Escape"),e=="Del"&&(e="Delete"),e=="Left"&&(e="ArrowLeft"),e=="Up"&&(e="ArrowUp"),e=="Right"&&(e="ArrowRight"),e=="Down"&&(e="ArrowDown"),e}const qm=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),Jm=typeof navigator<"u"&&/Win/.test(navigator.platform);function Hm(r){let t=r.split(/-(?!$)/),e=t[t.length-1];e=="Space"&&(e=" ");let o,n,i,s;for(let l=0;l<t.length-1;l++){let a=t[l];if(/^(cmd|meta|m)$/i.test(a))s=!0;else if(/^a(lt)?$/i.test(a))o=!0;else if(/^(c|ctrl|control)$/i.test(a))n=!0;else if(/^s(hift)?$/i.test(a))i=!0;else if(/^mod$/i.test(a))qm?s=!0:n=!0;else throw new Error("Unrecognized modifier name: "+a)}return o&&(e="Alt-"+e),n&&(e="Ctrl-"+e),s&&(e="Meta-"+e),i&&(e="Shift-"+e),e}function Km(r){let t=Object.create(null);for(let e in r)t[Hm(e)]=r[e];return t}function qn(r,t,e=!0){return t.altKey&&(r="Alt-"+r),t.ctrlKey&&(r="Ctrl-"+r),t.metaKey&&(r="Meta-"+r),e&&t.shiftKey&&(r="Shift-"+r),r}function Um(r){return new Ht({props:{handleKeyDown:_m(r)}})}function _m(r){let t=Km(r);return function(e,o){let n=Wm(o),i,s=t[qn(n,o)];if(s&&s(e.state,e.dispatch,e))return!0;if(n.length==1&&n!=" "){if(o.shiftKey){let l=t[qn(n,o,!1)];if(l&&l(e.state,e.dispatch,e))return!0}if((o.altKey||o.metaKey||o.ctrlKey)&&!(Jm&&o.ctrlKey&&o.altKey)&&(i=Zt[o.keyCode])&&i!=n){let l=t[qn(i,o)];if(l&&l(e.state,e.dispatch,e))return!0}}return!1}}const Gm=["p",0],Xm={nodes:{doc:{content:"block+"},paragraph:{automerge:{block:"paragraph"},content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM(){return Gm}},list:{automerge:{block:"list",attrParsers:{fromAutomerge:r=>({kind:r.attrs.kind,checked:r.attrs.checked}),fromProsemirror:r=>({kind:r.attrs.kind,checked:r.attrs.checked})}},..._f()},unknownBlock:{automerge:{unknownBlock:!0},group:"block",content:"block+",parseDOM:[{tag:"div",attrs:{"data-unknown-block":"true"}}],toDOM(){return["div",{"data-unknown-block":"true"},0]}},text:{group:"inline"}},marks:{}},Ym=vt`
	.prosemirror-flat-list {
		& {
			padding: 0;
			margin-top: 0;
			margin-bottom: 0;
			margin-left: 32px;
			margin-bottom: 0;
			position: relative;
			display: list-item;
			list-style: none;
		}

		&.ProseMirror-selectednode {
			outline: none;

			&:after {
				content: '';
				position: absolute;
				left: -32px;
				right: -2px;
				top: -2px;
				bottom: -2px;
				border: 2px solid #8cf;
				pointer-events: none;
			}
		}

		&[data-list-kind='task'] {
			& > .list-content {
				width: 300px;
			}
			& > .list-marker {
				position: absolute;
				right: 100%;
				text-align: center;
				width: 1.5em;
				width: 1lh;

				&,
				& * {
					cursor: pointer;
				}
			}
		}
	}
`;export{Ge as A,Se as B,To as C,Ro as D,ff as E,Ao as F,Eo as G,ca as H,Do as I,ho as J,He as K,wr as L,Po as M,Qn as N,ti as O,Ht as P,Zn as Q,Pc as R,ds as S,Ic as T,_a as U,Ua as V,Ga as W,Ha as X,uc as Y,S as _,pc as a,wf as b,kd as c,We as d,Lo as e,Ym as f,Lm as g,Qi as h,If as i,Am as j,Um as k,Ih as l,Eh as m,Xm as n,Om as o,yf as p,Rf as q,hc as r,Bp as s,ri as t,Me as u,kt as v,ei as w,xe as x,oi as y,bt as z};
